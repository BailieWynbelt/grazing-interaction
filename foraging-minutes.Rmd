---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

First, remove all objects from the R environment to start fresh each time.

```{r}
# clear the enviroment
rm(list=ls(all=TRUE))
```

------------------------------------------------------------------------

Let's check the working directory to see if it's correct. This chunk sources a script that I use to setup my R environment across scripts. It helps me stay consistent between scripts.

```{r environment}
source(paste0(getwd(), "/environment.R"))

print(currentwd)
```

Check that this file path is correct for your computer.

------------------------------------------------------------------------

Let's get our R environment ready by loading some useful packages. This chunk sources a script where I keep a list of packages I commonly use for analysis.

```{r packages, message=FALSE}
source(paste0(currentwd, "/packages.R"))
```

------------------------------------------------------------------------

Let's load some custom functions into our R environment. This chunk of code sources a script that contains custom functions created to help with analysis.

```{r functions}
source(paste0(currentwd, "/functions.R"))
```

------------------------------------------------------------------------

Now, we can load in the cleaned photo data generated by "photo-processing.Rmd" script. This data has already been corrected for erroneous data, re-named columns for consistency across years, and some columns have been converted to specific data types (e.g., DateTime as a S3:POSIXct).

```{r load data, warning=FALSE}
all_data <- readr::read_csv('data/photo/all_photo_data.csv', col_names = TRUE, na = c(""," ","NA"))

print(all_data)
```

```{r}
all_data <- all_data %>% dplyr::mutate(Date = lubridate::date(DateTime), .after = Year)

print(all_data)
```

------------------------------------------------------------------------

We're going to use a function I created called "speciestotal" (see the functions.R script) which is specific to the way we classified our data. The issue is that the 'Count1Species' column in our data frames doesn't correspond to a specific species, rather it corresponds to whatever species is the primary species detected (\>50% of individuals if a multiple species are detected in an image).

The "speciestotal" function will count up the number of individuals for each species detected in a camera trap photo and then create a new column in the corresponding dataframe to store this species count. The new column is labled by the species and contains a count of the number of individuals detected in each image.

A second function "allspecies" uses the "speciestotal" function for all of the species possible (24 total), and creates a new column for each species.

```{r species counts}
all_data_all_species <- allspecies(all_data)

view(all_data_all_species)
```

------------------------------------------------------------------------

This new data frame has 24 additional columns that contain counts of the 'subjects' (e.g., horses, cows, ATVs, humans) in each photo. These columns were created primarily to simplify the data frame, where a single row has the counts for each species stored in a separate column.

```{r black canyon south 2017}
BKS_2017 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2017")
  
print(BKS_2017)
```

```{r black canyon south 2018}
BKS_2018 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2018")
  
print(BKS_2018)
```

```{r black canyon south 2019}
BKS_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2019")
  
print(BKS_2019)
```

```{r black canyon south 2020}
BKS_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2020")
  
print(BKS_2020)
```

```{r bear timelapse 2017}
# TODO go back to the photo processing step and name this site as "Bear Timelapse"
BRL_2017 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear") %>% 
  dplyr::filter(Year == "2017")
  
print(BRL_2017)
```

```{r bear timelapse 2018}
BRL_2018 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear Timelapse") %>% 
  dplyr::filter(Year == "2018")
  
print(BRL_2018)
```

```{r bear timelapse 2019}
BRL_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear Timelapse") %>% 
  dplyr::filter(Year == "2019")
  
print(BRL_2019)
```

```{r bear timelapse 2020}
BRL_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear Timelapse") %>%
  dplyr::filter(Year == "2020")
  
print(BRL_2020)
```

```{r fifty one timelapse 2019}
A51_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Fifty One") %>% 
  dplyr::filter(Year == "2019")
  
print(A51_2019)
```

```{r fifty one timelapse 2020}
A51_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Fifty One") %>% 
  dplyr::filter(Year == "2020")
  
print(A51_2020)
```

```{r black canyon dam 2019}
BKD_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon Dam") %>% 
  dplyr::filter(Year == "2019")
  
print(BKD_2019)
```

```{r black canyon north 2019}
BKN_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon North") %>% 
  dplyr::filter(Year == "2019")
  
print(BKN_2019)
```

```{r black canyon north 2020}
BKN_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon North") %>% 
  dplyr::filter(Year == "2020")
  
print(BKN_2020)
```

------------------------------------------------------------------------

Let's check the operational dates for Bear Timelapse 2018. This represents only the dates in this data frame, which corresponds only to 'subject' photos. This data frame does not contain blank or empty photos that were sorted out during an earlier phase of photo processing.

```{r}
BRL_2018 %>% pull(DateTime) %>% lubridate::date() %>% unique() %>% tibble()

BRL_2019 %>% pull(DateTime) %>% lubridate::date() %>% unique() %>% tibble()
```

These operational dates represent days with observations containing subjects, but does not contain the dates without observations, but where the camera was still functioning.

------------------------------------------------------------------------

Let's calculate foraging minutes using the Bear Timelapse 2018 data. From our metadata, we know that the Bear Timelapse site in 2018 used a 1 minute collection interval for timelapse photos. 

```{r}
calc.foraging.time.unwtd <- function(cameradf, interval) {
  cameradf <- cameradf %>% dplyr::mutate(horse_forage_unwtd = horse * interval)
  
  cameradf <- cameradf %>% dplyr::mutate(cow_forage_unwtd = cow * interval)
  
  cameradf <- cameradf %>% dplyr::mutate(elk_forage_unwtd = elk * interval)
  
  return(cameradf)
}

calc.foraging.time.wtd <- function(cameradf, interval) {
  cameradf <- cameradf %>% dplyr::mutate(horse_forage_wtd = horse * interval * 1.1)
  
  cameradf <- cameradf %>% dplyr::mutate(cow_forage_wtd = cow * interval * 1)
  
  cameradf <- cameradf %>% dplyr::mutate(elk_forage_wtd = elk * interval * 0.7)
  
  return(cameradf)
}
```

```{r calc forage bear timelapse}
BRL_2017 <- calc.foraging.time.unwtd(BRL_2017, interval = 1)

BRL_2017 <- calc.foraging.time.wtd(BRL_2017, interval = 1)

BRL_2018 <- calc.foraging.time.unwtd(BRL_2018, interval = 1)

BRL_2018 <- calc.foraging.time.wtd(BRL_2018, interval = 1)

BRL_2019 <- calc.foraging.time.unwtd(BRL_2019, interval = 5)

BRL_2019 <- calc.foraging.time.wtd(BRL_2019, interval = 5)

BRL_2020 <- calc.foraging.time.unwtd(BRL_2020, interval = 5)

BRL_2020 <- calc.foraging.time.wtd(BRL_2020, interval = 5)
```

```{r calc forage fifty one}
A51_2019 <- calc.foraging.time.unwtd(A51_2019, interval = 5)

A51_2019 <- calc.foraging.time.wtd(A51_2019, interval = 5)

A51_2020 <- calc.foraging.time.unwtd(A51_2020, interval = 5)

A51_2020 <- calc.foraging.time.wtd(A51_2020, interval = 5)
```

```{r calc forage black canyon dam}
BKD_2019 <- calc.foraging.time.unwtd(BKD_2019, interval = 5)

BKD_2019 <- calc.foraging.time.wtd(BKD_2019, interval = 5)
```

```{r calc forage black canyon north}
BKN_2019 <- calc.foraging.time.unwtd(BKN_2019, interval = 5)

BKN_2019 <- calc.foraging.time.wtd(BKN_2019, interval = 5)

BKN_2020 <- calc.foraging.time.unwtd(BKN_2020, interval = 5)

BKN_2020 <- calc.foraging.time.wtd(BKN_2020, interval = 5)
```

```{r calc forage black canyon south}
BKS_2017 <- calc.foraging.time.unwtd(BKS_2017, interval = 1)

BKS_2017 <- calc.foraging.time.wtd(BKS_2017, interval = 1)

BKS_2018 <- calc.foraging.time.unwtd(BKS_2018, interval = 1)

BKS_2018 <- calc.foraging.time.wtd(BKS_2018, interval = 1)

BKS_2019 <- calc.foraging.time.unwtd(BKS_2019, interval = 5)

BKS_2019 <- calc.foraging.time.wtd(BKS_2019, interval = 5)

BKS_2020 <- calc.foraging.time.unwtd(BKS_2020, interval = 5)

BKS_2020 <- calc.foraging.time.wtd(BKS_2020, interval = 5)
```

```{r}
BRL_2018 %>% pull(horse_forage_unwtd) %>% sum()

BRL_2018 %>% pull(horse_forage_wtd) %>% sum()
```

```{r}
BRL_2018 %>% pull(cow_forage_unwtd) %>% sum()

BRL_2018 %>% pull(cow_forage_wtd) %>% sum()
```

```{r}
BRL_2018 %>% pull(elk_forage_unwtd) %>% sum()

BRL_2018 %>% pull(elk_forage_wtd) %>% sum()
```

```{r}
BRL_2019 %>% pull(Date) %>% unique()
```

```{r function summarize unweighted daily totals}
summarize.unwtd.daily.totals <- function(cameradf){

  cameradf_horses <- NULL
  cameradf_horses <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_unwtd = sum(horse_forage_unwtd))
  cameradf_horses <- cameradf_horses %>% mutate(Species = "Horse")
  
  cameradf_cows <- NULL
  cameradf_cows <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_unwtd = sum(cow_forage_unwtd))
  cameradf_cows <- cameradf_cows %>% mutate(Species = "Cow")  
  
  cameradf_elk <- NULL
  cameradf_elk <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_unwtd = sum(elk_forage_unwtd))
  cameradf_elk <- cameradf_elk %>% mutate(Species = "Elk")  
  
  cameradf_bind <- dplyr::bind_rows(cameradf_horses, cameradf_cows, cameradf_elk)
  
  cameradf_bind$Site <- NULL
  
  cameradf_bind$Site <- cameradf$Site[1]
  
  cameradf_bind$Year <- NULL
  
  cameradf_bind$Year <- cameradf$Year[1]
  
  return(cameradf_bind)
}
```

```{r function summarize weighted daily totals}
summarize.wtd.daily.totals <- function(cameradf){

  cameradf_horses <- NULL
  cameradf_horses <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_wtd = sum(horse_forage_wtd))
  cameradf_horses <- cameradf_horses %>% mutate(Species = "Horse")
  
  cameradf_cows <- NULL
  cameradf_cows <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_wtd = sum(cow_forage_wtd))
  cameradf_cows <- cameradf_cows %>% mutate(Species = "Cow")  
  
  cameradf_elk <- NULL
  cameradf_elk <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_wtd = sum(elk_forage_wtd))
  cameradf_elk <- cameradf_elk %>% mutate(Species = "Elk")  
  
  cameradf_bind <- dplyr::bind_rows(cameradf_horses, cameradf_cows, cameradf_elk)
  
  cameradf_bind$Site <- NULL
  
  cameradf_bind$Site <- cameradf$Site[1]
  
  cameradf_bind$Year <- NULL
  
  cameradf_bind$Year <- cameradf$Year[1]
  
  return(cameradf_bind)
}
```

```{r}
summarize.unwtd.daily.totals(BRL_2019)
```

```{r}
summarize.wtd.daily.totals(BRL_2019)
```


```{r}
list_of_dataframes <- list(A51_2019, 
                           A51_2020, 
                           BKD_2019, 
                           BKN_2019, 
                           BKN_2020, 
                           BKS_2017, 
                           BKS_2018, 
                           BKS_2019, 
                           BKS_2020, 
                           BRL_2017, 
                           BRL_2018, 
                           BRL_2019, 
                           BRL_2020)

list_of_dataframes
```

```{r}
list_of_summarized_dataframes_unwtd <- list_of_dataframes %>% purrr::map(summarize.unwtd.daily.totals)

list_of_summarized_dataframes_unwtd
```

```{r}
list_of_summarized_dataframes_wtd <- list_of_dataframes %>% purrr::map(summarize.wtd.daily.totals)

list_of_summarized_dataframes_wtd
```

```{r}
# purrr::flatten(list_of_summarized_dataframes_unwtd)
```
```{r}
A51_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[1]]
A51_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[2]]
BKD_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[3]]
BKN_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[4]]
BKN_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[5]]
BKS_2017_unwtd_summary <- list_of_summarized_dataframes_unwtd[[6]]
BKS_2018_unwtd_summary <- list_of_summarized_dataframes_unwtd[[7]]
BKS_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[8]]
BKS_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[9]]
BRL_2017_unwtd_summary <- list_of_summarized_dataframes_unwtd[[10]]
BRL_2018_unwtd_summary <- list_of_summarized_dataframes_unwtd[[11]]
BRL_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[12]]
BRL_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[13]]
```

```{r}
A51_2019_unwtd_summary
A51_2020_unwtd_summary
BKD_2019_unwtd_summary
BKN_2019_unwtd_summary
BKN_2020_unwtd_summary
BKS_2017_unwtd_summary
BKS_2018_unwtd_summary
BKS_2019_unwtd_summary
BKS_2020_unwtd_summary
BRL_2017_unwtd_summary
BRL_2018_unwtd_summary
BRL_2019_unwtd_summary
BRL_2020_unwtd_summary
```

```{r}
A51_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[1]]
A51_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[2]]
BKD_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[3]]
BKN_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[4]]
BKN_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[5]]
BKS_2017_wtd_summary <- list_of_summarized_dataframes_wtd[[6]]
BKS_2018_wtd_summary <- list_of_summarized_dataframes_wtd[[7]]
BKS_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[8]]
BKS_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[9]]
BRL_2017_wtd_summary <- list_of_summarized_dataframes_wtd[[10]]
BRL_2018_wtd_summary <- list_of_summarized_dataframes_wtd[[11]]
BRL_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[12]]
BRL_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[13]]
```

```{r}
A51_2019_wtd_summary
A51_2020_wtd_summary
BKD_2019_wtd_summary
BKN_2019_wtd_summary
BKN_2020_wtd_summary
BKS_2017_wtd_summary
BKS_2018_wtd_summary
BKS_2019_wtd_summary
BKS_2020_wtd_summary
BRL_2017_wtd_summary
BRL_2018_wtd_summary
BRL_2019_wtd_summary
BRL_2020_wtd_summary
```
```{r}

```

```{r}
p <- ggplot(BRL_2017_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2017") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
    annotate(geom = "text", 
           x = date(("2017-07-10")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-07-13")), 
           xend = date(("2017-07-13")), 
           y = 0, 
           yend = 250,
           color = "black")

p
```

```{r}
ggsave("Bear-Timelapse-2017-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BRL_2017_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2017") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2017-07-10")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-07-13")), 
           xend = date(("2017-07-13")), 
           y = 0, 
           yend = 250,
           color = "black")

p
```

```{r}
ggsave("Bear-Timelapse-2017-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BRL_2018_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2018") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Bear-Timelapse-2018-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```


```{r}
p <- ggplot(BRL_2018_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month", 
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2018") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Bear-Timelapse-2018-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BRL_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(-100, 10000), breaks = seq(0, 10000, by = 2500)) +
  labs(title = "Bear Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (10000/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 10000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2019-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BRL_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(-100, 10000), breaks = seq(0, 10000, by = 2500)) +
  labs(title = "Bear Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (10000/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 10000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2019-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BRL_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Bear Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-08")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-11")), 
           xend = date(("2020-07-11")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2020-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BRL_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Bear Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-08")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-11")), 
           xend = date(("2020-07-11")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2020-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(A51_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-08")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```
```{r}
ggsave("FiftyOne-Timelapse-2019-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(A51_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-08")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```
```{r}
ggsave("FiftyOne-Timelapse-2019-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(A51_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2020-07-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-12")),
           xend = date(("2020-07-12")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("FiftyOne-Timelapse-2020-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(A51_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2020-07-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-12")),
           xend = date(("2020-07-12")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("FiftyOne-Timelapse-2020-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKD_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Black Canyon Dam Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-Dam-Timelapse-2019-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKD_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Black Canyon Dam Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-Dam-Timelapse-2019-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2017_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2017") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2017-06-09")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-06-12")), 
           xend = date(("2017-06-12")), 
           y = 0, 
           yend = 250,
           color = "black")

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2017-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2017_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2017") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2017-06-09")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-06-12")), 
           xend = date(("2017-06-12")), 
           y = 0, 
           yend = 250,
           color = "black")

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2017-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2018_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2018") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2018-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2018_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month", 
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2018") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2018-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
       path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2019-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2019-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2020-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKS_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2020-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKN_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2019-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKN_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2019") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2019-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKN_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2020-Unweighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```

```{r}
p <- ggplot(BKN_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2020") +
  ylab("Forage Minutes (Weighted by Animal Unit Equivalencies)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2020-Weighted-Forage-Minutes-June-01-Sept-30.jpg",
     path = paste0(currentwd,"/figures", "/forage-minutes"))
```