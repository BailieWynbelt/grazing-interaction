---
title: "Photo Data Processing"
author: "Andrew Antaya"
output:
  html_document:
    df_print: paged
---
***
First, let's get our R environment ready by loading some useful packages.

***

Then, let's remove all objects from the environment to start fresh each time.
```{r}
# clear the enviroment
rm(list=ls(all=TRUE))
```

***
Let's check the working directory to see if it's correct.
```{r}
source(paste0(getwd(), "/environment.R"))

print(currentwd)
```
Looks good for my (Andrew's) PC
***
I created an external R script with contains all of the functions that I commonly use across different scripts. This chunk of code reads in those functions into the global R environment.
```{r include=FALSE}
## the source() funciton executes all lines of code in the "mentioned" script (i.e. the pathway)
source(paste0(currentwd, "/packages.R"))
```

```{r}
source(paste0(currentwd, "/functions.R"))
```
***
Let's read in the RAW photo data from 2017 and 2018, which human observers classified in a custom Excel macro (.xlsm written in VBA). The macro generates data for each image when a human observer selects different options based on what they see in each photo. We saved each of the .xlsm files (each file corresponding to a site and year) as .csv files for ease of use in R and to convert the .xlsm to a non-proprietary format.

For the first step in cleaing up the camera data, we are going to treat all fields with "" (blanks), " " (spaces- typically accidental input which is invisble in Excel), or "NA" (characters), as NA's inside R using the function na.strings(). This will help us deal with missing information in our dataset.
```{r}
# read in the 2017 data, treating all blanks, spaces, and "NA"s as NA's
BGW17 <- readr::read_csv('data/photo/BGW_2017.csv', col_names = TRUE, na = c(""," ","NA"))
WCS17 <- readr::read_csv('data/photo/WCS_2017.csv', col_names = TRUE, na = c(""," ","NA"))
BRL17 <- readr::read_csv('data/photo/BRL_2017.csv', col_names = TRUE, na = c(""," ","NA"))
BKS17 <- readr::read_csv('data/photo/BKS_2017.csv', col_names = TRUE, na = c(""," ","NA"))

print(BGW17)
print(WCS17)
print(BRL17)
print(BKS17)
```

```{r}
# read in the 2018 data, treating all blanks, spaces, and "NA"s as NA's
BGX18 <- readr::read_csv('data/photo/BGX_2018.csv', col_names = TRUE, na = c(""," ","NA"))
BGW18 <- readr::read_csv('data/photo/BGW_2018.csv', col_names = TRUE, na = c(""," ","NA"))
BGT18 <- readr::read_csv('data/photo/BGT_2018.csv', col_names = TRUE, na = c(""," ","NA"))
WCX18 <- readr::read_csv('data/photo/WCX_2018.csv', col_names = TRUE, na = c(""," ","NA"))
WCS18 <- readr::read_csv('data/photo/WCS_2018.csv', col_names = TRUE, na = c(""," ","NA"))
WCT18 <- readr::read_csv('data/photo/WCT_2018.csv', col_names = TRUE, na = c(""," ","NA"))
BRL18 <- readr::read_csv('data/photo/BRL_2018.csv', col_names = TRUE, na = c(""," ","NA"))
# BKS18 is incomplete but once it is done it will be read in
# BKS18RAW<-readr::read_csv('data/photo/BKS_2018.csv.csv', col_names = TRUE, na = c(""," ","NA"))

print(BGX18)
print(BGW18)
print(BGT18)
print(WCX18)
print(WCS18)
print(WCT18)
print(BRL18)
```

```{r}
# read in the 2019 data, treating all blanks, spaces, and "NA"s as NA's_19_RAW <- readr::read_csv("data/photo/A51_2019.csv", col_names = TRUE, na = c(""," ","NA"))
AFO19 <- readr::read_csv("data/photo/A51_2019.csv", col_names = TRUE, na = c(""," ","NA"))
BKD19 <- readr::read_csv("data/photo/BKD_2019.csv", col_names = TRUE, na = c(""," ","NA"))
BKN19 <- readr::read_csv("data/photo/BKN_2019.csv", col_names = TRUE, na = c(""," ","NA"))
BKS19 <- readr::read_csv("data/photo/BKS_2019.csv", col_names = TRUE, na = c(""," ","NA"))
BRL19 <- readr::read_csv("data/photo/BRL_2019.csv", col_names = TRUE, na = c(""," ","NA"))
BRT19 <- readr::read_csv("data/photo/BRT_2019.csv", col_names = TRUE, na = c(""," ","NA"))

print(AFO19)
print(BKD19)
print(BKN19)
print(BKS19)
print(BRL19)
print(BRT19)
```

```{r}
# read in the 2020 data, treating all blanks, spaces, and "NA"s as NA's
AFO20 <- readr::read_csv("data/photo/A51_2020.csv", col_names = TRUE, na = c(""," ","NA"))
BKN20 <- readr::read_csv("data/photo/BKN_2020.csv", col_names = TRUE, na = c(""," ","NA"))
BKS20 <- readr::read_csv("data/photo/BKS_2020.csv", col_names = TRUE, na = c(""," ","NA"))
BRL20 <- readr::read_csv("data/photo/BRL_2020.csv", col_names = TRUE, na = c(""," ","NA"))

print(AFO20)
print(BKN20)
print(BKS20)
print(BRL20)
```
***
We read in CSV files containing the camera data. Each data frame corresponds to a site and year (e.g., BGW18 is Boggy West Timelapse, data from year 2018). In all of the data frames, each row corresponds to a single image and each column corresponds to a single 'variable'. Some of these 'variables' are actually metadata, such as the file name of the image and the file path.
***

```{r}
BGW17 <- BGW17 %>% dplyr::mutate(Site = "Boggy", Year = 2017)
WCS17 <- WCS17 %>% dplyr::mutate(Site = "Wildcat", Year = 2017)
BRL17 <- BRL17 %>% dplyr::mutate(Site = "Bear", Year = 2017)
BKS17 <- BKS17 %>% dplyr::mutate(Site = "Black Canyon South", Year = 2017)
```

```{r}
data_2017 <- dplyr::bind_rows(BGW17, WCS17, BRL17, BKS17)

data_2017 <- data_2017 %>% relocate(Site, .before = RecordNumber)

data_2017 <- data_2017 %>% relocate(Year, .after = Site)

print(data_2017)
```

```{r}
BGX18 <- BGX18 %>% dplyr::mutate(Site = "Boggy Exclosure", Year = 2018)
BGW18 <- BGW18 %>% dplyr::mutate(Site = "Boggy West", Year = 2018)
BGT18 <- BGT18 %>% dplyr::mutate(Site = "Boggy Trail", Year = 2018)
WCX18 <- WCX18 %>% dplyr::mutate(Site = "Wildcat Exclosure", Year = 2018)
WCS18 <- WCS18 %>% dplyr::mutate(Site = "Wildcat South", Year = 2018)
WCT18 <- WCT18 %>% dplyr::mutate(Site = "Wildcat Trail", Year = 2018)
BRL18 <- BRL18 %>% dplyr::mutate(Site = "Bear Timelapse", Year = 2018)
```

```{r}
data_2018 <- dplyr::bind_rows(BGX18, BGW18, BGT18, WCX18, WCS18, WCT18, BRL18)

data_2018 <- data_2018 %>% relocate(Site, .before = RecordNumber)

data_2018 <- data_2018 %>% relocate(Year, .after = Site)

print(data_2018)
```

```{r}
AFO19 <- AFO19 %>% dplyr::mutate(Site = "Fifty One", Year = 2019)
BKD19 <- BKD19 %>% dplyr::mutate(Site = "Black Canyon Dam", Year = 2019)
BKN19 <- BKN19 %>% dplyr::mutate(Site = "Black Canyon North", Year = 2019)
BKS19 <- BKS19 %>% dplyr::mutate(Site = "Black Canyon South", Year = 2019)
BRL19 <- BRL19 %>% dplyr::mutate(Site = "Bear Timelapse", Year = 2019)
BRT19 <- BRT19 %>% dplyr::mutate(Site = "Bear Trail", Year = 2019)
```

```{r}
data_2019 <- dplyr::bind_rows(AFO19, BKD19, BKN19, BKS19, BRL19, BRT19)

data_2019 <- data_2019 %>% relocate(Site, .before = RecordNumber)

data_2019 <- data_2019 %>% relocate(Year, .after = Site)

data_2019$LastSavedOn <- data_2019 %>% pull(LastSavedOn) %>% openxlsx::convertToDateTime()

print(data_2019)
```

```{r}
AFO20 <- AFO20 %>% dplyr::mutate(Site = "Fifty One", Year = 2020)
BKN20 <- BKN20 %>% dplyr::mutate(Site = "Black Canyon Dam", Year = 2020)
BKS20 <- BKS20 %>% dplyr::mutate(Site = "Black Canyon North", Year = 2020)
BRL20 <- BRL20 %>% dplyr::mutate(Site = "Black Canyon South", Year = 2020)
```

```{r}
data_2020 <- dplyr::bind_rows(AFO20, BKN20, BKS20, BRL20)

data_2020 <- data_2020 %>% relocate(Site, .before = RecordNumber)

data_2020 <- data_2020 %>% relocate(Year, .after = Site)

data_2020$LastSavedOn <- data_2020 %>% pull(LastSavedOn) %>% openxlsx::convertToDateTime()

print(data_2020)
```

Some of the images we classified in the Excel macro were 'empty' (i.e. the observer could not detect a subject in the image). We want to remove these empty images from analysis.

We're going to use the "Count1Species"" column in each data frame to remove 'empty' photos. The "Count1Species" column corresponds to the 1st detected species in each photo (i.e. the primary species (>50%) if more than one species is detected in a photo). If the image is 'empty' then it will have "NA" for a value in the "Count1Species" column. We're going to use the function complete.cases() to remove all of the rows that have "NA" in the "Count1Species" column. We'll do this for each of the dataframes, and save these new dataframes into new objects.

```{r}
data_2017 %>% pull(Count1Species) %>% length()

data_2017_drop_na <- data_2017 %>% tidyr::drop_na(Count1Species)

data_2017_drop_na %>% pull(Count1Species) %>% length()
```

```{r}
data_2018 %>% pull(Count1Species) %>% length()

data_2018_drop_na <- data_2018 %>% tidyr::drop_na(Count1Species)

data_2018_drop_na %>% pull(Count1Species) %>% length()
```

```{r}
data_2019 %>% pull(Count1Species) %>% length()

data_2019_drop_na <- data_2019 %>% tidyr::drop_na(Count1Species)

data_2019_drop_na %>% pull(Count1Species) %>% length()
```

```{r}
data_2020 %>% pull(Count1Species) %>% length()

data_2020_drop_na <- data_2020 %>% tidyr::drop_na(Count1Species)

data_2020_drop_na %>% pull(Count1Species) %>% length()
```

***
Now we apply the clean dates function to our data.
```{r}
# TODO consider changing the clean.dates function to specify a column 
# instead of supplying a data frame and always selecting the ImageDate column
data_2017_clean_dates <- clean.dates(data_2017_drop_na)

data_2017_clean_dates$LastSavedOn <- data_2017_clean_dates %>% pull(LastSavedOn) %>% lubridate::mdy_hm()

print(data_2017_clean_dates)
```

```{r}
data_2018_clean_dates <- clean.dates(data_2018_drop_na)

data_2018_clean_dates$LastSavedOn <- data_2018_clean_dates %>% pull(LastSavedOn) %>% lubridate::mdy_hm()

print(data_2018_clean_dates)
```

```{r}
data_2019_drop_na$DateTime <- data_2019_drop_na %>% pull(DateTime) %>% lubridate::ymd_hms()

data_2019_clean_dates <- data_2019_drop_na %>% select(-c("ImageTime", "ImageDate"))

print(data_2019_clean_dates)
```

```{r}
data_2020_drop_na$DateTime <- data_2020_drop_na %>% pull(DateTime) %>% lubridate::ymd_hms()

data_2020_clean_dates <- data_2020_drop_na %>% select(-c("ImageTime", "ImageDate"))

print(data_2020_clean_dates)
```

***
```{r}
print(data_2017_clean_dates)

data_2018_rename_col <- data_2018_clean_dates %>% rename(multi = TraitB2)

data_2018_rename_col <- data_2018_rename_col %>% rename(water = Trait4)

print(data_2018_rename_col)

data_2019_rename_col <- data_2019_clean_dates %>% rename(multi = TraitB2)

data_2019_rename_col <- data_2019_rename_col %>% rename(water = Trait4)

print(data_2019_rename_col)

data_2020_rename_col <- data_2020_clean_dates %>% rename(multi = TraitB2)

data_2020_rename_col <- data_2020_rename_col %>% rename(water = Trait4)

print(data_2020_rename_col)
```

```{r}
all_photo_data <- bind_rows(data_2017_clean_dates, 
                            data_2018_rename_col, 
                            data_2019_rename_col, 
                            data_2020_rename_col)

view(all_photo_data)
```

```{r}
# readr::write_csv(all_photo_data, file.path(currentwd, "data", "photo", "all_photo_data.csv"))
```

***
Now that the data is cleaned up and we did some preliminary calculations, we're ready to start the analysis. First, let's calculate the Counts metric, which is the number of individuals of each species in a photo, summed for all the photos taken at a site for the season. Note: Counts does not represent the number of unique individuals using a site, rather Counts represents the same individuals revisiting a site across time and are counted again.
```{r}
BGT18counts <- counts.df(BGT18)
BGW17counts <- counts.df(BGW17)
BGW18counts <- counts.df(BGW18)
BGX18counts <- counts.df(BGX18)
WCS17counts <- counts.df(WCS17)
WCS18counts <- counts.df(WCS18)
WCT18counts <- counts.df(WCT18)
WCX18counts <- counts.df(WCX18)

A51_2019counts <- counts.df(A51_2019)
BKD_2019counts <- counts.df(BKD_2019)
BKN_2019counts <- counts.df(BKN_2019)
BKS_2019counts <- counts.df(BKS_2019)
BRL_2019counts <- counts.df(BRL_2019)
BRT_2019counts <- counts.df(BRT_2019)

A51_2020counts <- counts.df(A51_2020)
BKN_2020counts <- counts.df(BKN_2020)
BKS_2020counts <- counts.df(BKS_2020)
BRL_2020counts <- counts.df(BRL_2020)
```
***
To simplify the code, we're going to create new dataframes that contain only one species. In this case we are creating three new dataframes from each site, one dataframe corresponding to horses, another for cows, and the third for elk.
```{r}
BGT18horses <- BGT18[BGT18$horse >0, ]
BGT18cows <- BGT18[BGT18$cow >0, ]
BGT18elk <- BGT18[BGT18$elk >0, ]

BGW17horses <- BGW17[BGW17$horse >0, ]
BGW17cows <- BGW17[BGW17$cow >0, ]
BGW17elk <- BGW17[BGW17$elk >0, ]

BGW18horses <- BGW18[BGW18$horse >0, ]
BGW18cows <- BGW18[BGW18$cow >0, ]
BGW18elk <- BGW18[BGW18$elk >0, ]

BGX18horses <- BGX18[BGX18$horse >0, ]
BGX18cows <- BGX18[BGX18$cow >0, ]
BGX18elk <- BGX18[BGX18$elk >0, ]

WCS17horses <- WCS17[WCS17$horse >0, ]
WCS17cows <- WCS17[WCS17$cow >0, ]
WCS17elk <- WCS17[WCS17$elk >0, ]

WCS18horses <- WCS18[WCS18$horse >0, ]
WCS18cows <- WCS18[WCS18$cow >0, ]
WCS18elk <- WCS18[WCS18$elk >0, ]

WCT18horses <- WCT18[WCT18$horse >0, ]
WCT18cows <- WCT18[WCT18$cow >0, ]
WCT18elk <- WCT18[WCT18$elk >0, ]

WCX18horses <- WCX18[WCX18$horse >0, ]
WCX18cows <- WCX18[WCX18$cow >0, ]
WCX18elk <- WCX18[WCX18$elk >0, ]

A51_2019horses <- A51_2019[A51_2019$horse >0, ]
A51_2019cows <- A51_2019[A51_2019$cow >0, ]
A51_2019elk <- A51_2019[A51_2019$elk >0, ]

A51_2020horses <- A51_2020[A51_2020$horse >0, ]
A51_2020cows <- A51_2020[A51_2020$cow >0, ]
A51_2020elk <- A51_2020[A51_2020$elk >0, ]

BKD_2019horses <- BKD_2019[BKD_2019$horse >0, ]
BKD_2019cows <- BKD_2019[BKD_2019$cow >0, ]
BKD_2019elk <- BKD_2019[BKD_2019$elk >0, ]

BKN_2019horses <- BKN_2019[BKN_2019$horse >0, ]
BKN_2019cows <- BKN_2019[BKN_2019$cow >0, ]
BKN_2019elk <- BKN_2019[BKN_2019$elk >0, ]

BKN_2020horses <- BKN_2020[BKN_2020$horse >0, ]
BKN_2020cows <- BKN_2020[BKN_2020$cow >0, ]
BKN_2020elk <- BKN_2020[BKN_2020$elk >0, ]

BKS_2019horses <- BKS_2019[BKS_2019$horse >0, ]
BKS_2019cows <- BKS_2019[BKS_2019$cow >0, ]
BKS_2019elk <- BKS_2019[BKS_2019$elk >0, ]

BKS_2020horses <- BKS_2020[BKS_2020$horse >0, ]
BKS_2020cows <- BKS_2020[BKS_2020$cow >0, ]
BKS_2020elk <- BKS_2020[BKS_2020$elk >0, ]

BRL_2019horses <- BRL_2019[BRL_2019$horse >0, ]
BRL_2019cows <- BRL_2019[BRL_2019$cow >0, ]
BRL_2019elk <- BRL_2019[BRL_2019$elk >0, ]

BRL_2020horses <- BRL_2020[BRL_2020$horse >0, ]
BRL_2020cows <- BRL_2020[BRL_2020$cow >0, ]
BRL_2020elk <- BRL_2020[BRL_2020$elk >0, ]

BRT_2019horses <- BRT_2019[BRT_2019$horse >0, ]
BRT_2019cows <- BRT_2019[BRT_2019$cow >0, ]
BRT_2019elk <- BRT_2019[BRT_2019$elk >0, ]
```
***
To approximate herd dynamics using sequential photos, we're grouping photos together based on an observation window, where a sequential series of photos are aggregated together based on timestamps. Photos taken <10 minutes from the previous photo were included together in a gorup. If the next photo in the series was taken >= 10 minutes from the previous photo, this next photo was placed into the next group.
```{r}
BGT18grouptotals <- group.total(BGT18)
BGW17grouptotals <- group.total(BGW17)
BGW18grouptotals <- group.total(BGW18)
BGX18grouptotals <- group.total(BGX18)
WCS17grouptotals <- group.total(WCS17)
WCS18grouptotals <- group.total(WCS18)
WCT18grouptotals <- group.total(WCT18)
WCX18grouptotals <- group.total(WCX18)

A51_2019grouptotals <- group.total(A51_2019)
BKD_2019grouptotals <- group.total(BKD_2019)
BKN_2019grouptotals <- group.total(BKN_2019)
BKS_2019grouptotals <- group.total(BKS_2019)
BRL_2019grouptotals <- group.total(BRL_2019)
BRT_2019grouptotals <- group.total(BRT_2019)

A51_2020grouptotals <- group.total(A51_2020)
BRL_2020grouptotals <- group.total(BRL_2020)
BKS_2020grouptotals <- group.total(BKS_2020)
BKN_2020grouptotals <- group.total(BKN_2020)
```
***

```{r}
BGW17horses <- group.df(BGW17horses)
BGW17cows <- group.df(BGW17cows)
BGW17elk <- group.df(BGW17elk)
BGW18horses <- group.df(BGW18horses)
BGW18cows <- group.df(BGW18cows)
BGW18elk <- group.df(BGW18elk)
BGT18horses <- group.df(BGT18horses)
BGT18cows <- group.df(BGT18cows)
BGT18elk <- group.df(BGT18elk)
BGX18horses <- group.df(BGX18horses)
BGX18cows <- group.df(BGX18cows)
BGX18elk <- group.df(BGX18elk)
WCS17horses <- group.df(WCS17horses)
WCS17cows <- group.df(WCS17cows)
WCS17elk <- group.df(WCS17elk)
WCS18horses <- group.df(WCS18horses)
WCS18cows <- group.df(WCS18cows)
WCS18elk <- group.df(WCS18elk)
WCT18horses <- group.df(WCT18horses)
WCT18cows <- group.df(WCT18cows)
WCT18elk <- group.df(WCT18elk)
WCX18horses <- group.df(WCX18horses)
WCX18cows <- group.df(WCX18cows)
WCX18elk <- group.df(WCX18elk)

A51_2019cows <- group.df(A51_2019cows)
A51_2019horses <- group.df(A51_2019horses)
A51_2019elk <- group.df(A51_2019elk)
```
***
#### Grouping the groups by the pre-Monsoon period. 
```{r}
BGW17horses_pre <- filter(BGW17horses, DateTime < "2017-07-08 00:00:00")
BGW17cows_pre <- filter(BGW17cows, DateTime < "2017-07-08 00:00:00")
BGW17elk_pre <- filter(BGW17elk, DateTime < "2017-07-08 00:00:00")
head(BGW17horses_pre$DateTime, n = 1)
tail(BGW17horses_pre$DateTime, n = 1)
head(BGW17cows_pre$DateTime, n = 1)
tail(BGW17cows_pre$DateTime, n = 1)
head(BGW17elk_pre$DateTime, n = 1)
tail(BGW17elk_pre$DateTime, n = 1)
```
***
```{r}
BGW18horses_pre <- filter(BGW18horses, DateTime < "2018-07-08 00:00:00")
BGW18cows_pre <- filter(BGW18cows, DateTime < "2018-07-08 00:00:00")
BGW18elk_pre <- filter(BGW18elk, DateTime < "2018-07-08 00:00:00")
head(BGW18horses_pre$DateTime, n = 1)
tail(BGW18horses_pre$DateTime, n = 1)
head(BGW18cows_pre$DateTime, n = 1)
tail(BGW18cows_pre$DateTime, n = 1)
head(BGW18elk_pre$DateTime, n = 1)
tail(BGW18elk_pre$DateTime, n = 1)
```
***
```{r}
WCS17horses_pre <- filter(WCS17horses, DateTime < "2017-07-08 00:00:00")
WCS17cows_pre <- filter(WCS17cows, DateTime < "2017-07-08 00:00:00")
WCS17elk_pre <- filter(WCS17elk, DateTime < "2017-07-08 00:00:00")
head(WCS17horses_pre$DateTime, n = 1)
tail(WCS17horses_pre$DateTime, n = 1)
head(WCS17cows_pre$DateTime, n = 1)
tail(WCS17cows_pre$DateTime, n = 1)
head(WCS17elk_pre$DateTime, n = 1)
tail(WCS17elk_pre$DateTime, n = 1)
```
***
```{r}
WCS18horses_pre <- filter(WCS18horses, DateTime < "2018-07-08 00:00:00")
WCS18cows_pre <- filter(WCS18cows, DateTime < "2018-07-08 00:00:00")
WCS18elk_pre <- filter(WCS18elk, DateTime < "2018-07-08 00:00:00")
head(WCS18horses_pre$DateTime, n = 1)
tail(WCS18horses_pre$DateTime, n = 1)
head(WCS18cows_pre$DateTime, n = 1)
tail(WCS18cows_pre$DateTime, n = 1)
head(WCS18elk_pre$DateTime, n = 1)
tail(WCS18elk_pre$DateTime, n = 1)
```
***
#### Grouping the groups by the Monsoon period (8 July to 9 September)
```{r}
BGW17horses_mons <- filter(BGW17horses, DateTime >= "2017-07-08 00:00:00" & DateTime <"2017-09-10 00:00:00")
BGW17cows_mons <- filter(BGW17cows, DateTime >= "2017-07-08 00:00:00" & DateTime <"2017-09-10 00:00:00")
BGW17elk_mons <- filter(BGW17elk, DateTime >= "2017-07-08 00:00:00" & DateTime <"2017-09-10 00:00:00")
head(BGW17horses_mons$DateTime, n = 1)
tail(BGW17horses_mons$DateTime, n = 1)
head(BGW17cows_mons$DateTime, n = 1)
tail(BGW17cows_mons$DateTime, n = 1)
head(BGW17elk_mons$DateTime, n = 1)
tail(BGW17elk_mons$DateTime, n = 1)
```
***
```{r}
BGW18horses_mons <- filter(BGW18horses, DateTime >= "2018-07-08 00:00:00" & DateTime <"2018-09-10 00:00:00")
BGW18cows_mons <- filter(BGW18cows, DateTime >= "2018-07-08 00:00:00" & DateTime <"2018-09-10 00:00:00")
BGW18elk_mons <- filter(BGW18elk, DateTime >= "2018-07-08 00:00:00" & DateTime <"2018-09-10 00:00:00")
head(BGW18horses_mons$DateTime, n = 1)
tail(BGW18horses_mons$DateTime, n = 1)
head(BGW18cows_mons$DateTime, n = 1)
tail(BGW18cows_mons$DateTime, n = 1)
head(BGW18elk_mons$DateTime, n = 1)
tail(BGW18elk_mons$DateTime, n = 1)
```
***
####
```{r}
WCS17horses_mons <- filter(WCS17horses, DateTime >= "2017-07-08 00:00:00" & DateTime <"2017-09-10 00:00:00")
WCS17cows_mons <- filter(WCS17cows, DateTime >= "2017-07-08 00:00:00" & DateTime <"2017-09-10 00:00:00")
WCS17elk_mons <- filter(WCS17elk, DateTime >= "2017-07-08 00:00:00" & DateTime <"2017-09-10 00:00:00")
head(WCS17horses_mons$DateTime, n = 1)
tail(WCS17horses_mons$DateTime, n = 1)
head(WCS17cows_mons$DateTime, n = 1)
tail(WCS17cows_mons$DateTime, n = 1)
head(WCS17elk_mons$DateTime, n = 1)
tail(WCS17elk_mons$DateTime, n = 1)
```
***
```{r}
WCS18horses_mons <- filter(WCS18horses, DateTime >= "2018-07-08 00:00:00" & DateTime <"2018-09-10 00:00:00")
WCS18cows_mons <- filter(WCS18cows, DateTime >= "2018-07-08 00:00:00" & DateTime <"2018-09-10 00:00:00")
WCS18elk_mons <- filter(WCS18elk, DateTime >= "2018-07-08 00:00:00" & DateTime <"2018-09-10 00:00:00")
head(WCS18horses_mons$DateTime, n = 1)
tail(WCS18horses_mons$DateTime, n = 1)
head(WCS18cows_mons$DateTime, n = 1)
tail(WCS18cows_mons$DateTime, n = 1)
head(WCS18elk_mons$DateTime, n = 1)
tail(WCS18elk_mons$DateTime, n = 1)
```
***
#### Group the groups by the post-Monsoon period
```{r}
BGW17horses_post <- filter(BGW17horses, DateTime >= "2017-09-10 00:00:00")
BGW17cows_post <- filter(BGW17cows, DateTime >= "2017-09-10 00:00:00")
BGW17elk_post <- filter(BGW17elk, DateTime >= "2017-09-10 00:00:00")
head(BGW17horses_post$DateTime, n = 1)
tail(BGW17horses_post$DateTime, n = 1)
head(BGW17cows_post$DateTime, n = 1)
tail(BGW17cows_post$DateTime, n = 1)
head(BGW17elk_post$DateTime, n = 1)
tail(BGW17elk_post$DateTime, n = 1)
```
***
```{r}
BGW18horses_post <- filter(BGW18horses, DateTime >= "2018-09-10 00:00:00")
BGW18cows_post <- filter(BGW18cows, DateTime >= "2018-09-10 00:00:00")
BGW18elk_post <- filter(BGW18elk, DateTime >= "2018-09-10 00:00:00")
head(BGW18horses_post$DateTime, n = 1)
tail(BGW18horses_post$DateTime, n = 1)
head(BGW18cows_post$DateTime, n = 1)
tail(BGW18cows_post$DateTime, n = 1)
head(BGW18elk_post$DateTime, n = 1)
tail(BGW18elk_post$DateTime, n = 1)
```
####
```{r}
WCS17horses_post <- filter(WCS17horses, DateTime >= "2017-09-10 00:00:00")
WCS17cows_post <- filter(WCS17cows, DateTime >= "2017-09-10 00:00:00")
WCS17elk_post <- filter(WCS17elk, DateTime >= "2017-09-10 00:00:00")
head(WCS17horses_post$DateTime, n = 1)
tail(WCS17horses_post$DateTime, n = 1)
head(WCS17cows_post$DateTime, n = 1)
tail(WCS17cows_post$DateTime, n = 1)
head(WCS17elk_post$DateTime, n = 1)
tail(WCS17elk_post$DateTime, n = 1)
```
***
```{r}
WCS18horses_post <- filter(WCS18horses, DateTime >= "2018-09-10 00:00:00")
WCS18cows_post <- filter(WCS18cows, DateTime >= "2018-09-10 00:00:00")
WCS18elk_post <- filter(WCS18elk, DateTime >= "2018-09-10 00:00:00")
head(WCS18horses_post$DateTime, n = 1)
tail(WCS18horses_post$DateTime, n = 1)
head(WCS18cows_post$DateTime, n = 1)
tail(WCS18cows_post$DateTime, n = 1)
head(WCS18elk_post$DateTime, n = 1)
tail(WCS18elk_post$DateTime, n = 1)
```
***
####
```{r}
BGW17h_pre <- as.numeric(summarise(BGW17horses_pre, n_distinct(BGW17horses_pre$group)))
BGW17c_pre <- as.numeric(summarise(BGW17cows_pre, n_distinct(BGW17cows_pre$group)))
BGW17e_pre <- as.numeric(summarise(BGW17elk_pre, n_distinct(BGW17elk_pre$group)))
BGW17h_pre
BGW17c_pre
BGW17e_pre
```
***
####
```{r}
BGW18h_pre <- as.numeric(summarise(BGW18horses_pre, n_distinct(BGW18horses_pre$group)))
BGW18c_pre <- as.numeric(summarise(BGW18cows_pre, n_distinct(BGW18cows_pre$group)))
BGW18e_pre <- as.numeric(summarise(BGW18elk_pre, n_distinct(BGW18elk_pre$group)))
BGW18h_pre
BGW18c_pre
BGW18e_pre
```
***
####
```{r}
BGW17h_mons <- as.numeric(summarise(BGW17horses_mons, n_distinct(BGW17horses_mons$group)))
BGW17c_mons <- as.numeric(summarise(BGW17cows_mons, n_distinct(BGW17cows_mons$group)))
BGW17e_mons <- as.numeric(summarise(BGW17elk_mons, n_distinct(BGW17elk_mons$group)))
BGW17h_mons
BGW17c_mons
BGW17e_mons
```
***
####
```{r}
BGW18h_mons <- as.numeric(summarise(BGW18horses_mons, n_distinct(BGW18horses_mons$group)))
BGW18c_mons <- as.numeric(summarise(BGW18cows_mons, n_distinct(BGW18cows_mons$group)))
BGW18e_mons <- as.numeric(summarise(BGW18elk_mons, n_distinct(BGW18elk_mons$group)))
BGW18h_mons
BGW18c_mons
BGW18e_mons
```
***
####
```{r}
BGW17h_post <- as.numeric(summarise(BGW17horses_post, n_distinct(BGW17horses_post$group)))
BGW17c_post <- as.numeric(summarise(BGW17cows_post, n_distinct(BGW17cows_post$group)))
BGW17e_post <- as.numeric(summarise(BGW17elk_post, n_distinct(BGW17elk_post$group)))
BGW17h_post
BGW17c_post
BGW17e_post
```
***
####
```{r}
BGW18h_post <- as.numeric(summarise(BGW18horses_post, n_distinct(BGW18horses_post$group)))
BGW18c_post <- as.numeric(summarise(BGW18cows_post, n_distinct(BGW18cows_post$group)))
BGW18e_post <- as.numeric(summarise(BGW18elk_post, n_distinct(BGW18elk_post$group)))
BGW18h_post
BGW18c_post
BGW18e_post
```
***
####
```{r}
WCS17h_pre <- as.numeric(summarise(WCS17horses_pre, n_distinct(WCS17horses_pre$group)))
WCS17c_pre <- as.numeric(summarise(WCS17cows_pre, n_distinct(WCS17cows_pre$group)))
WCS17e_pre <- as.numeric(summarise(WCS17elk_pre, n_distinct(WCS17elk_pre$group)))
WCS17h_pre
WCS17c_pre
WCS17e_pre
```
***
####
```{r}
WCS18h_pre <- as.numeric(summarise(WCS18horses_pre, n_distinct(WCS18horses_pre$group)))
WCS18c_pre <- as.numeric(summarise(WCS18cows_pre, n_distinct(WCS18cows_pre$group)))
WCS18e_pre <- as.numeric(summarise(WCS18elk_pre, n_distinct(WCS18elk_pre$group)))
WCS18h_pre
WCS18c_pre
WCS18e_pre
```
***
####
```{r}
WCS17h_mons <- as.numeric(summarise(WCS17horses_mons, n_distinct(WCS17horses_mons$group)))
WCS17c_mons <- as.numeric(summarise(WCS17cows_mons, n_distinct(WCS17cows_mons$group)))
WCS17e_mons <- as.numeric(summarise(WCS17elk_mons, n_distinct(WCS17elk_mons$group)))
WCS17h_mons
WCS17c_mons
WCS17e_mons
```
***
####
```{r}
WCS18h_mons <- as.numeric(summarise(WCS18horses_mons, n_distinct(WCS18horses_mons$group)))
WCS18c_mons <- as.numeric(summarise(WCS18cows_mons, n_distinct(WCS18cows_mons$group)))
WCS18e_mons <- as.numeric(summarise(WCS18elk_mons, n_distinct(WCS18elk_mons$group)))
WCS18h_mons
WCS18c_mons
WCS18e_mons
```
***
####
```{r}
WCS17h_post <- as.numeric(summarise(WCS17horses_post, n_distinct(WCS17horses_post$group)))
WCS17c_post <- as.numeric(summarise(WCS17cows_post, n_distinct(WCS17cows_post$group)))
WCS17e_post <- as.numeric(summarise(WCS17elk_post, n_distinct(WCS17elk_post$group)))
WCS17h_post
WCS17c_post
WCS17e_post
```
***
####
```{r}
WCS18h_post <- as.numeric(summarise(WCS18horses_post, n_distinct(WCS18horses_post$group)))
WCS18c_post <- as.numeric(summarise(WCS18cows_post, n_distinct(WCS18cows_post$group)))
WCS18e_post <- as.numeric(summarise(WCS18elk_post, n_distinct(WCS18elk_post$group)))
WCS18h_post
WCS18c_post
WCS18e_post
```
***
####
```{r}
BGW17groups = matrix(c(BGW17h_pre, BGW17c_pre, BGW17e_pre, BGW17h_mons, BGW17c_mons, BGW17e_mons, BGW17h_post, BGW17c_post, BGW17e_post), nrow = 3)
colnames(BGW17groups) = c("Pre-Monsoon", "Monsoon", "Post-Monsoon")
rownames(BGW17groups) = c("Horses", "Cattle", "Elk")
BGW17groups
```
***
####
```{r}
BGW18groups = matrix(c(BGW18h_pre, BGW18c_pre, BGW18e_pre, BGW18h_mons, BGW18c_mons, BGW18e_mons, BGW18h_post, BGW18c_post, BGW18e_post), nrow = 3)
colnames(BGW18groups) = c("Pre-Monsoon", "Monsoon", "Post-Monsoon")
rownames(BGW18groups) = c("Horses", "Cattle", "Elk")
BGW18groups
```
***
####
```{r}
WCS17groups = matrix(c(WCS17h_pre, WCS17c_pre, WCS17e_pre, WCS17h_mons, WCS17c_mons, WCS17e_mons, WCS17h_post, WCS17c_post, WCS17e_post), nrow = 3)
colnames(WCS17groups) = c("Pre-Monsoon", "Monsoon", "Post-Monsoon")
rownames(WCS17groups) = c("Horses", "Cattle", "Elk")
WCS17groups
```
***
####
```{r}
WCS18groups = matrix(c(WCS18h_pre, WCS18c_pre, WCS18e_pre, WCS18h_mons, WCS18c_mons, WCS18e_mons, WCS18h_post, WCS18c_post, WCS18e_post), nrow = 3)
colnames(WCS18groups) = c("Pre-Monsoon", "Monsoon", "Post-Monsoon")
rownames(WCS18groups) = c("Horses", "Cattle", "Elk")
WCS18groups
```
***
#### Site Use by Time of Day
```{r}
BGW17horsetime <- sumbyhour(BGW17horses, "horse")
BGW17cowtime <- sumbyhour(BGW17cows, "cow")
BGW17elktime <- sumbyhour(BGW17elk, "elk")

BGW17horsetime
BGW17cowtime
BGW17elktime

BGW17time <- data.frame(horsefreq = (BGW17horsetime$freq), cowfreq = (BGW17cowtime$freq), elkfreq = (BGW17elktime$freq))

BGW17time

BGW17time<- as.matrix(BGW17time)

BGW17time

A51_2019cowtime <- sumbyhour(A51_2019cows, "cow")
A51_2019horsetime <- sumbyhour(A51_2019horses, "horse")
A51_2019elktime <- sumbyhour(A51_2019elk, "elk")

A51_2019cowtime
A51_2019horsetime
A51_2019elktime
```

```{r}
hrs <- as.character(c("00:00:00", "01:00:00", "02:00:00", "03:00:00", "04:00:00", "05:00:00", "06:00:00", "07:00:00", "08:00:00", "09:00:00", "10:00:00", "11:00:00", "12:00:00", "13:00:00", "14:00:00", "15:00:00", "16:00:00", "17:00:00", "18:00:00", "19:00:00", "20:00:00", "21:00:00", "22:00:00", "23:00:00"))
hrs
```

```{r}
#Boggy Trail 2018
BGT18horsetime <- sumbyhour(BGT18horses, "horse")
BGT18cowtime <- sumbyhour(BGT18cows, "cow")
BGT18elktime <- sumbyhour(BGT18elk, "elk")
BGT18time <- data.frame(horsefreq = (BGT18horsetime$freq), cowfreq = (BGT18cowtime$freq), elkfreq = (BGT18elktime$freq))
BGT18time<- as.matrix(BGT18time)

# Boggy West 2018
BGW18horsetime <- sumbyhour(BGW18horses, "horse")
BGW18cowtime <- sumbyhour(BGW18cows, "cow")
BGW18elktime <- sumbyhour(BGW18elk, "elk")
BGW18time <- data.frame(horsefreq = (BGW18horsetime$freq), cowfreq = (BGW18cowtime$freq), elkfreq = (BGW18elktime$freq))
BGW18time<- as.matrix(BGW18time)

# Boggy Exclosure 2018
BGX18horsetime <- sumbyhour(BGX18horses, "horse")
BGX18cowtime <- sumbyhour(BGX18cows, "cow")
BGX18elktime <- sumbyhour(BGX18elk, "elk")
BGX18time <- data.frame(horsefreq = (BGX18horsetime$freq), cowfreq = (BGX18cowtime$freq), elkfreq = (BGX18elktime$freq))
BGX18time<- as.matrix(BGX18time)

# Wildcat South 2017
WCS17horsetime <- sumbyhour(WCS17horses, "horse")
WCS17cowtime <- sumbyhour(WCS17cows, "cow")
WCS17elktime <- sumbyhour(WCS17elk, "elk")
WCS17time <- data.frame(horsefreq = (WCS17horsetime$freq), cowfreq = (WCS17cowtime$freq), elkfreq = (WCS17elktime$freq))
WCS17time<- as.matrix(WCS17time)

# Wildcat South 2018
WCS18horsetime <- sumbyhour(WCS18horses, "horse")
WCS18cowtime <- sumbyhour(WCS18cows, "cow")
WCS18elktime <- sumbyhour(WCS18elk, "elk")
WCS18time <- data.frame(horsefreq = (WCS18horsetime$freq), cowfreq = (WCS18cowtime$freq), elkfreq = (WCS18elktime$freq))
WCS18time<- as.matrix(WCS18time)

# Wildcat Trail 2018
WCT18horsetime <- sumbyhour(WCT18horses, "horse")
WCT18cowtime <- sumbyhour(WCT18cows, "cow")
WCT18elktime <- sumbyhour(WCT18elk, "elk")
WCT18time <- data.frame(horsefreq = (WCT18horsetime$freq), cowfreq = (WCT18cowtime$freq), elkfreq = (WCT18elktime$freq))
WCT18time<- as.matrix(WCT18time)

# Wildcat Exclosure 2018
WCX18horsetime <- sumbyhour(WCX18horses, "horse")
WCX18cowtime <- sumbyhour(WCX18cows, "cow")
WCX18elktime <- sumbyhour(WCX18elk, "elk")
WCX18time <- data.frame(horsefreq = (WCX18horsetime$freq), cowfreq = (WCX18cowtime$freq), elkfreq = (WCX18elktime$freq))
WCX18time<- as.matrix(WCX18time)
```
***
#### Duration
```{r}
BGW17h_duration <- group.duration(BGW17horses)
BGW17c_duration <- group.duration(BGW17cows)
BGW17e_duration <- group.duration(BGW17elk)
hist(BGW17h_duration, breaks = 10)
hist(BGW17c_duration, breaks = 10)
hist(BGW17e_duration, breaks = 10)
```
```{r}
BGT18h_duration <- group.duration(BGT18horses)
BGT18c_duration <- group.duration(BGT18cows)
BGT18e_duration <- group.duration(BGT18elk)

BGW18h_duration <- group.duration(BGW18horses)
BGW18c_duration <- group.duration(BGW18cows)
BGW18e_duration <- group.duration(BGW18elk)

BGX18h_duration <- group.duration(BGX18horses)
BGX18c_duration <- group.duration(BGX18cows)
BGX18e_duration <- group.duration(BGX18elk)

WCS17h_duration <- group.duration(WCS17horses)
WCS17c_duration <- group.duration(WCS17cows)
WCS17e_duration <- group.duration(WCS17elk)

WCS18h_duration <- group.duration(WCS18horses)
WCS18c_duration <- group.duration(WCS18cows)
WCS18e_duration <- group.duration(WCS18elk)

WCT18h_duration <- group.duration(WCT18horses)
WCT18c_duration <- group.duration(WCT18cows)
WCT18e_duration <- group.duration(WCT18elk)

WCX18h_duration <- group.duration(WCX18horses)
WCX18c_duration <- group.duration(WCX18cows)
WCX18e_duration <- group.duration(WCX18elk)
```

```{r}
BGT18duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(BGT18h_duration), sum(BGT18c_duration), sum(BGT18e_duration)))
BGT18duration

BGW17duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(BGW17h_duration), sum(BGW17c_duration), sum(BGW17e_duration)))
BGW17duration

BGW18duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(BGW18h_duration), sum(BGW18c_duration), sum(BGW18e_duration)))
BGW18duration

BGX18duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(BGX18h_duration), sum(BGX18c_duration), sum(BGX18e_duration)))
BGX18duration

WCS17duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(WCS17h_duration), sum(WCS17c_duration), sum(WCS17e_duration)))
WCS17duration

WCS18duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(WCS18h_duration), sum(WCS18c_duration), sum(WCS18e_duration)))
WCS18duration

WCT18duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(WCT18h_duration), sum(WCT18c_duration), sum(WCT18e_duration)))
WCT18duration

WCX18duration <- data.frame(species = c("Horses", "Cattle", "Elk"), freq = c(sum(WCX18h_duration), sum(WCX18c_duration), sum(WCX18e_duration)))
WCX18duration
```
```{r}
BGT18duration$freq <- round(BGT18duration$freq)
BGT18duration

BGW17duration$freq <- round(BGW17duration$freq)
BGW17duration

BGW18duration$freq <- round(BGW18duration$freq)
BGW18duration

BGX18duration$freq <- round(BGX18duration$freq)
BGX18duration

WCS17duration$freq <- round(WCS17duration$freq)
WCS17duration

WCS18duration$freq <- round(WCS18duration$freq)
WCS18duration

WCT18duration$freq <- round(WCT18duration$freq)
WCT18duration

WCX18duration$freq <- round(WCX18duration$freq)
WCX18duration
```


```{r}
# BGW17 = matrix(c(BGW17h_pre, BGW17c_pre, BGW17e_pre, BGW17h_mons, BGW17c_mons, BGW17e_mons, BGW17h_post, BGW17c_post, BGW17e_post), nrow = 3)
# colnames(BGW17groups) = c("Pre-Monsoon", "Monsoon", "Post-Monsoon")
# rownames(BGW17groups) = c("Horses", "Cattle", "Elk")
# BGW17groups
```

```{r}
BGW17
```

***
```{r}
#   horses <- BGW17[BGW17$horse >0, ]
#   cattle <- BGW17[BGW17$cow >0, ]
#   elk <- BGW17[BGW17$elk >0, ]
#   deer <- BGW17[BGW17$deer >0, ]
# 
#   horses <- arrange(horses, DateTime)
#   cattle <- arrange(cattle, DateTime)
#   elk <- arrange(elk, DateTime)
#   deer <- arrange(deer, DateTime)
# 
#   lag_time_diffh <- difftime(horses$DateTime, lag(horses$DateTime, default = horses$DateTime[1]), units = "mins")
#   lag_time_diffc <- difftime(cattle$DateTime, lag(cattle$DateTime, default = cattle$DateTime[1]), units = "mins")
#   lag_time_diffe <- difftime(elk$DateTime, lag(elk$DateTime, default = elk$DateTime[1]), units = "mins")
#   lag_time_diffd <- difftime(deer$DateTime, lag(deer$DateTime, default = deer$DateTime[1]), units = "mins")
# 
#   horses$group <- cumsum(ifelse(lag_time_diffh>10,1,0))
#   cattle$group <- cumsum(ifelse(lag_time_diffc>10,1,0))
#   elk$group <- cumsum(ifelse(lag_time_diffe>10,1,0))
#   deer$group <- cumsum(ifelse(lag_time_diffd>10,1,0))
# 
#   horses$group <- horses$group+1
#   cattle$group <- cattle$group+1
#   elk$group <- elk$group+1
#   deer$group <- deer$group+1
# 
# BGW17h_max <- horses %<>% group_by(group) %>% summarize(Species = "Horses", max = max(horse))
# BGW17c_max <- cattle %<>% group_by(group) %>% summarize(Species = "Cattle", max = max(cow))
# BGW17e_max <- elk %<>% group_by(group) %>% summarize(Species = "Elk", max = max(elk))
# BGW17d_max <- deer %<>% group_by(group) %>% summarize(Species = "Muledeer", max = max(deer))

# groupsize <- data.frame(Site = ("BGW17"),
#                         Year = as.factor(2017),
#                         Species = c("Horse", "Cattle", "Elk", "Muledeer"),
#                         maxaverage_group = (c(round(mean(horses$max)),
#                                               round(mean(cattle$max)),
#                                               round(mean(elk$max)),
#                                               round(mean(deer$max))
#                                               )
#                                             )
#                         )
# is.nan.data.frame <- function(x)
#   do.call(cbind, lapply(x, is.nan))
# 
# groupsize$maxaverage_group[is.nan(groupsize$maxaverage_group)] <- 0
# 
# groupsize
# max(BGW17h_max$max)
# max(BGW17c_max$max)
# max(BGW17e_max$max)
# max(BGW17d_max$max)
```

```{r}
BGT18groupsize <- group.size(BGT18)
BGT18groupsize
BGW17groupsize <- group.size(BGW17)
BGW17groupsize
BGW18groupsize <- group.size(BGW18)
BGW18groupsize
BGX18groupsize <- group.size(BGX18)
BGX18groupsize
WCS17groupsize <- group.size(WCS17)
WCS17groupsize
WCS18groupsize <- group.size(WCS18)
WCS18groupsize
WCT18groupsize <- group.size(WCT18)
WCT18groupsize
WCX18groupsize <- group.size(WCX18)
WCX18groupsize
```
***
### Multi Species
```{r}
BGW17multi <- filter(BGW17, BGW17$multi == "Yes")
BGW17multi

count(BGW17multi, BGW17multi$Count1Species)
count(BGW17multi, BGW17multi$Count2Species)
count(BGW17multi, BGW17multi$Count3Species)
count(BGW17multi, BGW17multi$Count4Species)
count(BGW17multi, BGW17multi$Count5Species)
```
```{r}
BGW17hc <- BGW17[BGW17$horse > 0 & BGW17$cow > 0, ]
BGW17hc

BGW17he <- BGW17[BGW17$horse > 0 & BGW17$elk > 0, ]
BGW17he

BGW17ce <- BGW17[BGW17$cow > 0 & BGW17$elk > 0, ]
BGW17ce

BGW17hd <- BGW17[BGW17$horse > 0 & BGW17$deer > 0, ]
BGW17hd

BGW17ed <- BGW17[BGW17$elk > 0 & BGW17$deer > 0, ]
BGW17ed

BGW17ep <- BGW17[BGW17$elk > 0 & BGW17$pronghorn > 0, ]
BGW17ep
```
```{r}
WCS17hc <- WCS17[WCS17$horse > 0 & WCS17$cow > 0, ]
WCS17hc
WCS17hc_table <- count(WCS17hc, WCS17hc$multi)
WCS17hc_table$n

WCS17he <- WCS17[WCS17$horse > 0 & WCS17$elk > 0, ]
WCS17he
WCS17he_table <- count(WCS17he, WCS17he$multi)
WCS17he_table$n

WCS17ce <- WCS17[WCS17$cow > 0 & WCS17$elk > 0, ]
WCS17ce
WCS17ce_table <- count(WCS17ce, WCS17ce$multi)
WCS17ce_table$n

WCS17hd <- WCS17[WCS17$horse > 0 & WCS17$deer > 0, ]
WCS17hd
WCS17hd_table <- count(WCS17hd, WCS17hd$multi)
WCS17hd_table$n

WCS17ed <- WCS17[WCS17$elk > 0 & WCS17$deer > 0, ]
WCS17ed
WCS17ed_table <- count(WCS17ed, WCS17ed$multi)
WCS17ed_table$n

WCS17ep <- WCS17[WCS17$elk > 0 & WCS17$pronghorn > 0, ]
WCS17ep
WCS17ep_table <- count(WCS17ep, WCS17ep$multi)
WCS17ep_table$n

WCS17multi <- matrix(c(WCS17hc_table$n, 
                       WCS17he_table$n, 
                       WCS17ce_table$n, 
                       WCS17hd_table$n, 
                       WCS17ed_table$n, 
                       WCS17ep_table$n))
colnames(WCS17multi) = c("freq")
rownames(WCS17multi) = c("Horse/Cow", "Horse/Elk", "Cow/Elk", "Horse/Deer", "Elk/Deer", "Elk/Pronghorn")
WCS17multi

WCS17 %>% 
  rename(TraitB2 = multi)

WCS17
```
```{r}
WCS17multi.df<- as.data.frame(WCS17multi)
str(WCS17multi.df)
```
```{r}
# WCS18hc.df <- WCS18[WCS18$horse > 0 & WCS18$cow > 0, ]
# WCS18hc <- if (length(WCS18hc.df) > 0){
#   WCS18hc_table <- count(WCS18hc.df, WCS18hc.df$multi)
#   WCS18hc <- sum(WCS18hc_table$n)
# } else {0}
# WCS18hc
# 
# WCS18he.df <- WCS18[WCS18$horse > 0 & WCS18$elk > 0, ]
# WCS18he <- if (length(WCS18he.df) > 0){
#   WCS18he_table <- count(WCS18he.df, WCS18he.df$multi)
#   WCS18he <- sum(WCS18he_table$n)
# } else {0}
# WCS18he
# 
# WCS18ce.df <- WCS18[WCS18$cow > 0 & WCS18$elk > 0, ]
# WCS18ce <- if (length(WCS18ce.df) > 0){
#   WCS18ce_table <- count(WCS18ce.df, WCS18ce.df$multi)
#   WCS18ce <- sum(WCS18ce_table$n)
# } else {0}
# WCS18ce
#   
# WCS18hd.df <- WCS18[WCS18$horse > 0 & WCS18$deer > 0, ]
# WCS18hd <- if (length(WCS18hd.df) > 0){
#   WCS18hd_table <- count(WCS18hd.df, WCS18hd.df$multi)
#   WCS18hd <- sum(WCS18hd_table$n)
# } else {0}
# WCS18hd
# 
# WCS18ed.df <- WCS18[WCS18$elk > 0 & WCS18$deer > 0, ]
# WCS18ed <- if (length(WCS18ed.df) > 0){
#   WCS18ed_table <- count(WCS18ed.df, WCS18ed.df$multi)
#   WCS18ed <- sum(WCS18ed_table$n)
# } else {0}
# WCS18ed
# 
# WCS18ep.df <- WCS18[WCS18$elk > 0 & WCS18$pronghorn > 0, ]
# WCS18ep <- if (length(WCS18ep.df) > 0){
#   WCS18ep_table <- count(WCS18ep.df, WCS18ep.df$multi)
#   WCS18ep <- sum(WCS18ep_table$n)
# } else {0}
# WCS18ep
# 
# WCS18multi <- data.frame(interaction = c("Horse/Cow", "Horse/Elk", "Cow/Elk", "Horse/Deer", "Elk/Deer", "Elk/Pronghorn"), freq = c(WCS18hc, WCS18he, WCS18ce, WCS18hd, WCS18ed, WCS18ep))
# 
# WCS18multi
```

```{r}
BGT18multi <- multi.inter(BGT18)
BGT18multi
BGW17multi <- multi.inter(BGW17)
BGW17multi
BGW18multi <- multi.inter(BGW18)
BGW18multi
BGX18multi <- multi.inter(BGX18)
BGX18multi

WCS17multi <- multi.inter(WCS17)
WCS17multi
WCS18multi <- multi.inter(WCS18)
WCS18multi
WCT18multi <- multi.inter(WCT18)
WCT18multi
WCX18multi <- multi.inter(WCX18)
WCX18multi
```
***
### Use of Waterway
```{r}
BGW17water.df <- BGW17[complete.cases(BGW17[ , 'water']),]

BGW17water <- BGW17water.df[BGW17water.df$water == "Yes" & BGW17water.df$multi == "No", ]

BGW17water <- BGW17water[BGW17water$Count1Species == "Cow" | BGW17water$Count1Species == "Horse" | BGW17water$Count1Species == "Elk", ]

BGW17water <- count(BGW17water, BGW17water$Count1Species)

na.exclude(BGW17water)


BGW18water.df <- BGW18[complete.cases(BGW18[ , 'water']),]

BGW18water <- BGW18water.df[BGW18water.df$water == "Yes" & BGW18water.df$multi == "No", ]

BGW18water <- BGW18water[BGW18water$Count1Species == "Cow" | BGW18water$Count1Species == "Horse" | BGW18water$Count1Species == "Elk", ]

BGW18water <- count(BGW18water, BGW18water$Count1Species)

BGW18water <- na.exclude(BGW18water)

x <- c("Horse", "Cow", "Elk")

BGW18water %>% slice(match(x, BGW18water$`BGW18water$Count1Species`))

```

```{r}
BGT18water <- waterway(BGT18)
BGW17water <- waterway(BGW17)
BGW18water <- waterway(BGW18)
BGX18water <- waterway(BGX18)
WCS17water <- waterway(WCS17)
WCS18water <- waterway(WCS18)
WCT18water <- waterway(WCT18)
WCX18water <- waterway(WCX18)

BGX18water <- add_row(BGX18water, 'cameradfwater$Count1Species' = "Horse", n = 0)
BGX18water <- add_row(BGX18water, 'cameradfwater$Count1Species' = "Cow", n = 0)
BGX18water <- add_row(BGX18water, 'cameradfwater$Count1Species' = "Elk", n = 0)

WCX18water <- add_row(WCX18water, 'cameradfwater$Count1Species' = "Cow", n = 0, .after = 1)

BGT18water
BGW17water
BGW18water
BGX18water
WCS17water
WCS18water
WCT18water
WCX18water
```
***
### Behavioral Frequency
```{r}
BGW17ukn  <- filter(BGW17, BGW17$ConditionsB6 == "Unknown")
#summary(BGW17)
```

```{r}
BGW17horses
```


```{r}
BGT18c_nomulti <- filter(BGT18cows, multi == "No")

cameradf_forage <- na.omit(count(BGT18c_nomulti, ConditionsB1))
cameradf_forage <- if (sum(is.na(BGT18c_nomulti$ConditionsB1)) == nrow(BGT18c_nomulti)) {
add_row(cameradf_forage, ConditionsB1 = "Forage", n = 0)
} else {na.omit(count(BGT18c_nomulti, ConditionsB1))
  } 

cameradf_drink <- na.omit(count(BGT18c_nomulti, ConditionsB2))
cameradf_drink <- if (sum(is.na(BGT18c_nomulti$ConditionsB2)) == nrow(BGT18c_nomulti)) {
add_row(cameradf_drink, ConditionsB2 = "Drink", n = 0)
} else {na.omit(count(BGT18c_nomulti, ConditionsB2))
} 

cameradf_walkrun <- na.omit(count(BGT18c_nomulti, ConditionsB3))
cameradf_walkrun <- if (sum(is.na(BGT18c_nomulti$ConditionsB3)) == nrow(BGT18c_nomulti)) {
add_row(cameradf_walkrun, ConditionsB3 = "Walk/Run", n = 0)
} else {na.omit(count(BGT18c_nomulti, ConditionsB1))
  } 

cameradf_bed <- na.omit(count(BGT18c_nomulti, ConditionsB4))
cameradf_bed <- if (sum(is.na(BGT18c_nomulti$ConditionsB4)) == nrow(BGT18c_nomulti)) {
add_row(cameradf_bed, ConditionsB4 = "Bed", n = 0)
} else {na.omit(count(BGT18c_nomulti, ConditionsB4))
  } 

cameradf_stand <- na.omit(count(BGT18c_nomulti, ConditionsB5))
cameradf_stand <- if (sum(is.na(BGT18c_nomulti$ConditionsB5)) == nrow(BGT18c_nomulti)) {
add_row(cameradf_stand, ConditionsB5 = "Stand", n = 0)
} else {na.omit(count(BGT18c_nomulti, ConditionsB1))
  } 

cameradf_unknown <- na.omit(count(BGT18c_nomulti, ConditionsB6))
cameradf_unknown <- if (sum(is.na(BGT18c_nomulti$ConditionsB6)) == nrow(BGT18c_nomulti)) {
add_row(cameradf_unknown, ConditionsB6 = "Unknown", n = 0)
} else {na.omit(count(BGT18c_nomulti, ConditionsB6))
  } 

total <- sum(cameradf_forage$n, cameradf_drink$n, cameradf_walkrun$n, cameradf_bed$n, cameradf_stand$n, cameradf_unknown$n)

cameradf_behav <- data.frame(behavior = c("Forage", "Drink", "Walk/Run", "Bedded", "Stand", "Unknown"), 
                              count = c(cameradf_forage$n, 
                                        cameradf_drink$n, 
                                        cameradf_walkrun$n, 
                                        cameradf_bed$n, 
                                        cameradf_stand$n, 
                                        cameradf_unknown$n), 
                              percent = c(cameradf_forage$n/total,
                                          cameradf_drink$n/total,
                                          cameradf_walkrun$n/total,
                                          cameradf_bed$n/total,
                                          cameradf_stand$n/total,
                                          cameradf_unknown$n/total))
cameradf_behav
```
```{r}
# for some reason the multi species comlumn has all NA's,. which throws off the behavior calculcation (specifically because the "calc.behav" function sorts out all the multi-species detections which also excludes NA's)
BGX18elk$multi <- "No"
BGX18elk$multi <- as.factor(BGX18elk$multi)
BGX18elk$multi
```

```{r}
BGT18h_behav <- calc.behav(BGT18horses)
BGT18c_behav <- calc.behav(BGT18cows)
BGT18e_behav <- calc.behav(BGT18elk)

BGW17h_behav <- calc.behav(BGW17horses)
BGW17c_behav <- calc.behav(BGW17cows)
BGW17e_behav <- calc.behav(BGW17elk)

BGW18h_behav <- calc.behav(BGW18horses)
BGW18c_behav <- calc.behav(BGW18cows)
BGW18e_behav <- calc.behav(BGW18elk)

BGX18h_behav <- calc.behav(BGX18horses)
BGX18c_behav <- calc.behav(BGX18cows)
BGX18e_behav <- calc.behav(BGX18elk)

WCS17h_behav <- calc.behav(WCS17horses)
WCS17c_behav <- calc.behav(WCS17cows)
WCS17e_behav <- calc.behav(WCS17elk)

WCS18h_behav <- calc.behav(WCS18horses)
WCS18c_behav <- calc.behav(WCS18cows)
WCS18e_behav <- calc.behav(WCS18elk)

WCT18h_behav <- calc.behav(WCT18horses)
WCT18c_behav <- calc.behav(WCT18cows)
WCT18e_behav <- calc.behav(WCT18elk)

WCX18h_behav <- calc.behav(WCX18horses)
WCX18c_behav <- calc.behav(WCX18cows)
WCX18e_behav <- calc.behav(WCX18elk)

BGT18h_behav
BGT18c_behav
BGT18e_behav

BGW17h_behav
BGW17c_behav
BGW17e_behav

BGW18h_behav
BGW18c_behav
BGW18e_behav

BGX18h_behav
BGX18c_behav
BGX18e_behav

WCS17h_behav
WCS17c_behav
WCS17e_behav

WCS18h_behav
WCS18c_behav
WCS18e_behav

WCT18h_behav
WCT18c_behav
WCT18e_behav

WCX18h_behav
WCX18c_behav
WCX18e_behav
```

```{r}
BGW17behav <- matrix(c(BGW17h_behav$percent[1],
                       BGW17c_behav$percent[1],
                       BGW17e_behav$percent[1],
                       BGW17h_behav$percent[2],
                       BGW17c_behav$percent[2],
                       BGW17e_behav$percent[2],
                       BGW17h_behav$percent[3],
                       BGW17c_behav$percent[3],
                       BGW17e_behav$percent[3],
                       BGW17h_behav$percent[4],
                       BGW17c_behav$percent[4],
                       BGW17e_behav$percent[4],
                       BGW17h_behav$percent[5], 
                       BGW17c_behav$percent[5],
                       BGW17e_behav$percent[5],
                       BGW17h_behav$percent[6],
                       BGW17c_behav$percent[6],
                       BGW17e_behav$percent[6]), nrow = 3)
rownames(BGW17behav) = c("Horses", "Cattle", "Elk")
colnames(BGW17behav) = c("Foraging", "Drinking", "Moving", "Bedded", "Standing", "Unknown")
BGW17behav
```
```{r}
dim(BGW17behav)
```

```{r}
BGT18behav <- behav.matrix(BGT18h_behav, BGT18c_behav, BGT18e_behav)
BGT18behav
BGW187behav <- behav.matrix(BGW17h_behav, BGW17c_behav, BGW17e_behav)
BGW17behav
BGW18behav <- behav.matrix(BGW18h_behav, BGW18c_behav, BGW18e_behav)
BGW18behav
BGX18behav <- behav.matrix(BGX18h_behav, BGX18c_behav, BGX18e_behav)
BGX18behav
WCS17behav <- behav.matrix(WCS17h_behav, WCS17c_behav, WCS17e_behav)
WCS17behav
WCS18behav <- behav.matrix(WCS18h_behav, WCS18c_behav, WCS18e_behav)
WCS18behav
WCT18behav <- behav.matrix(WCT18h_behav, WCT18c_behav, WCT18e_behav)
WCT18behav
WCX18behav <- behav.matrix(WCX18h_behav, WCX18c_behav, WCX18e_behav)
WCX18behav
```

```{r}
BGX18
```






