---
title: "Grazing Minutes"
author: "Andrew Antaya"
date: "June 20, 2019"
output:
  html_document: 
    theme: readable
    toc: yes
    toc_depth: 5
    fig_caption: yes
  word_document:
    toc: yes
---

# Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      dpi = 300)
knitr::opts_knit$set(root.dir = "~/grazing-interaction")

source("~/grazing-interaction/environment.R")
source("~/grazing-interaction/packages.R")
source("~/grazing-interaction/functions.R")

flextable::set_flextable_defaults(
  font.size = 10, 
  theme_fun = theme_box,
  text.align = "center",
  fonts_ignore = TRUE,
  background.color = "#EFEFEF")
```

------------------------------------------------------------------------

Now, we can load in the cleaned photo data generated by "photo-processing.Rmd" script. This data has already been corrected for erroneous data, re-named columns for consistency across years, and some columns have been converted to specific data types (e.g., DateTime as a S3:POSIXct).

```{r read csv files in directory}
path_to_csv_files <- fs::dir_ls(file.path(currentwd, 
                                  "data", 
                                  "photo", 
                                  "combined-by-site-year",
                                  "processed"), 
                                regexp = "\\.csv$")

path_to_csv_files
```

```{r set column specification}
source(file.path(currentwd,
                 "scripts", 
                 "utilities", 
                 "cameradf-column-specification.R")
       )
```

```{r load all csv files}
all_data <- path_to_csv_files %>% 
  purrr::map_dfr(readr::read_csv,
             na = c("", " ", "NA"),
             col_types = col_spec)
```

------------------------------------------------------------------------

We're going to use a function I created called "speciestotal" (see the functions.R script) which is specific to the way we classified our data. The issue is that the 'Count1Species' column in our data frames doesn't correspond to a specific species, rather it corresponds to whatever species is the primary species detected (>50% of individuals if a multiple species are detected in an image).

The "speciestotal" function will count up the number of individuals for each species detected in a camera trap photo and then create a new column in the corresponding dataframe to store this species count. The new column is labeled by the species and contains a count of the number of individuals detected in each image.

A second function "allspecies" uses the "speciestotal" function for all of the species possible (24 total), and creates a new column for each species.

```{r species counts}

all_data_all_species <- allspecies(all_data)

```

------------------------------------------------------------------------

This new data frame has 24 additional columns that contain counts of the 'subjects' (e.g., horses, cows, ATVs, humans) in each photo. These columns were created primarily to simplify the data frame, where a single row has the counts for each species stored in a separate column.

```{r black canyon south 2017}
BKS_2017 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2017")
  
print(BKS_2017)
```

```{r black canyon south 2018}
BKS_2018 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2018")
  
print(BKS_2018)
```

```{r black canyon south 2019}
BKS_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2019")
  
print(BKS_2019)
```

```{r black canyon south 2020}
BKS_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon South") %>% 
  dplyr::filter(Year == "2020")
  
print(BKS_2020)
```

```{r bear timelapse 2017}
# TODO go back to the photo processing step and name this site as "Bear Timelapse"
BRL_2017 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear") %>% 
  dplyr::filter(Year == "2017")
  
print(BRL_2017)
```

```{r bear timelapse 2018}
BRL_2018 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear Timelapse") %>% 
  dplyr::filter(Year == "2018")
  
print(BRL_2018)
```

```{r bear timelapse 2019}
BRL_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear Timelapse") %>% 
  dplyr::filter(Year == "2019")
  
print(BRL_2019)
```

```{r bear timelapse 2020}
BRL_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Bear Timelapse") %>%
  dplyr::filter(Year == "2020")
  
print(BRL_2020)
```

```{r fifty one timelapse 2019}
A51_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Fifty One") %>% 
  dplyr::filter(Year == "2019")
  
print(A51_2019)
```

```{r fifty one timelapse 2020}
A51_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Fifty One") %>% 
  dplyr::filter(Year == "2020")
  
print(A51_2020)
```

```{r black canyon dam 2019}
BKD_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon Dam") %>% 
  dplyr::filter(Year == "2019")
  
print(BKD_2019)
```

```{r black canyon north 2019}
BKN_2019 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon North") %>% 
  dplyr::filter(Year == "2019")

print(BKN_2019)
```

```{r black canyon north 2020}
BKN_2020 <- all_data_all_species %>% 
  dplyr::filter(Site == "Black Canyon North") %>% 
  dplyr::filter(Year == "2020")
  
print(BKN_2020)
```

------------------------------------------------------------------------

Let's check the operational dates for Bear Timelapse 2018. This represents only the dates in this data frame, which corresponds only to 'subject' photos. This data frame does not contain blank or empty photos that were sorted out during an earlier phase of photo processing.

```{r}
BRL_2018 %>% pull(DateTime) %>% lubridate::date() %>% unique() %>% tibble()

BRL_2019 %>% pull(DateTime) %>% lubridate::date() %>% unique() %>% tibble()
```

These operational dates represent days with observations containing subjects, but does not contain the dates without observations, but where the camera was still functioning.

------------------------------------------------------------------------

Let's calculate grazing minutes using the Bear Timelapse 2018 data. From our metadata, we know that the Bear Timelapse site in 2018 used a 1 minute collection interval for timelapse photos.

```{r}
calc.grazing.time.unwtd <- function(cameradf, interval) {
  cameradf <- cameradf %>% dplyr::mutate(horse_grazing_unwtd = horse * interval)
  
  cameradf <- cameradf %>% dplyr::mutate(cow_grazing_unwtd = cow * interval)
  
  cameradf <- cameradf %>% dplyr::mutate(elk_grazing_unwtd = elk * interval)
  
  return(cameradf)
}

calc.grazing.time.wtd <- function(cameradf, interval) {
  cameradf <- cameradf %>% dplyr::mutate(horse_grazing_wtd = horse * interval * 1.1)
  
  cameradf <- cameradf %>% dplyr::mutate(cow_grazing_wtd = cow * interval * 1)
  
  cameradf <- cameradf %>% dplyr::mutate(elk_grazing_wtd = elk * interval * 0.7)
  
  return(cameradf)
}
```

```{r calc grazing bear timelapse}
BRL_2017 <- calc.grazing.time.unwtd(BRL_2017, interval = 1)

BRL_2017 <- calc.grazing.time.wtd(BRL_2017, interval = 1)

BRL_2018 <- calc.grazing.time.unwtd(BRL_2018, interval = 1)

BRL_2018 <- calc.grazing.time.wtd(BRL_2018, interval = 1)

BRL_2019 <- calc.grazing.time.unwtd(BRL_2019, interval = 5)

BRL_2019 <- calc.grazing.time.wtd(BRL_2019, interval = 5)

BRL_2020 <- calc.grazing.time.unwtd(BRL_2020, interval = 5)

BRL_2020 <- calc.grazing.time.wtd(BRL_2020, interval = 5)
```

```{r calc grazing fifty one}
A51_2019 <- calc.grazing.time.unwtd(A51_2019, interval = 5)

A51_2019 <- calc.grazing.time.wtd(A51_2019, interval = 5)

A51_2020 <- calc.grazing.time.unwtd(A51_2020, interval = 5)

A51_2020 <- calc.grazing.time.wtd(A51_2020, interval = 5)
```

```{r calc grazing black canyon dam}
BKD_2019 <- calc.grazing.time.unwtd(BKD_2019, interval = 5)

BKD_2019 <- calc.grazing.time.wtd(BKD_2019, interval = 5)
```

```{r calc grazing black canyon north}
BKN_2019 <- calc.grazing.time.unwtd(BKN_2019, interval = 5)

BKN_2019 <- calc.grazing.time.wtd(BKN_2019, interval = 5)

BKN_2020 <- calc.grazing.time.unwtd(BKN_2020, interval = 5)

BKN_2020 <- calc.grazing.time.wtd(BKN_2020, interval = 5)
```

```{r calc grazing black canyon south}
BKS_2017 <- calc.grazing.time.unwtd(BKS_2017, interval = 1)

BKS_2017 <- calc.grazing.time.wtd(BKS_2017, interval = 1)

BKS_2018 <- calc.grazing.time.unwtd(BKS_2018, interval = 1)

BKS_2018 <- calc.grazing.time.wtd(BKS_2018, interval = 1)

BKS_2019 <- calc.grazing.time.unwtd(BKS_2019, interval = 5)

BKS_2019 <- calc.grazing.time.wtd(BKS_2019, interval = 5)

BKS_2020 <- calc.grazing.time.unwtd(BKS_2020, interval = 5)

BKS_2020 <- calc.grazing.time.wtd(BKS_2020, interval = 5)
```

```{r}
BKS_2018 %>% pull(horse_grazing_unwtd) %>% sum()

BKS_2018 %>% pull(horse_grazing_wtd) %>% sum()
```

```{r}
BKS_2018 %>% pull(cow_grazing_unwtd) %>% sum()

BKS_2018 %>% pull(cow_grazing_wtd) %>% sum()
```

```{r}
BKS_2018 %>% pull(elk_grazing_unwtd) %>% sum()

BKS_2018 %>% pull(elk_grazing_wtd) %>% sum()
```

```{r}
BKS_2018 %>% pull(DateTime) %>% lubridate::date() %>% unique()
```

```{r function summarize unweighted daily totals}
summarize.unwtd.daily.totals <- function(cameradf){

  cameradf_horses <- NULL
  cameradf_horses <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_unwtd = sum(horse_grazing_unwtd))
  cameradf_horses <- cameradf_horses %>% mutate(Species = "Horse")
  
  cameradf_cows <- NULL
  cameradf_cows <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_unwtd = sum(cow_grazing_unwtd))
  cameradf_cows <- cameradf_cows %>% mutate(Species = "Cow")  
  
  cameradf_elk <- NULL
  cameradf_elk <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_unwtd = sum(elk_grazing_unwtd))
  cameradf_elk <- cameradf_elk %>% mutate(Species = "Elk")  
  
  cameradf_bind <- dplyr::bind_rows(cameradf_horses, cameradf_cows, cameradf_elk)
  
  cameradf_bind$Site <- NULL
  
  cameradf_bind$Site <- cameradf$Site[1]
  
  cameradf_bind$Year <- NULL
  
  cameradf_bind$Year <- cameradf$Year[1]
  
  return(cameradf_bind)
}
```

```{r function summarize weighted daily totals}
summarize.wtd.daily.totals <- function(cameradf){

  cameradf_horses <- NULL
  cameradf_horses <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_wtd = sum(horse_grazing_wtd))
  cameradf_horses <- cameradf_horses %>% mutate(Species = "Horse")
  
  cameradf_cows <- NULL
  cameradf_cows <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_wtd = sum(cow_grazing_wtd))
  cameradf_cows <- cameradf_cows %>% mutate(Species = "Cow")  
  
  cameradf_elk <- NULL
  cameradf_elk <- cameradf %>% 
    dplyr::group_by(Date) %>% 
    dplyr::summarise(daily_total_wtd = sum(elk_grazing_wtd))
  cameradf_elk <- cameradf_elk %>% mutate(Species = "Elk")  
  
  cameradf_bind <- dplyr::bind_rows(cameradf_horses, cameradf_cows, cameradf_elk)
  
  cameradf_bind$Site <- NULL
  
  cameradf_bind$Site <- cameradf$Site[1]
  
  cameradf_bind$Year <- NULL
  
  cameradf_bind$Year <- cameradf$Year[1]
  
  return(cameradf_bind)
}
```

```{r}
summarize.unwtd.daily.totals(BKS_2018)
```

```{r}
summarize.wtd.daily.totals(BKS_2018)
```

```{r}
list_of_dataframes <- list(A51_2019, 
                           A51_2020, 
                           BKD_2019, 
                           BKN_2019, 
                           BKN_2020, 
                           BKS_2017, 
                           BKS_2018, 
                           BKS_2019, 
                           BKS_2020, 
                           BRL_2017, 
                           BRL_2018, 
                           BRL_2019, 
                           BRL_2020)

list_of_dataframes
```

```{r}
list_of_summarized_dataframes_unwtd <- list_of_dataframes %>% purrr::map(summarize.unwtd.daily.totals)

list_of_summarized_dataframes_unwtd
```

```{r}
list_of_summarized_dataframes_wtd <- list_of_dataframes %>% purrr::map(summarize.wtd.daily.totals)

list_of_summarized_dataframes_wtd
```

```{r}
# purrr::flatten(list_of_summarized_dataframes_unwtd)
```

```{r}
A51_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[1]]
A51_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[2]]
BKD_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[3]]
BKN_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[4]]
BKN_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[5]]
BKS_2017_unwtd_summary <- list_of_summarized_dataframes_unwtd[[6]]
BKS_2018_unwtd_summary <- list_of_summarized_dataframes_unwtd[[7]]
BKS_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[8]]
BKS_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[9]]
BRL_2017_unwtd_summary <- list_of_summarized_dataframes_unwtd[[10]]
BRL_2018_unwtd_summary <- list_of_summarized_dataframes_unwtd[[11]]
BRL_2019_unwtd_summary <- list_of_summarized_dataframes_unwtd[[12]]
BRL_2020_unwtd_summary <- list_of_summarized_dataframes_unwtd[[13]]
```

```{r}
A51_2019_unwtd_summary
A51_2020_unwtd_summary
BKD_2019_unwtd_summary
BKN_2019_unwtd_summary
BKN_2020_unwtd_summary
BKS_2017_unwtd_summary
BKS_2018_unwtd_summary
BKS_2019_unwtd_summary
BKS_2020_unwtd_summary
BRL_2017_unwtd_summary
BRL_2018_unwtd_summary
BRL_2019_unwtd_summary
BRL_2020_unwtd_summary
```

```{r}
A51_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[1]]
A51_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[2]]
BKD_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[3]]
BKN_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[4]]
BKN_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[5]]
BKS_2017_wtd_summary <- list_of_summarized_dataframes_wtd[[6]]
BKS_2018_wtd_summary <- list_of_summarized_dataframes_wtd[[7]]
BKS_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[8]]
BKS_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[9]]
BRL_2017_wtd_summary <- list_of_summarized_dataframes_wtd[[10]]
BRL_2018_wtd_summary <- list_of_summarized_dataframes_wtd[[11]]
BRL_2019_wtd_summary <- list_of_summarized_dataframes_wtd[[12]]
BRL_2020_wtd_summary <- list_of_summarized_dataframes_wtd[[13]]
```

```{r}
A51_2019_wtd_summary
A51_2020_wtd_summary
BKD_2019_wtd_summary
BKN_2019_wtd_summary
BKN_2020_wtd_summary
BKS_2017_wtd_summary
BKS_2018_wtd_summary
BKS_2019_wtd_summary
BKS_2020_wtd_summary
BRL_2017_wtd_summary
BRL_2018_wtd_summary
BRL_2019_wtd_summary
BRL_2020_wtd_summary
```

```{r Bear 2017 Unweighted Figure}
p <- ggplot(BRL_2017_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
    annotate(geom = "text", 
           x = date(("2017-07-10")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-07-13")), 
           xend = date(("2017-07-13")), 
           y = 0, 
           yend = 250,
           color = "black")
ggsave("Bear-Timelapse-2017-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
p
```

```{r Bear 2017 Weighted Figure}
p <- ggplot(BRL_2017_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2017-07-10")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-07-13")), 
           xend = date(("2017-07-13")), 
           y = 0, 
           yend = 250,
           color = "black")

p
```

```{r}
ggsave("Bear-Timelapse-2017-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Bear 2018 Unweighted Figure}
p <- ggplot(BRL_2018_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Bear-Timelapse-2018-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Bear 2018 Weighted Figure}
p <- ggplot(BRL_2018_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month", 
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Bear-Timelapse-2018-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Bear 2019 Unweighted Figure}
p <- ggplot(BRL_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(-100, 10000), breaks = seq(0, 10000, by = 2500)) +
  labs(title = "Bear Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (10000/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 10000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Bear 2019 Weighted Figure}
p <- ggplot(BRL_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(-100, 10000), breaks = seq(0, 10000, by = 2500)) +
  labs(title = "Bear Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (10000/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 10000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Bear 2020 Unweighted Figure}
p <- ggplot(BRL_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Bear Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-08")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-11")), 
           xend = date(("2020-07-11")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Bear 2020 Weighted Figure}
p <- ggplot(BRL_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Bear Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-08")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-11")), 
           xend = date(("2020-07-11")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Bear-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(A51_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-08")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("FiftyOne-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(A51_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-08")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("FiftyOne-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
        height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(A51_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2020-07-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-12")),
           xend = date(("2020-07-12")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("FiftyOne-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(A51_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2020-07-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-12")),
           xend = date(("2020-07-12")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("FiftyOne-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKD_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Black Canyon Dam Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-Dam-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKD_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Black Canyon Dam Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text",
           x = date(("2019-06-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-Dam-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKS_2017_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2017-06-09")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-06-12")), 
           xend = date(("2017-06-12")), 
           y = 0, 
           yend = 250,
           color = "black")

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2017-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKS_2017_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2017-06-09")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-06-12")), 
           xend = date(("2017-06-12")), 
           y = 0, 
           yend = 250,
           color = "black")

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2017-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Black Canyon South 2018 Unweighted Daily Site Use Figure}
p <- ggplot(BKS_2018_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2018-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r Black Canyon South 2018 Weighted Daily Site Use Figure}
p <- ggplot(BKS_2018_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2018-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
       path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKS_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKS_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKS_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKS_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-South-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKN_2019_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKN_2019_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKN_2020_unwtd_summary, aes(x = Date, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
p <- ggplot(BKN_2020_wtd_summary, aes(x = Date, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 2) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
p
```

```{r}
ggsave("Black-Canyon-North-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
      height = 6,
       width = 9,
       units = "in",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
calc.grazing.totals.unwtd <- function(site_summary){
  site_total <- site_summary %>% 
    dplyr::group_by(Species) %>% 
    dplyr::summarise(season_total = sum(daily_total_unwtd)) %>% 
    dplyr::mutate(proportion = season_total/sum(season_total)) %>% 
    dplyr::mutate(Site = site_summary$Site[1])
  
return(site_total)
}
```

```{r}
calc.grazing.totals.wtd <- function(site_summary){
  site_total <- site_summary %>% 
    dplyr::group_by(Species) %>% 
    dplyr::summarise(season_total = sum(daily_total_wtd)) %>% 
    dplyr::mutate(proportion = season_total/sum(season_total)) %>% 
    dplyr::mutate(Site = site_summary$Site[1])
  
return(site_total)
}
```

```{r }
reorder.factors.by.season.total <- function(sitetotal){
  sitetotal$Species <- sitetotal$Species %>% forcats::as_factor()
  sitetotal$Species <- forcats::fct_reorder(sitetotal$Species, sitetotal$season_total)
  
  return(sitetotal)
}
```

```{r}
BKS_2018 %>% pull(horse_grazing_unwtd) %>% sum()

BKS_2018 %>% pull(horse_grazing_wtd) %>% sum()
```

```{r}
BKS_2018 %>% pull(cow_grazing_unwtd) %>% sum()

BKS_2018 %>% pull(cow_grazing_wtd) %>% sum()
```

```{r}
BKS_2018 %>% pull(elk_grazing_unwtd) %>% sum()

BKS_2018 %>% pull(elk_grazing_wtd) %>% sum()
```

```{r}
BRL_2017_unwtd_summary %>% 
  dplyr::group_by(Species) %>% 
  dplyr::summarise(season_total = sum(daily_total_unwtd))
```

```{r}
BRL_2017_unwtd_total <- BRL_2017_unwtd_summary %>% 
  dplyr::group_by(Species) %>% 
  dplyr::summarise(season_total = sum(daily_total_unwtd)) %>% 
  dplyr::mutate(proportion = season_total/sum(season_total)) %>% 
  dplyr::mutate(Site = "Bear")

BRL_2017_unwtd_total
```

```{r}
BKS_2017_unwtd_total <- BKS_2017_unwtd_summary %>% 
  dplyr::group_by(Species) %>% 
  dplyr::summarise(season_total = sum(daily_total_unwtd)) %>% 
  dplyr::mutate(proportion = season_total/sum(season_total)) %>% 
  dplyr::mutate(Site = "Black Canyon South")

BKS_2017_unwtd_total
```

```{r}
BRL_2017_unwtd_total$Species <- BRL_2017_unwtd_total %>% 
  pull(Species) %>% 
  forcats::as_factor()

levels(BRL_2017_unwtd_total$Species)
```

```{r}
BRL_2017_unwtd_total$Species <- 
  forcats::fct_reorder(BRL_2017_unwtd_total$Species, BRL_2017_unwtd_total$season_total)

levels(BRL_2017_unwtd_total$Species)
```

```{r}
# BRL_2017_unwtd_total$Species <- forcats::fct_rev(BRL_2017_unwtd_total$Species)
# 
# levels(BRL_2017_unwtd_total$Species)
```

```{r}
BKS_2017_unwtd_total$Species <- BKS_2017_unwtd_total %>% 
  pull(Species) %>% 
  forcats::as_factor()

levels(BKS_2017_unwtd_total$Species)
```

```{r}
BKS_2017_unwtd_total$Species <-   forcats::fct_reorder(BKS_2017_unwtd_total$Species, BKS_2017_unwtd_total$season_total)

levels(BKS_2017_unwtd_total$Species)
```

```{r}
# BKS_2017_unwtd_total$Species <- forcats::fct_rev(BKS_2017_unwtd_total$Species)
# 
# levels(BKS_2017_unwtd_total$Species)
```

```{r}
unwtd_2017 <- bind_rows(BRL_2017_unwtd_total, BKS_2017_unwtd_total)
unwtd_2017
```

```{r}
unwtd_2017$Species <- unwtd_2017 %>% 
  dplyr::pull(Species) %>% 
  forcats::fct_relevel(c("Elk", "Cow", "Horse"))

levels(unwtd_2017$Species)
```

```{r}
pull.species.percentage <- function(site_unwtd_total, species){
  site_unwtd_percent_species <- site_unwtd_total %>% 
    dplyr::filter(Species == species) %>% 
    dplyr::pull(proportion)
  return(site_unwtd_percent_species)
}
```

```{r}
BRL_2017_unwtd_cow_percent <- pull.species.percentage(BRL_2017_unwtd_total, species = "Cow")
BRL_2017_unwtd_elk_percent <- pull.species.percentage(BRL_2017_unwtd_total, species = "Elk")
BRL_2017_unwtd_horse_percent <- pull.species.percentage(BRL_2017_unwtd_total, species = "Horse")
```

```{r}
BKS_2017_unwtd_cow_percent <- pull.species.percentage(BKS_2017_unwtd_total, species = "Cow")
BKS_2017_unwtd_elk_percent <- pull.species.percentage(BKS_2017_unwtd_total, species = "Elk")
BKS_2017_unwtd_horse_percent <- pull.species.percentage(BKS_2017_unwtd_total, species = "Horse")
```

```{r 2017 Unwtd Total Grazing Minutes}
p <- ggplot(unwtd_2017, aes(x = Site, y = season_total, fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2017",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  annotate(geom = "text", 
           x = 1, 
           y = 2500, 
           label = percent(BRL_2017_unwtd_cow_percent, 0.1)) +
  annotate(geom = "label", 
           x = 1, 
           y = 0, 
           label = percent(BRL_2017_unwtd_horse_percent, 0.1),
           fill = "#619CFF") +
  annotate(geom = "label", 
           x = 1, 
           y = 5000, 
           label = percent(BRL_2017_unwtd_elk_percent),
           fill = "#00BA38") +
  annotate(geom = "text", 
           x = 2, 
           y = 12500, 
           label = percent(BKS_2017_unwtd_cow_percent)) +
  annotate(geom = "text", 
           x = 2, 
           y = 3000, 
           label = percent(BKS_2017_unwtd_horse_percent)) +
    annotate(geom = "label", 
           x = 2, 
           y = 21000, 
           label = percent(BKS_2017_unwtd_elk_percent),
           fill = "#00BA38") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) 

p
```

```{r}
ggsave("2017-Total-Grazing-Minutes-by-Site-Unweighted.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
BRL_2017_wtd_total <- BRL_2017_wtd_summary %>% 
  dplyr::group_by(Species) %>% 
  dplyr::summarise(season_total = sum(daily_total_wtd)) %>% 
  dplyr::mutate(proportion = season_total/sum(season_total)) %>% 
  dplyr::mutate(Site = "Bear")

BRL_2017_wtd_total
```

```{r}
BKS_2017_wtd_total <- BKS_2017_wtd_summary %>% 
  dplyr::group_by(Species) %>% 
  dplyr::summarise(season_total = sum(daily_total_wtd)) %>% 
  dplyr::mutate(proportion = season_total/sum(season_total)) %>% 
  dplyr::mutate(Site = "Black Canyon South")

BKS_2017_wtd_total
```

```{r}
BRL_2017_wtd_total$Species <- BRL_2017_wtd_total %>% 
  pull(Species) %>% 
  forcats::as_factor()

levels(BRL_2017_wtd_total$Species)
```

```{r}
BRL_2017_wtd_total$Species <- 
  forcats::fct_reorder(BRL_2017_wtd_total$Species, BRL_2017_wtd_total$season_total)

levels(BRL_2017_wtd_total$Species)
```

```{r}
BKS_2017_wtd_total$Species <- BKS_2017_wtd_total %>% 
  pull(Species) %>% 
  forcats::as_factor()

levels(BKS_2017_wtd_total$Species)
```

```{r}
BKS_2017_wtd_total$Species <-   forcats::fct_reorder(BKS_2017_wtd_total$Species, BKS_2017_wtd_total$season_total)

levels(BKS_2017_wtd_total$Species)
```

```{r}
wtd_2017 <- bind_rows(BRL_2017_wtd_total, BKS_2017_wtd_total)
wtd_2017
```

```{r}
levels(wtd_2017$Species)
```

```{r}
wtd_2017$Species <- wtd_2017 %>% dplyr::pull(Species) %>% forcats::fct_relevel(c("Elk", "Cow", "Horse"))

levels(wtd_2017$Species)
```

```{r}
BRL_2017_wtd_cow_percent <- pull.species.percentage(BRL_2017_wtd_total, species = "Cow")
BRL_2017_wtd_elk_percent <- pull.species.percentage(BRL_2017_wtd_total, species = "Elk")
BRL_2017_wtd_horse_percent <- pull.species.percentage(BRL_2017_wtd_total, species = "Horse")
```

```{r}
BRL_2017_wtd_cow_percent
BRL_2017_wtd_elk_percent
BRL_2017_wtd_horse_percent

BRL_2017_wtd_cow_percent %>% round(digits = 2)
BRL_2017_wtd_elk_percent %>% signif(digits = 2)
BRL_2017_wtd_horse_percent %>% signif(digits = 2)
```

```{r}
BKS_2017_wtd_cow_percent <- pull.species.percentage(BKS_2017_wtd_total, species = "Cow")
BKS_2017_wtd_elk_percent <- pull.species.percentage(BKS_2017_wtd_total, species = "Elk")
BKS_2017_wtd_horse_percent <- pull.species.percentage(BKS_2017_wtd_total, species = "Horse")
```


```{r 2017 Wtd Total grazing Minutes}
p <- ggplot(wtd_2017, aes(x = Site, y = season_total, fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2017",
       x = "Site",
       y = "Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  annotate(geom = "text", 
           x = 1, 
           y = 2700, 
           label = percent(BRL_2017_wtd_cow_percent)) +
  annotate(geom = "label", 
           x = 1, 
           y = 0, 
           label = percent(BRL_2017_wtd_horse_percent),
           fill = "#619CFF") +
  annotate(geom = "label", 
           x = 1, 
           y = 5000, 
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "text", 
           x = 2, 
           y = 13500, 
           label = percent(BKS_2017_wtd_cow_percent)) +
  annotate(geom = "text", 
           x = 2, 
           y = 4000, 
           label = percent(BKS_2017_wtd_horse_percent)) +
    annotate(geom = "label", 
           x = 2, 
           y = 21000, 
           label = percent(BKS_2017_wtd_elk_percent),
           fill = "#00BA38") +

  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) 

p
```

```{r}
ggsave("2017-Total-Grazing-Minutes-by-Site-Weighted-by-AUE.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
BRL_2018_unwtd_total <- calc.grazing.totals.unwtd(BRL_2018_unwtd_summary)

BKS_2018_unwtd_total <- calc.grazing.totals.unwtd(BKS_2018_unwtd_summary)

print(BRL_2018_unwtd_total)
print(BKS_2018_unwtd_total)
```

```{r}
BRL_2018_unwtd_total <- reorder.factors.by.season.total(BRL_2018_unwtd_total)

BKS_2018_unwtd_total <- reorder.factors.by.season.total(BKS_2018_unwtd_total)

print(BRL_2018_unwtd_total)
print(BKS_2018_unwtd_total)
```

```{r}
levels(BRL_2018_unwtd_total$Species)
levels(BKS_2018_unwtd_total$Species)
```

```{r rbind 2018 totals}
unwtd_2018 <- dplyr::bind_rows(BRL_2018_unwtd_total, BKS_2018_unwtd_total)

unwtd_2018
```

```{r}
unwtd_2018 %>% dplyr::filter(Site == "Black Canyon South") %>% pull(season_total) %>% sum()
unwtd_2018 %>% dplyr::filter(Site == "Bear Timelapse") %>% pull(season_total) %>% sum()
```


```{r}
levels(unwtd_2018$Species)
```

```{r}
unwtd_2018$Species <- unwtd_2018$Species %>% fct_relevel(c("Elk", "Horse", "Cow"))

levels(unwtd_2018$Species)
```

```{r}
unwtd_2018_cow_percent <- pull.species.percentage(unwtd_2018, species = "Cow")
unwtd_2018_elk_percent <- pull.species.percentage(unwtd_2018, species = "Elk")
unwtd_2018_horse_percent <- pull.species.percentage(unwtd_2018, species = "Horse")
```

```{r 2018 Unwtd Total grazing Minutes}
p <- ggplot(unwtd_2018, 
            aes(x = Site, 
                y = season_total, 
                fill = Species, 
                label = scales::percent(proportion, 1))) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2018",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_y_continuous(limits = c(0, 10000), breaks = seq(0, 10000, by = 2500))+
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  geom_fit_text(position = "stack", show.legend = FALSE) +
  annotate(geom = "label",
           x = 1,
           y = 3000,
           label = "<1%",
           fill = "#F8766D") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) 

p
```

```{r}
ggsave("2018-Total-Grazing-Minutes-Unweighted.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
BRL_2018_wtd_total <- calc.grazing.totals.wtd(BRL_2018_wtd_summary)

BKS_2018_wtd_total <- calc.grazing.totals.wtd(BKS_2018_wtd_summary)

print(BRL_2018_wtd_total)
print(BKS_2018_wtd_total)
```

```{r}
wtd_2018 <- dplyr::bind_rows(BRL_2018_wtd_total, BKS_2018_wtd_total)

print(wtd_2018)
```

```{r}
wtd_2018_cow_percent <- pull.species.percentage(wtd_2018, species = "Cow")
wtd_2018_elk_percent <- pull.species.percentage(wtd_2018, species = "Elk")
wtd_2018_horse_percent <- pull.species.percentage(wtd_2018, species = "Horse")
```

```{r}
wtd_2018$Species <- wtd_2018$Species %>% fct_relevel(c("Elk", "Horse", "Cow"))

levels(wtd_2018$Species)
```

```{r}
wtd_2018 %>% dplyr::filter(Site == "Black Canyon South") %>% pull(season_total) %>% sum()
wtd_2018 %>% dplyr::filter(Site == "Bear Timelapse") %>% pull(season_total) %>% sum()
```

```{r}
1518/1762
```

```{r 2018 Wtd Total grazing Minutes}
p <- ggplot(wtd_2018, 
            aes(x = Site, 
                y = season_total, 
                fill = Species,
                label = scales::percent(proportion, 1))) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2018",
       x = "Site",
       y = "Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  scale_y_continuous(limits = c(0, 10000), breaks = seq(0, 10000, by = 2500))+
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  geom_fit_text(position = "stack", show.legend = FALSE) +
  annotate(geom = "label",
           x = 1,
           y = 2800,
           label = "<1%",
           fill = "#F8766D") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) 

p
```

```{r}
ggsave("2018-Total-Grazing-Minutes-by-Site-Weighted-by-AUE.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
A51_2019_unwtd_total <- calc.grazing.totals.unwtd(A51_2019_unwtd_summary)

print(A51_2019_unwtd_total)
```

```{r}
A51_2019_unwtd_total <- reorder.factors.by.season.total(A51_2019_unwtd_total)

levels(A51_2019_unwtd_total$Species)
```

```{r}
BKD_2019_unwtd_total <- calc.grazing.totals.unwtd(BKD_2019_unwtd_summary)

print(BKD_2019_unwtd_total)
```

```{r}
reorder.factors.by.season.total(BKD_2019_unwtd_total)
```

```{r}
A51_2019_unwtd_total <- calc.grazing.totals.unwtd(A51_2019_unwtd_summary)
BKD_2019_unwtd_total <- calc.grazing.totals.unwtd(BKD_2019_unwtd_summary)
BKN_2019_unwtd_total <- calc.grazing.totals.unwtd(BKN_2019_unwtd_summary)
BKS_2019_unwtd_total <- calc.grazing.totals.unwtd(BKS_2019_unwtd_summary)
BRL_2019_unwtd_total <- calc.grazing.totals.unwtd(BRL_2019_unwtd_summary)
```

```{r}
A51_2019_unwtd_total
BKD_2019_unwtd_total
BKN_2019_unwtd_total
BKS_2019_unwtd_total
BRL_2019_unwtd_total
```

```{r}
A51_2019_unwtd_total <- reorder.factors.by.season.total(A51_2019_unwtd_total)
BKD_2019_unwtd_total <- reorder.factors.by.season.total(BKD_2019_unwtd_total)
BKN_2019_unwtd_total <- reorder.factors.by.season.total(BKN_2019_unwtd_total)
BKS_2019_unwtd_total <- reorder.factors.by.season.total(BKS_2019_unwtd_total)
BRL_2019_unwtd_total <- reorder.factors.by.season.total(BRL_2019_unwtd_total)
```

```{r}
levels(A51_2019_unwtd_total$Species)
levels(BKD_2019_unwtd_total$Species)
levels(BKN_2019_unwtd_total$Species)
levels(BKS_2019_unwtd_total$Species)
levels(BRL_2019_unwtd_total$Species)
```

```{r}
unwtd_2019 <- bind_rows(A51_2019_unwtd_total,
                        BKD_2019_unwtd_total,
                        BKN_2019_unwtd_total,
                        BKS_2019_unwtd_total,
                        BRL_2019_unwtd_total)
unwtd_2019
```

```{r}
levels(unwtd_2019$Species)
```

```{r}
unwtd_2019$Species <- forcats::fct_relevel(unwtd_2019$Species, c("Elk", "Cow", "Horse"))

levels(unwtd_2019$Species)
```

```{r}
unwtd_2019
```

```{r}
A51_2019_unwtd_total
```

```{r}
A51_2019_unwtd_cow_percent <- A51_2019_unwtd_total %>% dplyr::filter(Species == "Cow") %>% dplyr::pull(proportion)
A51_2019_unwtd_elk_percent <- A51_2019_unwtd_total %>% dplyr::filter(Species == "Elk") %>% dplyr::pull(proportion)
A51_2019_unwtd_horse_percent <- A51_2019_unwtd_total %>% dplyr::filter(Species == "Horse") %>% dplyr::pull(proportion)
```

```{r}
BRL_2019_unwtd_cow_percent <- pull.species.percentage(BRL_2019_unwtd_total, species = "Cow")
BRL_2019_unwtd_elk_percent <- pull.species.percentage(BRL_2019_unwtd_total, species = "Elk")
BRL_2019_unwtd_horse_percent <- pull.species.percentage(BRL_2019_unwtd_total, species = "Horse")

BKD_2019_unwtd_cow_percent <- pull.species.percentage(BKD_2019_unwtd_total, species = "Cow")
BKD_2019_unwtd_elk_percent <- pull.species.percentage(BKD_2019_unwtd_total, species = "Elk")
BKD_2019_unwtd_horse_percent <- pull.species.percentage(BKD_2019_unwtd_total, species = "Horse")

BKN_2019_unwtd_cow_percent <- pull.species.percentage(BKN_2019_unwtd_total, species = "Cow")
BKN_2019_unwtd_elk_percent <- pull.species.percentage(BKN_2019_unwtd_total, species = "Elk")
BKN_2019_unwtd_horse_percent <- pull.species.percentage(BKN_2019_unwtd_total, species = "Horse")

BKS_2019_unwtd_cow_percent <- pull.species.percentage(BKS_2019_unwtd_total, species = "Cow")
BKS_2019_unwtd_elk_percent <- pull.species.percentage(BKS_2019_unwtd_total, species = "Elk")
BKS_2019_unwtd_horse_percent <- pull.species.percentage(BKS_2019_unwtd_total, species = "Horse")
```

```{r}
BKD_2019_elk_annotation <- BKD_2019_unwtd_total %>% pull(season_total) %>% sum() + 4000

BKD_2019_elk_annotation
```

```{r}
BKS_2019_elk_annotation <- BKS_2019_unwtd_total %>% pull(season_total) %>% sum() + 4000

BKS_2019_elk_annotation
```

```{r 2019 Unwtd grazing Minutes}
p <- ggplot(unwtd_2019, aes(x = Site, 
                            y = season_total, 
                            fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2019",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_y_continuous(limits = c(-3000, 125000), 
                     breaks = seq(0, 125000, by = 25000)) +
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  annotate(geom = "text", 
           x = 1, 
           y = 8000, 
           label = percent(BRL_2019_unwtd_horse_percent)) +
  annotate(geom = "text", 
           x = 1, 
           y = 65000, 
           label = percent(BRL_2019_unwtd_cow_percent)) +
  annotate(geom = "label", 
           x = 1, 
           y = 116000, 
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "label", 
           x = 2, 
           y = -3000, 
           label = percent(BKD_2019_unwtd_horse_percent), 
           fill = "#619CFF") +
  annotate(geom = "text", 
           x = 2, 
           y = 8000, 
           label = percent(BKD_2019_unwtd_cow_percent)) +
  annotate(geom = "label", 
           x = 2, 
           y = BKD_2019_elk_annotation, 
           label = percent(BKD_2019_unwtd_elk_percent), 
           fill = "#00BA38") +
  annotate(geom = "label", 
           x = 3, 
           y = -3000, 
           label = percent(BKN_2019_unwtd_horse_percent),
           fill = "#619CFF") +
  annotate(geom = "text", 
           x = 3, 
           y = 6000, 
           label = percent(BKN_2019_unwtd_cow_percent)) +
  annotate(geom = "label", 
           x = 3, 
           y = 15000, 
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "label", 
           x = 4, 
           y = -3000, 
           label = percent(BKS_2019_unwtd_horse_percent), 
           fill = "#619CFF") +
  annotate(geom = "text", 
           x = 4, 
           y = 25000, 
           label = percent(BKS_2019_unwtd_cow_percent), 
           fill = "#F8766D") +
  annotate(geom = "label", 
           x = 4, 
           y = BKS_2019_elk_annotation, 
           label = percent(BKS_2019_unwtd_elk_percent), 
           fill = "#00BA38") +
  annotate(geom = "text", 
           x = 5, 
           y = 6000, 
           label = percent(A51_2019_unwtd_horse_percent), 
           fill = "#619CFF") +
  annotate(geom = "text", 
           x = 5, 
           y = 19000, 
           label = percent(A51_2019_unwtd_cow_percent), 
           fill = "#F8766D") +
  annotate(geom = "label", 
           x = 5, 
           y = 29000, 
           label = "<1%",
           fill = "#00BA38") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0), size = 7),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("2019-Total-Grazing-Minutes-by-Site-Unweighted.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
A51_2019_wtd_total <- calc.grazing.totals.wtd(A51_2019_wtd_summary)
BKD_2019_wtd_total <- calc.grazing.totals.wtd(BKD_2019_wtd_summary)
BKN_2019_wtd_total <- calc.grazing.totals.wtd(BKN_2019_wtd_summary)
BKS_2019_wtd_total <- calc.grazing.totals.wtd(BKS_2019_wtd_summary)
BRL_2019_wtd_total <- calc.grazing.totals.wtd(BRL_2019_wtd_summary)
```

```{r}
A51_2019_wtd_total
BKD_2019_wtd_total
BKN_2019_wtd_total
BKS_2019_wtd_total
BRL_2019_wtd_total
```

```{r}
A51_2019_wtd_total <- reorder.factors.by.season.total(A51_2019_wtd_total)
BKD_2019_wtd_total <- reorder.factors.by.season.total(BKD_2019_wtd_total)
BKN_2019_wtd_total <- reorder.factors.by.season.total(BKN_2019_wtd_total)
BKS_2019_wtd_total <- reorder.factors.by.season.total(BKS_2019_wtd_total)
BRL_2019_wtd_total <- reorder.factors.by.season.total(BRL_2019_wtd_total)
```

```{r}
levels(A51_2019_wtd_total$Species)
levels(BKD_2019_wtd_total$Species)
levels(BKN_2019_wtd_total$Species)
levels(BKS_2019_wtd_total$Species)
levels(BRL_2019_wtd_total$Species)
```

```{r}
wtd_2019 <- bind_rows(A51_2019_wtd_total,
                        BKD_2019_wtd_total,
                        BKN_2019_wtd_total,
                        BKS_2019_wtd_total,
                        BRL_2019_wtd_total)
wtd_2019
```

```{r}
A51_2019_wtd_cow_percent <- pull.species.percentage(A51_2019_wtd_total, species = "Cow")
A51_2019_wtd_elk_percent <- pull.species.percentage(A51_2019_wtd_total, species = "Elk")
A51_2019_wtd_horse_percent <- pull.species.percentage(A51_2019_wtd_total, species = "Horse")
```

```{r}
BRL_2019_wtd_cow_percent <- pull.species.percentage(BRL_2019_wtd_total, species = "Cow")
BRL_2019_wtd_elk_percent <- pull.species.percentage(BRL_2019_wtd_total, species = "Elk")
BRL_2019_wtd_horse_percent <- pull.species.percentage(BRL_2019_wtd_total, species = "Horse")
```

```{r}
BKD_2019_wtd_cow_percent <- pull.species.percentage(BKD_2019_wtd_total, species = "Cow")
BKD_2019_wtd_elk_percent <- pull.species.percentage(BKD_2019_wtd_total, species = "Elk")
BKD_2019_wtd_horse_percent <- pull.species.percentage(BKD_2019_wtd_total, species = "Horse")
```

```{r}
BKN_2019_wtd_cow_percent <- pull.species.percentage(BKN_2019_wtd_total, species = "Cow")
BKN_2019_wtd_elk_percent <- pull.species.percentage(BKN_2019_wtd_total, species = "Elk")
BKN_2019_wtd_horse_percent <- pull.species.percentage(BKN_2019_wtd_total, species = "Horse")
```

```{r}
BKS_2019_wtd_cow_percent <- pull.species.percentage(BKS_2019_wtd_total, species = "Cow")
BKS_2019_wtd_elk_percent <- pull.species.percentage(BKS_2019_wtd_total, species = "Elk")
BKS_2019_wtd_horse_percent <- pull.species.percentage(BKS_2019_wtd_total, species = "Horse")
```

```{r}
BKD_2019_wtd_elk_annotation <- BKD_2019_wtd_total %>% pull(season_total) %>% sum() + 3000

BKD_2019_wtd_elk_annotation
```

```{r}
BKS_2019_wtd_elk_annotation <- BKS_2019_wtd_total %>% pull(season_total) %>% sum() + 4000

BKS_2019_wtd_elk_annotation
```

```{r}
wtd_2019$Species <- forcats::fct_relevel(wtd_2019$Species, c("Elk", "Cow", "Horse"))

levels(wtd_2019$Species)
```

```{r}
wtd_2019
```

```{r 2019 wtd grazing Minutes}
p <- ggplot(wtd_2019, aes(x = Site, 
                            y = season_total, 
                            fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2019",
       x = "Site",
       y = "Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  scale_y_continuous(limits = c(-3000, 125000), 
                     breaks = seq(0, 125000, by = 25000)) +
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  annotate(geom = "text", 
           x = 1, 
           y = 8000, 
           label = percent(BRL_2019_wtd_horse_percent)) +
  annotate(geom = "text", 
           x = 1, 
           y = 65000, 
           label = percent(BRL_2019_wtd_cow_percent)) +
  annotate(geom = "label", 
           x = 1, 
           y = 120000, 
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "label", 
           x = 2, 
           y = -3000, 
           label = percent(BKD_2019_wtd_horse_percent), 
           fill = "#619CFF") +
  annotate(geom = "text", 
           x = 2, 
           y = 8000, 
           label = percent(BKD_2019_wtd_cow_percent)) +
  annotate(geom = "label", 
           x = 2, 
           y = 21000, 
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "label", 
           x = 3, 
           y = -3000, 
           label = percent(BKN_2019_wtd_horse_percent),
           fill = "#619CFF") +
  annotate(geom = "text", 
           x = 3, 
           y = 6000, 
           label = percent(BKN_2019_wtd_cow_percent)) +
  annotate(geom = "label", 
           x = 3, 
           y = 15000, 
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "label", 
           x = 4, 
           y = -3000, 
           label = percent(BKS_2019_wtd_horse_percent), 
           fill = "#619CFF") +
  annotate(geom = "text", 
           x = 4, 
           y = 25000, 
           label = percent(BKS_2019_wtd_cow_percent)) +
  annotate(geom = "label", 
           x = 4, 
           y = BKS_2019_wtd_elk_annotation, 
           label = percent(BKS_2019_wtd_elk_percent), 
           fill = "#00BA38") +
  annotate(geom = "text", 
           x = 5, 
           y = 6000, 
           label = percent(A51_2019_wtd_horse_percent)) +
  annotate(geom = "text", 
           x = 5, 
           y = 19000, 
           label = percent(A51_2019_wtd_cow_percent)) +
  annotate(geom = "label", 
           x = 5, 
           y = 30000, 
           label = "<1%",
           fill = "#00BA38") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0), size = 7),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("2019-Total-Grazing-Minutes-by-Site-Weighted-by-AUE.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
A51_2020_unwtd_total <- calc.grazing.totals.unwtd(A51_2020_unwtd_summary)
BKN_2020_unwtd_total <- calc.grazing.totals.unwtd(BKN_2020_unwtd_summary)
BKS_2020_unwtd_total <- calc.grazing.totals.unwtd(BKS_2020_unwtd_summary)
BRL_2020_unwtd_total <- calc.grazing.totals.unwtd(BRL_2020_unwtd_summary)
```

```{r}
A51_2020_unwtd_total
BKN_2020_unwtd_total
BKS_2020_unwtd_total
BRL_2020_unwtd_total
```

```{r}
A51_2020_unwtd_cow_percent <- pull.species.percentage(A51_2020_unwtd_total, species = "Cow")
A51_2020_unwtd_elk_percent <- pull.species.percentage(A51_2020_unwtd_total, species = "Elk")
A51_2020_unwtd_horse_percent <- pull.species.percentage(A51_2020_unwtd_total, species = "Horse")

BRL_2020_unwtd_cow_percent <- pull.species.percentage(BRL_2020_unwtd_total, species = "Cow")
BRL_2020_unwtd_elk_percent <- pull.species.percentage(BRL_2020_unwtd_total, species = "Elk")
BRL_2020_unwtd_horse_percent <- pull.species.percentage(BRL_2020_unwtd_total, species = "Horse")

BKN_2020_unwtd_cow_percent <- pull.species.percentage(BKN_2020_unwtd_total, species = "Cow")
BKN_2020_unwtd_elk_percent <- pull.species.percentage(BKN_2020_unwtd_total, species = "Elk")
BKN_2020_unwtd_horse_percent <- pull.species.percentage(BKN_2020_unwtd_total, species = "Horse")

BKS_2020_unwtd_cow_percent <- pull.species.percentage(BKS_2020_unwtd_total, species = "Cow")
BKS_2020_unwtd_elk_percent <- pull.species.percentage(BKS_2020_unwtd_total, species = "Elk")
BKS_2020_unwtd_horse_percent <- pull.species.percentage(BKS_2020_unwtd_total, species = "Horse")
```

```{r}
unwtd_2020 <- bind_rows(A51_2020_unwtd_total, BKN_2020_unwtd_total, BKS_2020_unwtd_total, BRL_2020_unwtd_total)

unwtd_2020
```

```{r}
levels(unwtd_2020$Species)
```

```{r}
unwtd_2020$Species <- unwtd_2020 %>% dplyr::pull(Species) %>% forcats::as_factor()

levels(unwtd_2020$Species)
```

```{r}
unwtd_2020$Species <- unwtd_2020 %>% dplyr::pull(Species) %>% fct_relevel(c("Elk", "Cow", "Horse"))

levels(unwtd_2020$Species)
```

```{r}
print(unwtd_2020)
```

```{r}
BKN_2020_unwtd_elk_annotation <- BKN_2020_unwtd_total %>% pull(season_total) %>% sum() + 1000

BKN_2020_unwtd_elk_annotation
```

```{r}
BKS_2020_unwtd_cow_annotation <- BKS_2020_unwtd_total %>% pull(season_total) %>% sum() + 1000

BKS_2020_unwtd_cow_annotation
```

```{r}
BKS_2020_unwtd_elk_annotation <- BKS_2020_unwtd_cow_annotation + 1750

BKS_2020_unwtd_elk_annotation
```

```{r}
y1 <- A51_2020_unwtd_total %>% 
  filter(Species == "Horse") %>% 
  pull(season_total)

y2 <- A51_2020_unwtd_total %>% 
  filter(Species == "Cow") %>% 
  pull(season_total) + y1

ymid <- (y1 + y2) / 2  

print(ymid)

A51_2020_unwtd_cow_annotation <- ymid
```

```{r}
A51_2020_unwtd_elk_annotation <- A51_2020_unwtd_total %>% pull(season_total) %>% sum() + 1000

A51_2020_unwtd_elk_annotation
```

```{r 2020 Unwtd grazing Minutes}
p <- ggplot(unwtd_2020, aes(x = Site, 
                            y = season_total, 
                            fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2020",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_y_continuous(limits = c(-500, 30000), 
                     breaks = seq(0, 30000, by = 5000)) +
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  annotate(geom = "text",
           x = 1,
           y = BRL_2020_unwtd_total %>% filter(Species == "Horse") %>% pull(season_total) / 2,
           label = percent(BRL_2020_unwtd_horse_percent)) +
  annotate(geom = "label",
           x = 1,
           y = -500,
           label = percent(BRL_2020_unwtd_cow_percent),
           fill = "#F8766D") +
  annotate(geom = "label",
           x = 1,
           y = BRL_2020_unwtd_total %>% pull(season_total) %>% sum() + 1000,
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "text",
           x = 2,
           y = BKN_2020_unwtd_total %>% filter(Species == "Cow") %>% pull(season_total) / 2,
           label = percent(BKN_2020_unwtd_cow_percent)) +
  annotate(geom = "label",
           x = 2,
           y = BKN_2020_unwtd_elk_annotation,
           label = percent(BKN_2020_unwtd_elk_percent),
           fill = "#00BA38") +
  annotate(geom = "label",
           x = 2,
           y = -500,
           label = percent(BKN_2020_unwtd_horse_percent),
           fill = "#619CFF") +
  annotate(geom = "text",
           x = 3,
           y = BKS_2020_unwtd_total %>% filter(Species == "Horse") %>% pull(season_total) / 2,
           label = percent(BKS_2020_unwtd_horse_percent),
           fill = "#619CFF") +
  annotate(geom = "label",
           x = 3,
           y = BKS_2020_unwtd_cow_annotation,
           label = percent(BKS_2020_unwtd_cow_percent),
           fill = "#F8766D") +
  annotate(geom = "label",
           x = 3,
           y = BKS_2020_unwtd_elk_annotation,
           label = percent(BKS_2020_unwtd_elk_percent),
           fill = "#00BA38") +
  annotate(geom = "text",
           x = 4,
           y = A51_2020_unwtd_total %>% filter(Species == "Horse") %>% pull(season_total) / 2,
           label = percent(A51_2020_unwtd_horse_percent)) +
  annotate(geom = "text",
           x = 4,
           y = A51_2020_unwtd_cow_annotation,
           label = percent(A51_2020_unwtd_cow_percent)) +
    annotate(geom = "label",
           x = 4,
           y = A51_2020_unwtd_elk_annotation,
           label = "<1%",
           fill = "#00BA38") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0), size = 7),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("2020-Total-Grazing-Minutes-by-Site-Unweighted.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
scales::show_col(hue_pal()(3))
```

```{r}
A51_2020_wtd_total <- calc.grazing.totals.wtd(A51_2020_wtd_summary)
BKN_2020_wtd_total <- calc.grazing.totals.wtd(BKN_2020_wtd_summary)
BKS_2020_wtd_total <- calc.grazing.totals.wtd(BKS_2020_wtd_summary)
BRL_2020_wtd_total <- calc.grazing.totals.wtd(BRL_2020_wtd_summary)
```

```{r}
A51_2020_wtd_total
BKN_2020_wtd_total
BKS_2020_wtd_total
BRL_2020_wtd_total
```

```{r}
A51_2020_wtd_cow_percent <- pull.species.percentage(A51_2020_wtd_total, species = "Cow")
A51_2020_wtd_elk_percent <- pull.species.percentage(A51_2020_wtd_total, species = "Elk")
A51_2020_wtd_horse_percent <- pull.species.percentage(A51_2020_wtd_total, species = "Horse")

BRL_2020_wtd_cow_percent <- pull.species.percentage(BRL_2020_wtd_total, species = "Cow")
BRL_2020_wtd_elk_percent <- pull.species.percentage(BRL_2020_wtd_total, species = "Elk")
BRL_2020_wtd_horse_percent <- pull.species.percentage(BRL_2020_wtd_total, species = "Horse")

BKN_2020_wtd_cow_percent <- pull.species.percentage(BKN_2020_wtd_total, species = "Cow")
BKN_2020_wtd_elk_percent <- pull.species.percentage(BKN_2020_wtd_total, species = "Elk")
BKN_2020_wtd_horse_percent <- pull.species.percentage(BKN_2020_wtd_total, species = "Horse")

BKS_2020_wtd_cow_percent <- pull.species.percentage(BKS_2020_wtd_total, species = "Cow")
BKS_2020_wtd_elk_percent <- pull.species.percentage(BKS_2020_wtd_total, species = "Elk")
BKS_2020_wtd_horse_percent <- pull.species.percentage(BKS_2020_wtd_total, species = "Horse")
```

```{r}
wtd_2020 <- bind_rows(A51_2020_wtd_total, BKN_2020_wtd_total, BKS_2020_wtd_total, BRL_2020_wtd_total)

wtd_2020
```

```{r}
wtd_2020$Species <- wtd_2020 %>% dplyr::pull(Species) %>% forcats::as_factor()

levels(wtd_2020$Species)
```

```{r}
wtd_2020$Species <- wtd_2020 %>% dplyr::pull(Species) %>% forcats::fct_relevel(c("Elk", "Cow", "Horse"))

levels(wtd_2020$Species)
```

```{r}
BKN_2020_wtd_elk_annotation <- BKN_2020_wtd_total %>% pull(season_total) %>% sum() + 1000

BKN_2020_wtd_elk_annotation
```

```{r}
BKS_2020_wtd_cow_annotation <- BKS_2020_wtd_total %>% pull(season_total) %>% sum() + 1000

BKS_2020_wtd_cow_annotation
```

```{r}
BKS_2020_wtd_elk_annotation <- BKS_2020_wtd_cow_annotation + 1750

BKS_2020_wtd_elk_annotation
```

```{r}
y1 <- A51_2020_wtd_total %>% 
  filter(Species == "Horse") %>% 
  pull(season_total)

y2 <- A51_2020_wtd_total %>% 
  filter(Species == "Cow") %>% 
  pull(season_total) + y1

ymid <- (y1 + y2) / 2  

print(ymid)

A51_2020_wtd_cow_annotation <- ymid
```

```{r}
A51_2020_wtd_elk_annotation <- A51_2020_wtd_total %>% pull(season_total) %>% sum() + 500

A51_2020_wtd_elk_annotation
```

```{r 2020 Wtd grazing Minutes}
p <- ggplot(wtd_2020, aes(x = Site, 
                            y = season_total, 
                            fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2020",
       x = "Site",
       y = "Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  scale_y_continuous(limits = c(-500, 30000), 
                     breaks = seq(0, 30000, by = 5000)) +
  scale_fill_manual(values = c(Cow = "#F8766D",
                                Elk = "#00BA38",
                                Horse = "#619CFF")) +
  annotate(geom = "text",
           x = 1,
           y = BRL_2020_wtd_total %>% filter(Species == "Horse") %>% pull(season_total) / 2,
           label = percent(BRL_2020_wtd_horse_percent)) +
  annotate(geom = "label",
           x = 1,
           y = -500,
           label = percent(BRL_2020_wtd_cow_percent),
           fill = "#F8766D") +
  annotate(geom = "label",
           x = 1,
           y = BRL_2020_wtd_total %>% pull(season_total) %>% sum() + 1000,
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "label",
           x = 2,
           y = -500,
           label = percent(BKN_2020_wtd_horse_percent),
           fill = "#619CFF") +
  annotate(geom = "text",
           x = 2,
           y = BKN_2020_wtd_total %>% filter(Species == "Cow") %>% pull(season_total) / 2,
           label = percent(BKN_2020_wtd_cow_percent)) +
  annotate(geom = "label",
           x = 2,
           y = BKN_2020_wtd_elk_annotation,
           label = "<1%",
           fill = "#00BA38") +
  annotate(geom = "text",
           x = 3,
           y = BKS_2020_wtd_total %>% filter(Species == "Horse") %>% pull(season_total) / 2,
           label = percent(BKS_2020_wtd_horse_percent),
           fill = "#619CFF") +
  annotate(geom = "label",
           x = 3,
           y = BKS_2020_wtd_cow_annotation,
           label = percent(BKS_2020_wtd_cow_percent),
           fill = "#F8766D") +
  annotate(geom = "label",
           x = 3,
           y = BKS_2020_wtd_elk_annotation,
           label = percent(BKS_2020_wtd_elk_percent),
           fill = "#00BA38") +
  annotate(geom = "text",
           x = 4,
           y = A51_2020_wtd_total %>% filter(Species == "Horse") %>% pull(season_total) / 2,
           label = percent(A51_2020_wtd_horse_percent)) +
  annotate(geom = "text",
           x = 4,
           y = A51_2020_wtd_cow_annotation,
           label = percent(A51_2020_wtd_cow_percent)) +
    annotate(geom = "label",
           x = 4,
           y = A51_2020_wtd_elk_annotation,
           label = "<1%",
           fill = "#00BA38") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0), size = 7),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)))

p
```

```{r}
ggsave("2020-Total-Grazing-Minutes-by-Site-Weighted-By-AUE.jpg",
     path = paste0(currentwd,"/figures", "/grazing-minutes"))
```

```{r}
unwtd_2019 %>% filter(Site == "Black Canyon North") %>% pull(season_total) %>% sum()
```

```{r}
unwtd_2020 %>% filter(Site == "Black Canyon North") %>% pull(season_total) %>% sum()
```

