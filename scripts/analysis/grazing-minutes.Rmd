---
title: "Grazing Minutes"
author: "Andrew Antaya"
date: "June 20, 2019"
output:
  html_document: 
    theme: readable
    toc: yes
    toc_depth: 5
    fig_caption: yes
  word_document:
    toc: yes
---

## Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      dpi = 300)
knitr::opts_knit$set(root.dir = "~/grazing-interaction")

source("~/grazing-interaction/environment.R")
source("~/grazing-interaction/packages.R")
source("~/grazing-interaction/functions.R")

flextable::set_flextable_defaults(
  font.size = 10, 
  theme_fun = theme_box,
  text.align = "center",
  fonts_ignore = TRUE,
  background.color = "#EFEFEF")

# set the plot theme to our custom theme
ggplot2::theme_set(theme_grazer())
```

------------------------------------------------------------------------

Now, we can load in the cleaned photo data generated by "photo-processing.Rmd" script. This data has already been corrected for erroneous data, re-named columns for consistency across years, and some columns have been converted to specific data types (e.g., DateTime as a S3:POSIXct).

```{r read csv files in directory}
path_to_csv_files <- fs::dir_ls(file.path(currentwd, 
                                  "data", 
                                  "photo", 
                                  "combined-by-site-year",
                                  "processed"), 
                                regexp = "\\d{4}_(..[^T])\\.csv$")

path_to_csv_files
```

```{r set column specification}
source(file.path(currentwd,
                 "scripts", 
                 "utilities", 
                 "cameradf-column-specification.R")
       )
```

```{r load all csv files}

cameradf_list <- path_to_csv_files %>% 
  purrr::map(readr::read_csv,
             na = c("", " ", "NA"),
             col_types = col_spec)

```

```{r rename elements in cameradf_list}

cameradf_list <- rename_elements_in_list_of_csv_files(cameradf_list)

```

```{r set timezone}
cameradf_list <- purrr::map(cameradf_list, set_timezone)
```

------------------------------------------------------------------------

We're going to use a function I created called "speciestotal" (see the functions.R script) which is specific to the way we classified our data. The issue is that the 'Count1Species' column in our data frames doesn't correspond to a specific species, rather it corresponds to whatever species is the primary species detected (>50% of individuals if a multiple species are detected in an image).

The "speciestotal" function will count up the number of individuals for each species detected in a camera trap photo and then create a new column in the corresponding dataframe to store this species count. The new column is labeled by the species and contains a count of the number of individuals detected in each image.

A second function "allspecies" uses the "speciestotal" function for all of the species possible (24 total), and creates a new column for each species.

# TODO rename the `allspecies` funciton

# TODO refactor functions so they do not include periods "."

```{r species counts}

cameradf_list <- 
  purrr::map(cameradf_list, allspecies)

```

------------------------------------------------------------------------

This new data frame has 24 additional columns that contain counts of the 'subjects' (e.g., horses, cows, ATVs, humans) in each photo. These columns were created primarily to simplify the data frame, where a single row has the counts for each species stored in a separate column.

------------------------------------------------------------------------

Let's calculate grazing minutes using the Bear Timelapse 2018 data. From our metadata, we know that the Bear Timelapse site in 2018 used a 1 minute collection interval for timelapse photos.

```{r calc grazing time unwtd}

cameradf_list <- purrr::map(cameradf_list, calc.grazing.time.unwtd)

```

```{r calc grazing time wtd}

cameradf_list <- purrr::map(cameradf_list, calc.grazing.time.wtd)

```

```{r calc daily summary}

list_of_summarized_cameradf <- 
  purrr::map(cameradf_list, summarize_daily_totals)

```

## Daily Totals

# TODO the monitoring start and end dates should be programatically generated
# TODO save the annotations as a data frame and then use geom_text to add the labels to the plot

```{r Bear 2017 Unweighted Figure}

ggplot(list_of_summarized_cameradf$`2017_BRL.csv`,
            aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
    annotate(geom = "text", 
           x = date(("2017-07-10")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-07-13")), 
           xend = date(("2017-07-13")), 
           y = 0, 
           yend = 250,
           color = "black")
ggsave("Bear-Timelapse-2017-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Bear 2017 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2017_BRL.csv`, 
            aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  annotate(geom = "text", 
           x = date(("2017-07-10")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-07-13")), 
           xend = date(("2017-07-13")), 
           y = 0, 
           yend = 250,
           color = "black")
ggsave("Bear-Timelapse-2017-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Bear 2018 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2018_BRL.csv`,
            aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .)
ggsave("Bear-Timelapse-2018-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Bear 2018 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2018_BRL.csv`, 
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month", 
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Bear Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .)
ggsave("Bear-Timelapse-2018-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Bear 2019 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BRL.csv`, 
            aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(-100, 10000), breaks = seq(0, 10000, by = 2500)) +
  labs(title = "Bear Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (10000/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 10000,
           color = "black")
ggsave("Bear-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Bear 2019 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BRL.csv`, 
            aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(-100, 10000), breaks = seq(0, 10000, by = 2500)) +
  labs(title = "Bear Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (10000/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 10000,
           color = "black")
ggsave("Bear-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Bear 2020 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2020_BRL.csv`, 
            aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Bear Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2020-07-08")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-11")), 
           xend = date(("2020-07-11")), 
           y = 0, 
           yend = 1000,
           color = "black")
ggsave("Bear-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Bear 2020 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2020_BRL.csv`, 
            aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Bear Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +
  
  annotate(geom = "text", 
           x = date(("2020-07-08")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-11")), 
           xend = date(("2020-07-11")), 
           y = 0, 
           yend = 1000,
           color = "black")
ggsave("Bear-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Area 51 2019 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2019_A51.csv`, 
            aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text",
           x = date(("2019-06-08")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
ggsave("FiftyOne-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Area 51 2019 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2019_A51.csv`, aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text",
           x = date(("2019-06-08")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
ggsave("FiftyOne-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Area 51 2020 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2020_A51.csv`,
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text",
           x = date(("2020-07-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-12")),
           xend = date(("2020-07-12")),
           y = 0,
           yend = 2000,
           color = "black")
ggsave("FiftyOne-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Area 51 2020 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2020_A51.csv`, aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Fifty One Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text",
           x = date(("2020-07-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-12")),
           xend = date(("2020-07-12")),
           y = 0,
           yend = 2000,
           color = "black")
ggsave("FiftyOne-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon Dam 2019 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BKD.csv`, 
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Black Canyon Dam Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text",
           x = date(("2019-06-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
ggsave("Black-Canyon-Dam-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon Dam 2019 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BKD.csv`, 
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2000), breaks = seq(0, 2000, by = 500)) +
  labs(title = "Black Canyon Dam Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text",
           x = date(("2019-06-09")),
           y = 1000,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-11")),
           xend = date(("2019-06-11")),
           y = 0,
           yend = 2000,
           color = "black")
ggsave("Black-Canyon-Dam-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon South 2017 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2017_BKS.csv`, 
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2017-06-09")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-06-12")), 
           xend = date(("2017-06-12")), 
           y = 0, 
           yend = 250,
           color = "black")
ggsave("Black-Canyon-South-Timelapse-2017-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon South 2017 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2017_BKS.csv`,
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b", 
               date_breaks = "1 month",
               limits = c(date("2017-06-01"), date("2017-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2017") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2017-06-09")), 
           y = (250/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2017-06-12")), 
           xend = date(("2017-06-12")), 
           y = 0, 
           yend = 250,
           color = "black")
ggsave("Black-Canyon-South-Timelapse-2017-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon South 2018 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2018_BKS.csv`,
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .)
ggsave("Black-Canyon-South-Timelapse-2018-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```
# TODO rename ImageDate to Date

```{r Black Canyon South 2018 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2018_BKS.csv`,
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2018-06-01"), date("2018-09-30"))) +
  scale_y_continuous(limits = c(0, 250), breaks = seq(0, 250, by = 50)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2018") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .)
  
ggsave("Black-Canyon-South-Timelapse-2018-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon South 2019 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BKS.csv`, 
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +
  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
ggsave("Black-Canyon-South-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon South 2019 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BKS.csv`, 
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
ggsave("Black-Canyon-South-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon South 2020 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2020_BKS.csv`, 
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
ggsave("Black-Canyon-South-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon South 2020 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2020_BKS.csv`, 
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon South Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
ggsave("Black-Canyon-South-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon North 2019 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BKN.csv`, 
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
ggsave("Black-Canyon-North-Timelapse-2019-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon North 2019 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2019_BKN.csv`, 
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2019-06-01"), date("2019-09-30"))) +
  scale_y_continuous(limits = c(0, 2500), breaks = seq(0, 2500, by = 500)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2019") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2019-06-02")), 
           y = (2500/2),
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2019-06-05")), 
           xend = date(("2019-06-05")), 
           y = 0, 
           yend = 2500,
           color = "black")
ggsave("Black-Canyon-North-Timelapse-2019-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon North 2020 Unweighted Figure}
ggplot(list_of_summarized_cameradf$`2020_BKN.csv`, 
       aes(x = ImageDate, y = daily_total_unwtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Unweighted)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
ggsave("Black-Canyon-North-Timelapse-2020-Unweighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

```{r Black Canyon North 2020 Weighted Figure}
ggplot(list_of_summarized_cameradf$`2020_BKN.csv`, 
       aes(x = ImageDate, y = daily_total_wtd, fill = Species)) +
  geom_col(position = "dodge") +
  scale_x_date(date_labels = "%b",
               date_breaks = "1 month",
               limits = c(date("2020-06-01"), date("2020-09-30"))) +
  scale_y_continuous(limits = c(0, 1000), breaks = seq(0, 1000, by = 250)) +
  labs(title = "Black Canyon North Timelapse", subtitle = "2020") +
  ylab("Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  facet_grid(Species ~ .) +

  annotate(geom = "text", 
           x = date(("2020-07-07")), 
           y = 500,
           label = "Monitoring Start Date",
           angle = 90,
           size = 9) +
  annotate(geom = "segment",
           linetype = 2,
           x = date(("2020-07-10")), 
           xend = date(("2020-07-10")), 
           y = 0, 
           yend = 1000,
           color = "black")
ggsave("Black-Canyon-North-Timelapse-2020-Weighted-Grazing-Minutes-June-01-Sept-30.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "daily-site-use"))
```

## Yearly Site Totals

```{r example calc season total BKS 2020}
list_of_summarized_cameradf$`2020_BKS.csv` %>% 
  dplyr::group_by(Species) %>% 
  dplyr::summarise(across(c(daily_total_unwtd, daily_total_wtd), sum)) %>% 
  dplyr::rename_with(~stringr::str_replace(pattern = "daily", 
                                       replacement = "season", .), 
                     .cols = starts_with("daily")) %>% 
  dplyr::mutate(proportion_unwtd = 
                  season_total_unwtd/sum(season_total_unwtd)) %>% 
  dplyr::mutate(proportion_wtd = 
                  season_total_wtd/sum(season_total_wtd)) %>% 
  dplyr::mutate(Site = list_of_summarized_cameradf$`2020_BKS.csv`$Site[1], 
                .before = Species)

```

```{r calc season total and proportions}

list_of_season_totals <- 
  purrr::map(list_of_summarized_cameradf, calc_season_total)

```




```{r example as factor levels BKS 2017}
list_of_season_totals$`2017_BKS.csv` %>% 
  pull(Species) %>% 
  forcats::as_factor() %>% 
  levels()
```

```{r example relevel}
list_of_season_totals$`2017_BKS.csv` %>% 
  dplyr::pull(Species) %>% 
  forcats::fct_relevel(c("Elk", "Cow", "Horse")) %>% 
  levels()
```

```{r separate heber and white mountains data}
# separate/remove heber and white mountains data
list_of_season_totals_heber <- list_of_season_totals[stringr::str_detect(
  names(list_of_season_totals), "\\d{4}_(BG.|WC.)\\.csv") == FALSE]

# subset a list by names of its elements i.e. year
list_of_season_totals_whitemountains <- list_of_season_totals[stringr::str_detect(
  names(list_of_season_totals), "\\d{4}_(BG.|WC.)\\.csv") == TRUE]

```

```{r group season total by year}

list_of_grouped_season_totals <- group_season_total_by_year(list_of_season_totals_heber)

```

```{r manually relevel species as factors}

list_of_grouped_season_totals <- 
purrr::map(list_of_grouped_season_totals, manually_relevel_species_as_factors)

```

```{r set plot colors for species}

elk_color <- "#00BA38"

cow_color <- "#F8766D"

horse_color <- "#619CFF"
```

```{r 2017 Unwtd Total Grazing Minutes}
ggplot(list_of_grouped_season_totals$`2017`,
       aes(x = Site, y = season_total_unwtd, fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2017",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +

annotate(geom = "label",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2017`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
         size = 9,
         label = percent(list_of_grouped_season_totals$`2017`$proportion_unwtd[1],
                           prefix = "<"),
         fill = elk_color) +
  annotate(geom = "text",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2017`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_unwtd[2])) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2017`, 
                              site = "Bear Timelapse",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_unwtd[3])) +
  annotate(geom = "text",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2017`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_unwtd[4])) +
  annotate(geom = "text",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2017`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_unwtd[5])) +
  annotate(geom = "text", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2017`,
                              site = "Black Canyon South",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_unwtd[6]))
ggsave("2017-Total-Grazing-Minutes-by-Site-Unweighted.jpg",
       height = 4,
       width = 6.5,
       units = "in",
     path = file.path(currentwd, "figures", "grazing-minutes", "total-site-use"))
```

```{r 2017 Wtd Total grazing Minutes}
ggplot(list_of_grouped_season_totals$`2017`, 
       aes(x = Site, y = season_total_wtd, fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2017",
       x = "Site",
       y = "Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +

    # elk
annotate(geom = "label",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2017`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
         size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_wtd[1],
                           prefix = "<"),
         fill = elk_color) +
  annotate(geom = "text",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2017`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_wtd[2])) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2017`, 
                              site = "Bear Timelapse",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_wtd[3])) +
  annotate(geom = "text",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2017`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_wtd[4])) +
  annotate(geom = "text",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2017`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_wtd[5])) +
  annotate(geom = "text", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2017`,
                              site = "Black Canyon South",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2017`$proportion_wtd[6]))
ggsave("2017-Total-Grazing-Minutes-by-Site-Weighted-by-AUE.jpg",
       height = 4,
       width = 6.5,
       units = "in",
       path = file.path(currentwd, "figures", "grazing-minutes", "total-site-use"))
```

```{r 2018 Unwtd Total grazing Minutes}
ggplot(list_of_grouped_season_totals$`2018`, 
            aes(x = Site, 
                y = season_total_unwtd, 
                fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2018",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  # scale_y_continuous(limits = c(0, 7500), breaks = seq(0, 7500, by = 2500)) +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +

    # elk
annotate(geom = "text",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2018`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
         size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_unwtd[1])) +
  annotate(geom = "label",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2018`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_unwtd[2]),
           fill = cow_color) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2018`, 
                              site = "Bear Timelapse",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_unwtd[3])) +
  annotate(geom = "text",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2018`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_unwtd[4])) +
  annotate(geom = "label",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2018`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_unwtd[5]),
           fill = cow_color) +
  annotate(geom = "text", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2018`,
                              site = "Black Canyon South",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_unwtd[6]))
ggsave("2018-Total-Grazing-Minutes-Unweighted.jpg",
       height = 4,
       width = 6.5,
       units = "in",
     path = file.path(currentwd, "figures", "grazing-minutes", "total-site-use"))
```


```{r 2018 Wtd Total grazing Minutes}
ggplot(list_of_grouped_season_totals$`2018`, 
            aes(x = Site, 
                y = season_total_wtd, 
                fill = Species)) +
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2018",
       x = "Site",
       y = "Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +

annotate(geom = "text",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2018`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
         size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_wtd[1])) +
  annotate(geom = "label",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2018`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_wtd[2]),
           fill = cow_color) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2018`, 
                              site = "Bear Timelapse",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_wtd[3])) +
  annotate(geom = "text",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2018`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_wtd[4])) +
  annotate(geom = "label",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2018`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_wtd[5]),
           fill = cow_color) +
  annotate(geom = "text", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2018`,
                              site = "Black Canyon South",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2018`$proportion_wtd[6]))
ggsave("2018-Total-Grazing-Minutes-by-Site-Weighted-by-AUE.jpg",
       height = 4,
       width = 6.5,
       units = "in",
     path = file.path(currentwd, "figures", "grazing-minutes", "total-site-use"))

```

# TODO fix the label overalp for fifty one 2019

```{r 2019 Unwtd grazing Minutes}
ggplot(list_of_grouped_season_totals$`2019`, 
       aes(x = Site, 
           y = season_total_unwtd, 
           fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2019",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_y_continuous(limits = c(-3000, 125000), 
                     breaks = seq(0, 125000, by = 25000)) +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +
  theme(axis.text = element_text(size = 18)) +
annotate(geom = "label",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
         size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[1]),
         fill = elk_color) +
  annotate(geom = "text",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[2])) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2019`, 
                              site = "Bear Timelapse",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[3])) +
  annotate(geom = "label",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[4]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[5]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Black Canyon South",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[6]),
           fill = horse_color) +
    annotate(geom = "label",
           x = 3,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon North",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[7]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 3,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon North",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[8]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 3, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Black Canyon North",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[9]),
           fill = horse_color) +
      annotate(geom = "label",
           x = 4,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[10]),
           fill = elk_color) +
  annotate(geom = "text",
           x = 4,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[11])) +
  annotate(geom = "label", 
           x = 4, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Black Canyon South",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[12]),
           fill = horse_color) +
        annotate(geom = "label",
           x = 5,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Fifty One",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[13]),
           fill = elk_color) +
  annotate(geom = "text",
           x = 5,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Fifty One",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[14])) +
  annotate(geom = "text", 
           x = 5, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Fifty One",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_unwtd[15]))
ggsave("2019-Total-Grazing-Minutes-by-Site-Unweighted.jpg",
       height = 4,
       width = 6.5,
       units = "in",
     path = file.path(currentwd,"figures", "grazing-minutes", "total-site-use"))

```

# TODO write a geom = text or geom = label helper function?

# TODO need to cleanup position funcitons and add comments also might refactor the vairables names

```{r 2019 Wtd Grazing Minutes}
ggplot(list_of_grouped_season_totals$`2019`, 
       aes(x = Site, 
           y = season_total_wtd, 
           fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2019",
       x = "Site",
       y = "Grazing Minutes (Weighted by Animal Unit Equivalents)") +
  scale_y_continuous(limits = c(-3000, 125000), 
                     breaks = seq(0, 125000, by = 25000)) +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +
  theme(axis.text = element_text(size = 18)) +
  annotate(geom = "label",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[1]),
         fill = elk_color) +
  annotate(geom = "text",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[2])) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2019`, 
                              site = "Bear Timelapse",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[3])) +
  annotate(geom = "label",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon Dam",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[4]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon Dam",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[5]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Black Canyon Dam",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[6]),
           fill = horse_color) +
    annotate(geom = "label",
           x = 3,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon North",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[7]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 3,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon North",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[8]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 3, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Black Canyon North",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[9]),
           fill = horse_color) +
      annotate(geom = "label",
           x = 4,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[10]),
           fill = elk_color) +
  annotate(geom = "text",
           x = 4,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[11])) +
  annotate(geom = "label", 
           x = 4, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Black Canyon South",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[12]),
           fill = horse_color) +
        annotate(geom = "label",
           x = 5,
           y = elk_position(list_of_grouped_season_totals$`2019`, 
                            site = "Fifty One",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[13]),
           fill = elk_color) +
  annotate(geom = "text",
           x = 5,
           y = cow_position(list_of_grouped_season_totals$`2019`, 
                            site = "Fifty One",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[14])) +
  annotate(geom = "text", 
           x = 5, 
           y = horse_position(list_of_grouped_season_totals$`2019`,
                              site = "Fifty One",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2019`$proportion_wtd[15]))
ggsave("2019-Total-Grazing-Minutes-by-Site-Weighted-by-AUE.jpg",
       height = 4,
       width = 6.5,
       units = "in",
     path = file.path(currentwd, "figures", "grazing-minutes", "total-site-use"))
```

```{r 2020 Unwtd grazing Minutes}
ggplot(list_of_grouped_season_totals$`2020`, aes(x = Site, 
                            y = season_total_unwtd, 
                            fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Unweighted)",
       subtitle = "2020",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_y_continuous(limits = c(-500, 30000), 
                     breaks = seq(0, 30000, by = 5000)) +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +

  annotate(geom = "label",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[1]),
         fill = elk_color) +
  annotate(geom = "text",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Bear Timelapse",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[2])) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2020`, 
                              site = "Bear Timelapse",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[3])) +
    annotate(geom = "label",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon North",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[4]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon North",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[5]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2020`,
                              site = "Black Canyon North",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[6]),
           fill = horse_color) +
      annotate(geom = "label",
           x = 3,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[7]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 3,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon South",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[8]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 3, 
           y = horse_position(list_of_grouped_season_totals$`2020`,
                              site = "Black Canyon South",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[9]),
           fill = horse_color) +
        annotate(geom = "label",
           x = 4,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Fifty One",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[10]),
           fill = elk_color) +
  annotate(geom = "text",
           x = 4,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Fifty One",
                            weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[11])) +
  annotate(geom = "text", 
           x = 4, 
           y = horse_position(list_of_grouped_season_totals$`2020`,
                              site = "Fifty One",
                              weighted = FALSE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[12]))
ggsave("2020-Total-Grazing-Minutes-by-Site-Unweighted.jpg",
       height = 4,
       width = 6.5,
       units = "in",
     path = file.path(currentwd, "figures", "grazing-minutes", "total-site-use"))
```

```{r 2020 Wtd grazing Minutes}
ggplot(list_of_grouped_season_totals$`2020`, aes(x = Site, 
                            y = season_total_wtd, 
                            fill = Species)) + 
  geom_col(position = "stack") +
  labs(title = "Total Grazing Minutes by Site (Weighted by AUE)",
       subtitle = "2020",
       x = "Site",
       y = "Grazing Minutes (Unweighted)") +
  scale_y_continuous(limits = c(-500, 30000), 
                     breaks = seq(0, 30000, by = 5000)) +
  scale_fill_manual(values = c(Cow = cow_color,
                                Elk = elk_color,
                                Horse = horse_color)) +

  annotate(geom = "label",
           x = 1,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[1]),
         fill = elk_color) +
  annotate(geom = "text",
           x = 1,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Bear Timelapse",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[2])) +
  annotate(geom = "text", 
           x = 1, 
           y = horse_position(list_of_grouped_season_totals$`2020`, 
                              site = "Bear Timelapse",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[3])) +
    annotate(geom = "label",
           x = 2,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon North",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[4]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 2,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon North",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[5]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 2, 
           y = horse_position(list_of_grouped_season_totals$`2020`,
                              site = "Black Canyon North",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[6]),
           fill = horse_color) +
      annotate(geom = "label",
           x = 3,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[7]),
           fill = elk_color) +
  annotate(geom = "label",
           x = 3,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Black Canyon South",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[8]),
           fill = cow_color) +
  annotate(geom = "label", 
           x = 3, 
           y = horse_position(list_of_grouped_season_totals$`2020`,
                              site = "Black Canyon South",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[9]),
           fill = horse_color) +
        annotate(geom = "label",
           x = 4,
           y = elk_position(list_of_grouped_season_totals$`2020`, 
                            site = "Fifty One",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[10]),
           fill = elk_color) +
  annotate(geom = "text",
           x = 4,
           y = cow_position(list_of_grouped_season_totals$`2020`, 
                            site = "Fifty One",
                            weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[11])) +
  annotate(geom = "text", 
           x = 4, 
           y = horse_position(list_of_grouped_season_totals$`2020`,
                              site = "Fifty One",
                              weighted = TRUE),
           size = 9,
           label = percent(list_of_grouped_season_totals$`2020`$proportion_wtd[12]))
ggsave("2020-Total-Grazing-Minutes-by-Site-Weighted-By-AUE.jpg",
       height = 4,
       width = 6.5,
       units = "in",
     path = file.path(currentwd, "figures", "grazing-minutes", "total-site-use"))
```
