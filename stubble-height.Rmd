---
title: "Stubble Height"
author: "Andrew Antaya"
date: "June 20, 2019"
output:
  html_document: 
    theme: readable
    toc: yes
    toc_depth: 5
    fig_caption: yes
  word_document:
    toc: yes
editor_options: 
  markdown: 
    wrap: 72
---

# Setup

```{r clear environment}
# clear the environment
rm(list = ls(all = TRUE))
```

```{r setup environment}
source("environment.R")
```

```{r load packages, echo=FALSE}
source("packages.R")
```

```{r load functions}
source("functions.R")
```

```{r set time zone to Arizona}
Sys.setenv(TZ = "US/Arizona")
```

```{r view session info}
sessionInfo()
```

# Load Data

The data exported from VGS is an xlsx file with two sheets. The first
sheet is "metadata" and does not contain any data. The second sheet is
"Stubble Height" and contains our stubble height data. For our purposes,
we only want to keep the sheet with the data.

```{r Read in Excel data and convert to csv, eval=FALSE, include=FALSE}
# this code chunk only needs to be turned on once
# when converting data then it can be turned off
# after the files are converted

# list all of the xlsx data files in the
# directory
xlsx_file_list <- list.files(
  "data/vegetation/heber/stubble-height/xlsx", pattern = "xlsx"
)

# create a vector of file names that we will use
# to rename our xlsx files into csv files do this
# by replacing the file extension but otherwise
# keep the file name the same
file_names <- str_replace_all(xlsx_file_list, "xlsx", "csv")

# create a vector of file paths to tell R where
# to find the source xlsx data
file_source <- paste0(
  getwd(), "/data/vegetation/heber/stubble-height/xlsx/",
  xlsx_file_list
)

# create a vector of file paths to tell R where
# to put the files after conversion
file_destination <- paste0(
  getwd(), "/data/vegetation/heber/stubble-height/csv/",
  file_names
)

# for loop through the file list to convert all
# xlsx files in the directory to csv files
for (i in 1:length(file_source)) {
  # read the data from the Stubble Height sheet
  xlsx_data <- openxlsx::read.xlsx(file_source[i], sheet = "Stubble Height")
  # write out the xlsm data as an xlsx
  readr::write_csv(
    xlsx_data, paste0(file_destination[i]),
    na = "NA"
  )
}
```

Read in the White Mountain data, from 2017 to 2019.

```{r load White Mountain data}
BGW17stubble <- readr::read_csv(
  "data/vegetation/white-mountains/2017-boggy-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

WCS17stubble <- readr::read_csv(
  "data/vegetation/white-mountains/2017-wildcat-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BGW18stubble <- readr::read_csv(
  "data/vegetation/white-mountains/2018-boggy-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

WCS18stubble <- readr::read_csv(
  "data/vegetation/white-mountains/2018-wildcat-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BGW19stubble <- readr::read_csv(
  "data/vegetation/white-mountains/2019-boggy-grazed-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

WCS19stubble <- readr::read_csv(
  "data/vegetation/white-mountains/2019-wildcat-grazed-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BGW17stubble
WCS17stubble
WCS18stubble
BGW19stubble
WCS19stubble
```

Read in the Heber data, from 2018 to 2020.

```{r load Heber data}
BKS18stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2018-BKS-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BRL18stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2018-BRL-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

A5119stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2019-A51-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BKN19stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2019-BKN-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BRL19stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2019-BRL-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)
A5120stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2020-A51-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BKN20stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2020-BKN-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BKS20stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2020-BKS-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BRL20stubble <- readr::read_csv(
  "data/vegetation/heber/stubble-height/csv/2020-BRL-stubble-height.csv",
  col_names = TRUE, na = c("", " ", "NA")
)

BKS18stubble
BRL18stubble
A5119stubble
BKN19stubble
BRL19stubble
A5120stubble
BKN20stubble
BKS20stubble
BRL20stubble
```

# Clean Up Data

The 2018 Heber stubble height data was collected differently and only
has three columns. We need to convert the "grazed" and "ungrazed"
columns into a single column to make it the same as the 2019 and 2020
data.

## Add Helpful Columns

```{r Add Site and Year Columns 2018 Heber Data}
# add two columns with the Site and Year to help us keep track of the data
BKS18stubble <- BKS18stubble %>% 
  dplyr::mutate(Site = "BKS", Year = 2018)

BRL18stubble <- BRL18stubble %>% 
  dplyr::mutate(Site = "BRL", Year = 2018)

# bind the 2018 heber data together for easier manipulation
heber_stubble_2018 <- dplyr::bind_rows(BKS18stubble, BRL18stubble)

# rename the "sample" column to "Record" to bring it inline with the 2019 and 2020 data
heber_stubble_2018 <- heber_stubble_2018 %>% 
  dplyr::rename(Sample = sample)

# convert the NA values in the "ungrazed" column to zero 
# this will make it easier to add values together 
# (i.e., you can't add a number to a NA) 
heber_stubble_2018$ungrazed <- heber_stubble_2018 %>% 
  pull(ungrazed) %>% 
  tidyr::replace_na(0)

# convert the NA values in the "grazed" column to zero 
# this will make it easier to add values together 
heber_stubble_2018$grazed <- heber_stubble_2018 %>% 
  pull(grazed) %>% 
  tidyr::replace_na(0)

# add the "grazed" and "ungrazed" values together into a new column 
# this will bring it inline with the 2019 and 2020 data
# also drop the "grazed" and "ungrazed" columns and keep the unused columns
heber_stubble_2018 <- heber_stubble_2018 %>% 
  dplyr::mutate("Height" = grazed + ungrazed, .keep = "unused")

# print the data frame to view the changes
heber_stubble_2018
```

The 2019 and 2020 Heber data was collected with VGS and is very similar
to but not exactly the same as the White Mountains data for the same
years. Two column names are slightly different in the Heber data that we
need to fix.

```{r Add Site and Years Columns 2019 Heber Data}
# add two columns with the Site and Year to help us keep track of the data
A5119stubble <- A5119stubble %>% 
  dplyr::mutate(Site = "A51", Year = 2019)

BKN19stubble <- BKN19stubble %>% 
  dplyr::mutate(Site = "BKN", Year = 2019)

BRL19stubble <- BRL19stubble %>% 
  dplyr::mutate(Site = "BRL", Year = 2019)

A5120stubble <- A5120stubble %>% 
  dplyr::mutate(Site = "A51", Year = 2020)

BKN20stubble <- BKN20stubble %>% 
  dplyr::mutate(Site = "BKN", Year = 2020)

BKS20stubble <- BKS20stubble %>% 
  dplyr::mutate(Site = "BKS", Year = 2020)

BRL20stubble <- BRL20stubble %>% 
  dplyr::mutate(Site = "BRL", Year = 2020)

# bind the rows together to help with manipulation
heber_stubble_data <- bind_rows(A5119stubble, 
                                BKN19stubble, 
                                BRL19stubble, 
                                A5120stubble, 
                                BKN20stubble, 
                                BKS20stubble, 
                                BRL20stubble, 
                                heber_stubble_2018)

# rename the slightly different column name in the Heber data to match the
# column name in the White Mountains data
heber_stubble_data <- heber_stubble_data %>% 
  dplyr::rename("Species/Category Code" = "Species/Category.Code")

# rename the slightly different column name in the Heber data to match the
# column name in the White Mountains data
heber_stubble_data <- heber_stubble_data %>% 
  dplyr::rename("Species/Category Name" = "Species/Category.Name")

# arrange the data frame in ascending order by year
# this helps seeing the data in order from when it was collected
heber_stubble_data <- heber_stubble_data %>% 
  dplyr::arrange(Year)

# print the data frame to view the changes
heber_stubble_data
```

The Heber data is now in the same format as the 2019 White Mountains
data. However, we need to rename columns in these data frames to make
them consistent with the 2017 and 2018 White Mountains data.

First, add a "Site" column and a "Year" column to the 2019 White
Mountains data. This will make it easier to keep track of the data as we
clean it up.

```{r Add Site and Years Columns 2019 White Mountains Data}
BGW19stubble <- BGW19stubble %>% dplyr::mutate(Site = "Boggy", Year = 2019)

WCS19stubble <- WCS19stubble %>% dplyr::mutate(Site = "Wildcat", Year = 2019)

# print the data frames to view the changes
BGW19stubble

WCS19stubble

# bind the rows together for easier manipulation
wm_stubble_2019 <- dplyr::bind_rows(BGW19stubble, WCS19stubble)

wm_stubble_2019
```

Next, we'll combine the 2019 White Mountains data with Heber data. We'll
rename the columns and drop other columns to make it consistent with the
2017 and 2018 White Mountains data.

```{r Rename Columns for Consistency Across Years}
# bind data together for easier manipulation
mutated_stubble_data <- bind_rows(wm_stubble_2019, heber_stubble_data)

# rename the "Species/Category Code" column to "Species" 
# to be consistent with the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% 
  dplyr::rename(Species = "Species/Category Code")

# rename the "Sample" column to "Record" 
# to be consistent with the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% 
  dplyr::rename(Record = "Sample")

# remove the columns that are not in the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% 
  dplyr::select(-c("Qualifier", "Transect", "Species/Category Name"))

# rename the "Height" column to "Height-in" 
# to be consistent with the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% 
  dplyr::rename("Height-in" = "Height")

# add a "Condition" column to be consistent with the 2017 and 2018 data
mutated_stubble_data <- mutated_stubble_data %>% 
  dplyr::mutate(Condition = NA)

# view the changes to the data frame
mutated_stubble_data
```

Combine data frames together so all the stubble height data is in the
same place.

```{r Bind All Data Together}
stubble_data <- bind_rows(BGW17stubble, 
                          WCS17stubble, 
                          BGW18stubble, 
                          WCS18stubble, 
                          mutated_stubble_data)

# arrange the data frame in ascending order by year
# this helps seeing the data in order from when it was collected
stubble_data <- stubble_data %>% 
  arrange(Year)

print(stubble_data)
```

We have 1 missing height value in the data that we need to remove. Not
sure how this happened, but we need to remove it nonetheless.

```{r Remove Missing Data}
## clean up the data by removing any missing values
stubble_data <- stubble_data %>% 
  tidyr::drop_na("Height-in")

print(stubble_data)
```

## Combine Plants Species

Blue grama was coded as "BOGR2" and as "BOGRS" in this data set, and we
want to have a single species code to represent blue grama. Therefore,
anywhere "BOGRS" occurs in the data, we want to replace it with "BOGR2".

```{r Replace "BOGRS" with "BOGR2"}
stubble_data <- stubble_data %>% 
  dplyr::mutate(Species = replace(Species, Species == "BOGRS", "BOGR2"))

stubble_data
```

Additionally, we want to collapse both Poa species (Poa pratensis and
Poa fendleriana) into their genus (Poa). It can very difficulkt to
differentiate these species while in the field, and lower confidence in
our observations tends to make it more conservative (and safer) to
collapse these species into a genus for analysis purposes. Functionally,
both species are very similar.

```{r Replace POPR Values with POA}
stubble_data <- stubble_data %>% 
  dplyr::mutate(Species = replace(Species, Species == "POPR" | Species == "POFE", "POA"))

stubble_data
```

In 2018, we did not differentiate by stubble height by species. In the
original data, we labeled this special circumstance as "Missing", but in
reality this data actually represents all species combined together. We
will then replace all the values labeled as "Missing" with "Combined
Species".

```{r Replace "Missing" Species with "Combined Species"}
stubble_data$Species <- 
  stubble_data$Species %>% tidyr::replace_na("Combined Species")
print(stubble_data)
```

We also will replace the annual forb species code "AAFF" with a more
descriptive "Annual Forb" character string.

```{r Replace "AAFF" Species with "Annual Forb"}
stubble_data$Species <- 
  stubble_data$Species %>% str_replace(pattern = "AAFF", 
                                     replacement = "Annual Forb")
print(stubble_data)
```

## Code Plant Species as Factors

We need to convert the "Species" column which is currently a character
type into a factor type. R treats factors differently than characters,
with the main difference being that factors have levels. Levels can be
ranked in order (e.g., low to high, smallest to largest).

```{r Code Species as Factors}
# convert the "Species" column from character to factor
# reorder the levels by the frequency in which they appear in the data
# i.e. species that have the most observations are coded as the highest level
stubble_data$Species <- stubble_data %>% 
  pull(Species) %>% 
  forcats::as_factor() %>% 
  fct_infreq()

# print the data frame to view the changes
stubble_data
```

```{r View Factors Levels After Coding as Factors}
stubble_data %>% pull(Species) %>% levels()
```

```{r Create CSV Filename From System Time}
filename <- paste(
  format(
    Sys.time(), 
    "%Y-%m-%d-%H-%M-%S"), 
  "stubble-height-all-sites-all-years.csv",
  sep = "-")
print(filename)
```

```{r Write Out Cleaned CSV File}
readr::write_csv(stubble_data, 
                 file.path(currentwd,
                           "data", 
                           "vegetation",
                           filename))
```

# Data Visualization

## Histograms of Poa

Plot a histogram bluegrass to visualize the distribution of stubble
heights.

```{r Boggy 2017 Histogram}
stubble_data %>% 
        dplyr::filter(Site == "Boggy" & Year == "2017") %>% 
        dplyr::filter(Species == "POA") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa spp.",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis = 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis = 0.75, las = 2)
mtext("Boggy 2017", 3, adj = 0.5, line = -1)
```

```{r Wildcat 2017 Histogram}
stubble_data %>% 
        dplyr::filter(Site == "Wildcat" & Year == "2017") %>% 
        dplyr::filter(Species == "POA") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa spp.",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis = 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis = 0.75, las = 2)
mtext("Wildcat 2017", 3, adj = 0.5, line = -1)
```

```{r Boggy 2019 Histogram}
stubble_data %>% 
        dplyr::filter(Site == "Boggy" & Year == "2019") %>% 
        dplyr::filter(Species == "POA") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa spp.",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis = 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis = 0.75, las = 2)
mtext("Boggy 2019", 3, adj = 0.5, line = -1)
```

## White Mountains Stubble Height Figures

### Extract Data and Calculate Statistics

Filter out the Heber data and keep only the White Mountains data.

```{r Filter Out Heber Data}
white_mountains_stubble <- stubble_data %>% 
  dplyr::filter(Site == "Boggy" | Site == "Wildcat") %>% 
  dplyr::filter(Species != "Combined Species")

print(white_mountains_stubble)
```

We will build a project-specific species list because many of the
species are in common between sites, but fewer species are in common
between projects, because the projects are in very different areas.

```{r Calc Summary Stats for White Mountains}
white_mountains_stubble_stats <- 
  white_mountains_stubble %>%
  dplyr::group_by(Species) %>%
  rstatix::get_summary_stats("Height-in", type = "common") %>% 
  dplyr::filter(n >= 3)
print(white_mountains_stubble_stats)
```

```{r Check Factor Levels White Mountains Stubble Stats}
white_mountains_stubble_stats$Species %>% 
  fct_drop() %>% 
  levels()
```

```{r White Mountains All Species Figure}
white_mountains_all_species_figure <- white_mountains_stubble_stats %>% 
  ggplot(
    aes(fill = Species, y = mean, x = Species)
) +
  geom_col(width = 0.25) +
  labs(
    title = expression(
      atop("White Mountains All Sites Combined", paste("Stubble Height"))
    ),
    subtitle = "All Years"
  ) +
  ylab("") +
  scale_y_continuous(
    limits = c(0, 15),
    breaks = seq(0, 15, by = 1)
  ) +
  scale_fill_brewer(palette = "Dark2") +
  geom_errorbar(
    aes(ymin = (mean - ci), ymax = (mean + ci)),
    position = position_dodge(0.5),
    width = 0.1
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 11),
    plot.subtitle = element_text(hjust = 0.5),
    axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
    axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))
  )
white_mountains_all_species_figure
```

```{r Extract Factors as Characters White Mountains}
white_mountains_species <- 
white_mountains_stubble_stats$Species %>% 
  forcats::fct_drop() %>% 
  levels() %>% 
  as.character()
white_mountains_species
```

```{r Create Color Scheme White Mountains}
white_mountains_build <- ggplot_build(white_mountains_all_species_figure)

white_mountains_color_scheme <- unique(white_mountains_build$data[[1]]["fill"])

white_mountains_color_scheme <- white_mountains_color_scheme %>% 
  dplyr::mutate(Species = white_mountains_species)

readr::write_csv(white_mountains_color_scheme,
                 file.path(currentwd,
                           "figures",
                           "stubbleheight",
                           "white-mountains-color-scheme.csv"))

print(white_mountains_color_scheme)
```

### 2017

```{r Boggy 2017 Stubble Stats}
BGW17stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Boggy" & Year == 2017) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)

BGW17stubblestats
```

```{r Boggy 2017 Stubble Height Figure}
BGW17figure <- 
BGW17stubblestats %>% 
ggplot(aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  labs(title = "Boggy Creek Stubble Height 2017") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = white_mountains_color_scheme$fill, 
                    breaks = white_mountains_color_scheme$Species) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +

  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BGW17stubblestats$mean[1] + BGW17stubblestats$ci[1] + 1), 
           label = signif(BGW17stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW17stubblestats$mean[2] + BGW17stubblestats$ci[2] + 1), 
           label = signif(BGW17stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW17stubblestats$mean[3] + BGW17stubblestats$ci[3] + 1), 
           label = signif(BGW17stubblestats$mean[3], 2)) +
  annotate(geom = "text", 
           x = 4, 
           y = (BGW17stubblestats$mean[4] + BGW17stubblestats$ci[4] + 1), 
           label = signif(BGW17stubblestats$mean[4], 2)) +
  # annotate(geom = "text", x = 2, y = 4.75, label = signif(BGW17stubblestats$mean[2], 2)) +
  # annotate(geom = "text", x = 3, y = 4, label = signif(BGW17stubblestats$mean[3], 2)) +

# add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (BGW17stubblestats$mean[1]/2), 
           label = paste0("n = ", BGW17stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW17stubblestats$mean[2]/2), 
           label = paste0("n = ", BGW17stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW17stubblestats$mean[3]/2), 
           label = paste0("n = ", BGW17stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 4, 
           y = (BGW17stubblestats$mean[4]/2), 
           label = paste0("n = ", BGW17stubblestats$n[4]), 
           size = 3, 
           alpha = 0.75)
ggsave("Boggy-2017-Stubble-Height-n-samples-95CI.jpg",
   path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))

BGW17figure
```

```{r Boggy 2017 Stubble Height Figure No Legend}
BGW17figure <- 
BGW17stubblestats %>% 
ggplot(aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  labs(title = "Boggy Creek 2017", subtitle = "Stubble Height") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = white_mountains_color_scheme$fill, 
                    breaks = white_mountains_color_scheme$Species) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BGW17stubblestats$mean[1] + BGW17stubblestats$ci[1] + 1), 
           label = signif(BGW17stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW17stubblestats$mean[2] + BGW17stubblestats$ci[2] + 1), 
           label = signif(BGW17stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW17stubblestats$mean[3] + BGW17stubblestats$ci[3] + 1), 
           label = signif(BGW17stubblestats$mean[3], 2)) +
  annotate(geom = "text", 
           x = 4, 
           y = (BGW17stubblestats$mean[4] + BGW17stubblestats$ci[4] + 1), 
           label = signif(BGW17stubblestats$mean[4], 2)) +
  # annotate(geom = "text", x = 2, y = 4.75, label = signif(BGW17stubblestats$mean[2], 2)) +
  # annotate(geom = "text", x = 3, y = 4, label = signif(BGW17stubblestats$mean[3], 2)) +

# add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (BGW17stubblestats$mean[1]/2), 
           label = paste0("n = ", BGW17stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW17stubblestats$mean[2]/2), 
           label = paste0("n = ", BGW17stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW17stubblestats$mean[3]/2), 
           label = paste0("n = ", BGW17stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 4, 
           y = (BGW17stubblestats$mean[4]/2), 
           label = paste0("n = ", BGW17stubblestats$n[4]), 
           size = 3, 
           alpha = 0.75)
BGW17figure
```

```{r Wildcat 2017 Stubble Stats}
WCS17stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Wildcat" & Year == 2017) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)

WCS17stubblestats
```

```{r Wildcat 2017 Stubble Height Figure}
WCS17figure <- 
WCS17stubblestats %>% 
ggplot(aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  labs(title = "Wildcat Creek Stubble Height 2017") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = white_mountains_color_scheme$fill, 
                    breaks = white_mountains_color_scheme$Species) +
  geom_errorbar(aes(ymin = (mean - ci), ymax = (mean + ci)), position = position_dodge(0.5), width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 5))) +

# add stubble height values above the  error bars
# round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (WCS17stubblestats$mean[1] + WCS17stubblestats$ci[1] + 1), 
           label = signif(WCS17stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS17stubblestats$mean[2] + WCS17stubblestats$ci[2] + 1), 
           label = signif(WCS17stubblestats$mean[2], 2)) +

# add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (WCS17stubblestats$mean[1]/2), 
           label = paste0("n = ", WCS17stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS17stubblestats$mean[2]/3), 
           label = paste0("n = ", WCS17stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75)
ggsave("Wildcat-2017-Stubble-Height-n-samples-95CI.jpg",
       path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))

WCS17figure
```

```{r Wildcat 2017 Stubble Height Figure Drop Y Axis Label}
WCS17figure <- 
WCS17stubblestats %>% 
ggplot(aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  labs(title = "Wildcat Creek 2017", subtitle = "Stubble Height") +
  ylab("") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = white_mountains_color_scheme$fill, 
                    breaks = white_mountains_color_scheme$Species) +
  geom_errorbar(aes(ymin = (mean - ci), ymax = (mean + ci)), position = position_dodge(0.5), width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.ticks = element_blank(),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 5)),
        legend.position = "none") +
# add stubble height values above the  error bars
# round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (WCS17stubblestats$mean[1] + WCS17stubblestats$ci[1] + 1), 
           label = signif(WCS17stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS17stubblestats$mean[2] + WCS17stubblestats$ci[2] + 1), 
           label = signif(WCS17stubblestats$mean[2], 2)) +

# add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (WCS17stubblestats$mean[1]/2), 
           label = paste0("n = ", WCS17stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS17stubblestats$mean[2]/3), 
           label = paste0("n = ", WCS17stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text",
           x = 1.5,
           y = 7,
           size = 3,
           aplha = 0.75,
           label = "n = number of samples")

WCS17figure
```

```{r Combine 2017 White Mountains Figures}
ggpubr::ggarrange(BGW17figure, WCS17figure,
                  widths = c(1, 1),
                  ncol = 2,
                  align = "h")

ggsave("White-Mountains-Stubble-Height-2017-combined.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))
```

### 2018

```{r Boggy 2018 Stubble Stats}
BGW18stubblestats <- stubble_data %>%
  dplyr::filter(Site == "Boggy" & Year == 2018) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BGW18stubblestats
```

```{r Boggy 2018 Stubble Height Figure}
BGW18figure <- 
  BGW18stubblestats %>% 
ggplot(aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.25) +
  labs(title = "Boggy Creek 2018", subtitle = "Stubble Height") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = "#7F7F7F") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), ymax = (mean + ci)), position = position_dodge(0.5), width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
# add stubble height values above the  error bars
# round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BGW18stubblestats$mean[1] + BGW18stubblestats$ci[1] + 1), 
           label = signif(BGW18stubblestats$mean[1], 2)) +
# add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (BGW18stubblestats$mean[1]/2), 
           label = paste0("n = ", BGW18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75)
BGW18figure
ggsave("Boggy-2018-Stubble-Height-n-samples.jpg",
   path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))
```

```{r Wildcat 2018 Stubble Stats}
WCS18stubblestats <- stubble_data %>%
  dplyr::filter(Site == "Wildcat" & Year == 2018) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
WCS18stubblestats
```

```{r Wildcat 2018 Stubble Height Figure}
WCS18figure <- 
ggplot(WCS18stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.25) +
  labs(title = "Wildcat Creek 2018", subtitle = "Stubble Height") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = "#7F7F7F") +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (WCS18stubblestats$mean[1] + WCS18stubblestats$ci[1] + 1), 
           label = signif(WCS18stubblestats$mean[1], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (WCS18stubblestats$mean[1]/2), 
           label = paste0("n = ", WCS18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) 
WCS18figure
ggsave("Wildcat-2018-Stubble-Height-n-samples.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))
```

```{r Wildcat 2018 Stubble Height Figure Drop Y Axis Label}
WCS18figure <- 
ggplot(WCS18stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.25) +
  labs(title = "Wildcat Creek 2018", subtitle = "Stubble Height") +
  ylab("") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = "#7F7F7F") +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (WCS18stubblestats$mean[1] + WCS18stubblestats$ci[1] + 1), 
           label = signif(WCS18stubblestats$mean[1], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (WCS18stubblestats$mean[1]/2), 
           label = paste0("n = ", WCS18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) 
WCS18figure
```

```{r Combine 2018 White Mountains Figures}
ggpubr::ggarrange(BGW18figure, WCS18figure,
                  widths = c(1, 1),
                  ncol = 2,
                  align = "h")

ggsave("White-Mountains-Stubble-Height-2018-combined.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))
```

### 2019

```{r Boggy 2019 Stubble Stats}
BGW19stubblestats <- stubble_data %>%
  dplyr::filter(Site == "Boggy" & Year == 2019) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BGW19stubblestats
```

```{r Boggy 2019 Stubble Height Figure}
BGW19figure <- 
ggplot(BGW19stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  labs(title = "Boggy Creek 2019", subtitle = "Stubble Height") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = white_mountains_color_scheme$fill, 
                    breaks = white_mountains_color_scheme$Species) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BGW19stubblestats$mean[1] + BGW19stubblestats$ci[1] + 1), 
           label = signif(BGW19stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW19stubblestats$mean[2] + BGW19stubblestats$ci[2] + 0.5), 
           label = signif(BGW19stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW19stubblestats$mean[3] + BGW19stubblestats$ci[3] + 1), 
           label = signif(BGW19stubblestats$mean[3], 2)) +

  # add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (BGW19stubblestats$mean[1]/2), 
           label = paste0("n = ", BGW19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW19stubblestats$mean[2]/2), 
           label = paste0("n = ", BGW19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW19stubblestats$mean[3]/3), 
           label = paste0("n = ", BGW19stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75)
ggsave("Boggy-2019-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))
BGW19figure
```

```{r Wildcat 2019 Stubble Stats}
WCS19stubblestats <- stubble_data %>%
  dplyr::filter(Site == "Wildcat" & Year == 2019) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
WCS19stubblestats
```

```{r Wildcat 2019 Stubble Height Figure}
WCS19figure <- 
ggplot(WCS19stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  labs(title = "Wildcat Creek 2019", subtitle = "Stubble Height") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
    scale_fill_manual(values = white_mountains_color_scheme$fill, 
                    breaks = white_mountains_color_scheme$Species) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (WCS19stubblestats$mean[1] + WCS19stubblestats$ci[1] + 1), 
           label = signif(WCS19stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS19stubblestats$mean[2] + WCS19stubblestats$ci[2] + 1), 
           label = signif(WCS19stubblestats$mean[2], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (WCS19stubblestats$mean[1]/2), 
           label = paste0("n = ", WCS19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS19stubblestats$mean[2]/2), 
           label = paste0("n = ", WCS19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 1.5, 
           y = 7, 
           label = paste0("n = number of samples"), 
           size = 3, 
           alpha = 0.75)
ggsave("Wildcat-2019-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))
WCS19figure
```

```{r Wildcat 2019 Stubble Height Figure Drop Y Axis Label}
WCS19figure <- 
ggplot(WCS19stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  labs(title = "Wildcat Creek 2019", subtitle = "Stubble Height") +
  ylab("") +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  scale_fill_manual(values = white_mountains_color_scheme$fill, 
                    breaks = white_mountains_color_scheme$Species) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (WCS19stubblestats$mean[1] + WCS19stubblestats$ci[1] + 1), 
           label = signif(WCS19stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS19stubblestats$mean[2] + WCS19stubblestats$ci[2] + 1), 
           label = signif(WCS19stubblestats$mean[2], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (WCS19stubblestats$mean[1]/2), 
           label = paste0("n = ", WCS19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS19stubblestats$mean[2]/2), 
           label = paste0("n = ", WCS19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 1.5, 
           y = 7, 
           label = paste0("n = number of samples"), 
           size = 3, 
           alpha = 0.75)
WCS19figure
```

```{r Combine 2019 White Mountains Figures}
ggpubr::ggarrange(BGW19figure, WCS19figure,
                  widths = c(1, 1),
                  ncol = 2,
                  align = "h")

ggsave("White-Mountains-Stubble-Height-2019-combined.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(getwd(),"/figures", "/stubbleheight", "/white-mountains"))
```

## Heber Stubble Height Figures

### Extract Data and Calculate Statistics

Filter out the Heber data and keep only the White Mountains data.

```{r Filter Out White Mountain Data}
heber_stubble <- stubble_data %>% 
  dplyr::filter(Site != "Boggy" & Site != "Wildcat") %>% 
  dplyr::filter(Species != "Combined Species")
print(heber_stubble)
```

```{r Calc Summary Stats Heber}
heber_stubble_stats <- 
  heber_stubble %>%
  dplyr::group_by(Species) %>%
  rstatix::get_summary_stats("Height-in", type = "common") %>% 
  dplyr::filter(n >= 3) %>% 
  dplyr::arrange(desc(n))
print(heber_stubble_stats)
```

Drop the unused factor levels from the Heber data, and then re-order the
factor levels by the frequency in which they occur.

```{r Drop Unused Levels Heber Stubble Stats}
heber_stubble_stats$Species <- 
  heber_stubble_stats %>% 
  pull(Species) %>% 
  forcats::fct_drop() %>% 
  forcats::fct_inorder()
heber_stubble_stats$Species %>% levels()
```

```{r Heber All Species Figure}
heber_all_species_figure <- 
heber_stubble_stats %>% 
  ggplot(
    aes(fill = Species, y = mean, x = Species)
) +
  geom_col(width = 0.25) +
  labs(
    title = expression(
      atop("Heber All Sites Combined", paste("Stubble Height"))
    ),
    subtitle = "All Years"
  ) +
  ylab("") +
  scale_y_continuous(
    limits = c(0, 15),
    breaks = seq(0, 15, by = 1)
  ) +
  geom_errorbar(
    aes(ymin = (mean - ci), ymax = (mean + ci)),
    position = position_dodge(0.5),
    width = 0.1
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 11),
    plot.subtitle = element_text(hjust = 0.5),
    axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
    axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))
  )
heber_all_species_figure
```

```{r Extract Factors as Characters Heber}
heber_species <- 
heber_stubble_stats$Species %>%
  levels() %>% 
  as.character()
print(heber_species)
```

```{r Create Color Scheme Heber}
heber_build <- ggplot_build(heber_all_species_figure)

heber_color_scheme <- unique(heber_build$data[[1]]["fill"])

heber_color_scheme <- heber_color_scheme %>% 
  dplyr::mutate(Species = heber_species)

# readr::write_csv(heber_color_scheme,
#                  file.path(currentwd,
#                            "figures",
#                            "stubbleheight",
#                            "heber-color-scheme.csv"))

print(heber_color_scheme)
```

### 2018

#### Black Canyon South

```{r Black Canyon South 2018 Stubble Stats}
BKS18stubblestats <- stubble_data %>%
  dplyr::filter(Site == "BKS" & Year == 2018) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BKS18stubblestats
```

```{r Add Upper and Lower Confidence Interval Black Canyon SOuth 2018}
BKS18stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> BKS18stubblestats
print(BKS18stubblestats)
```

```{r Black Canyon South 2018 Stubble Height Figure}
BKS18plot <-
  ggplot(BKS18stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Black Canyon South", 
                               paste("Stubble Height"))), 
       subtitle = "2018") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = "#7F7F7F") +
  scale_y_continuous(limits = c(0, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BKS18stubblestats$mean[1] + BKS18stubblestats$ci[1] + 1), 
           label = signif(BKS18stubblestats$mean[1], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (BKS18stubblestats$mean[1]/2), 
           label = paste0("n = ", BKS18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75)
ggsave("Black-Canyon-South-2018-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
BKS18plot
```

#### Bear

```{r Bear 2018 Stubble Stats}
BRL18stubblestats <- stubble_data %>%
  dplyr::filter(Site == "BRL" & Year == 2018) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common", 
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BRL18stubblestats
```

```{r Add Upper and Lower Confidence Interval Bear 2018}
BRL18stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> BRL18stubblestats
print(BRL18stubblestats)
```

```{r Bear 2018 Stubble Height Figure}
BRL18plot <-
  ggplot(BRL18stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Bear", 
                               paste("Stubble Height"))), 
       subtitle = "2018") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = "#7F7F7F") +
  scale_y_continuous(limits = c(0, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BRL18stubblestats$mean[1] + BRL18stubblestats$ci[1] + 1), 
           label = signif(BRL18stubblestats$mean[1], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (BRL18stubblestats$mean[1]/2), 
           label = paste0("n = ", BRL18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75)
ggsave("Bear-2018-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
BRL18plot
```

```{r Bear 2018 Stubble Height Figure Drop Y Axis Label}
BRL18plot <-
  ggplot(BRL18stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Bear", 
                               paste("Stubble Height"))), 
       subtitle = "2018") +
  ylab("") +
  scale_fill_manual(values = "#7F7F7F") +
  scale_y_continuous(limits = c(0, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BRL18stubblestats$mean[1] + BRL18stubblestats$ci[1] + 1), 
           label = signif(BRL18stubblestats$mean[1], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (BRL18stubblestats$mean[1]/2), 
           label = paste0("n = ", BRL18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 1, 
           y = 10, 
           label = paste0("n = number of samples"), 
           size = 3, 
           alpha = 0.75)
BRL18plot
```

```{r Combine Heber 2018 Figures}
heber2018_figure <- ggpubr::ggarrange(BKS18plot, BRL18plot,
                  widths = c(1, 1),
                  ncol = 2,
                  align = "h")
ggsave("Heber-Stubble-Height-2018-n-samples-95CI.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
heber2018_figure
```

### 2019

#### Bear

```{r Bear 2019 Stubble Stats}
BRL19stubblestats <- heber_stubble %>%
  dplyr::filter(Site == "BRL" & Year == 2019) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BRL19stubblestats
```

```{r Add Upper and Lower Confidence Interval Bear 2019}
BRL19stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> BRL19stubblestats
print(BRL19stubblestats)
```

```{r Bear 2019 Stubble Height Figure}
BRL19plot <-
  ggplot(BRL19stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Bear", 
                               paste("Stubble Height"))), 
       subtitle = "2019") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BRL19stubblestats$mean[1] + BRL19stubblestats$ci[1] + 1), 
           label = signif(BRL19stubblestats$mean[1], 2)) +
    annotate(geom = "text", 
           x = 2, 
           y = (BRL19stubblestats$mean[2] + BRL19stubblestats$ci[2] + 1), 
           label = signif(BRL19stubblestats$mean[2], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BRL19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BRL19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75)
ggsave("Bear-2019-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
BRL19plot
```

#### Fifty One

```{r View Factor Levels Fifty One 2019}
heber_stubble %>%
  dplyr::filter(Site == "A51" & Year == 2019) %>% 
  pull(Species) %>% 
  levels()
```

```{r Fifty One 2019 Stubble Stats}
FTO19stubblestats <- 
  heber_stubble %>%
  dplyr::filter(Site == "A51" & Year == 2019) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
FTO19stubblestats
```

```{r Add Upper and Lower Confidence Interval Fifty One 2019}
FTO19stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> FTO19stubblestats
print(FTO19stubblestats)
```

```{r Fifty One 2019 Stubble Height Figure}
FTO19plot <-
  ggplot(FTO19stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Fifty One", 
                               paste("Stubble Height"))), 
       subtitle = "2019") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (FTO19stubblestats$mean[1] + FTO19stubblestats$ci[1] + 1), 
           label = signif(FTO19stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (FTO19stubblestats$mean[2] + FTO19stubblestats$ci[2] + 1), 
           label = signif(FTO19stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (FTO19stubblestats$mean[3] + FTO19stubblestats$ci[3] + 1), 
           label = signif(FTO19stubblestats$mean[3], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", FTO19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", FTO19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", FTO19stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75)
ggsave("Fifty-One-2019-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
FTO19plot
```

```{r Fifty One 2019 Stubble Height Figure Drop Y Axis Label}
FTO19plot <-
  ggplot(FTO19stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Fifty One", 
                               paste("Stubble Height"))), 
       subtitle = "2019") +
  ylab("") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (FTO19stubblestats$mean[1] + FTO19stubblestats$ci[1] + 1), 
           label = signif(FTO19stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (FTO19stubblestats$mean[2] + FTO19stubblestats$ci[2] + 1), 
           label = signif(FTO19stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (FTO19stubblestats$mean[3] + FTO19stubblestats$ci[3] + 1), 
           label = signif(FTO19stubblestats$mean[3], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", FTO19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", FTO19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", FTO19stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75)
FTO19plot
```

#### Black Canyon North

```{r Black Canyon North 2019 Stubble Stats}
BKN19stubblestats <- 
  heber_stubble %>%
  dplyr::filter(Site == "BKN" & Year == 2019) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BKN19stubblestats
```

Because the HECO has really strange confidence interval (it goes from 27
to -5), we'll just omit it in the figure by setting it to NA.

```{r Drop HECO Confidence Interval}
BKN19stubblestats$ci[3] <- NA
```

```{r Add Upper and Lower Confidence Interval Black Canyon North 2019}
BKN19stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> BKN19stubblestats
print(BKN19stubblestats)
```

```{r Black Canyon North 2019 Stubble Height Figure}
BKN19plot <-
  ggplot(BKN19stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Black Canyon North", 
                               paste("Stubble Height"))), 
       subtitle = "2019") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BKN19stubblestats$mean[1] + BKN19stubblestats$ci[1] + 1), 
           label = signif(BKN19stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BKN19stubblestats$mean[2] + BKN19stubblestats$ci[2] + 1), 
           label = signif(BKN19stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BKN19stubblestats$mean[3] + 1), 
           label = signif(BKN19stubblestats$mean[3], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BKN19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BKN19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("*n = ", BKN19stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75)
ggsave("Black-Canyon-North-2019-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
BKN19plot
```

```{r Black Canyon North 2019 Stubble Height Figure Drop Y Axis Label}
BKN19plot <-
  ggplot(BKN19stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Black Canyon North", 
                               paste("Stubble Height"))), 
       subtitle = "2019") +
  ylab("") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BKN19stubblestats$mean[1] + BKN19stubblestats$ci[1] + 1), 
           label = signif(BKN19stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BKN19stubblestats$mean[2] + BKN19stubblestats$ci[2] + 1), 
           label = signif(BKN19stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BKN19stubblestats$mean[3] + 1), 
           label = signif(BKN19stubblestats$mean[3], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BKN19stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BKN19stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("*n = ", BKN19stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75)
BKN19plot
```

```{r Combine Heber 2019 Figures}
heber2019_figure <- ggpubr::ggarrange(BRL19plot,
                                      FTO19plot,
                                      BKN19plot,
                                      widths = c(1, 1, 1),
                                      ncol = 3,
                                      align = "h")
ggsave("Heber-Stubble-Height-2019-n-samples-95CI.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
heber2019_figure
```

### 2020

#### Bear

```{r Bear 2020 Stubble Stats}
BRL20stubblestats <- heber_stubble %>%
  dplyr::filter(Site == "BRL" & Year == 2020) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BRL20stubblestats
```

```{r Add Upper and Lower Confidence Interval Bear 2020}
BRL20stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> BRL20stubblestats
print(BRL20stubblestats)
```

```{r Bear 2020 Stubble Height Figure}
BRL20plot <-
  ggplot(BRL20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Bear", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BRL20stubblestats$mean[1] + BRL20stubblestats$ci[1] + 1), 
           label = signif(BRL20stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BRL20stubblestats$mean[2] + BRL20stubblestats$ci[2] + 1), 
           label = signif(BRL20stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BRL20stubblestats$mean[3] + BRL20stubblestats$ci[3] + 1), 
           label = signif(BRL20stubblestats$mean[3], 2)) +
  annotate(geom = "text", 
           x = 4, 
           y = (BRL20stubblestats$mean[4] + BRL20stubblestats$ci[4] + 1), 
           label = signif(BRL20stubblestats$mean[4], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 4, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[4]), 
           size = 3, 
           alpha = 0.75)
ggsave("Bear-2020-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
BRL20plot
```

```{r Bear 2020 Stubble Height Figure Small Annotations}
BRL20plot <-
  ggplot(BRL20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Bear", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BRL20stubblestats$mean[1] + BRL20stubblestats$ci[1] + 1), 
           label = signif(BRL20stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BRL20stubblestats$mean[2] + BRL20stubblestats$ci[2] + 1), 
           label = signif(BRL20stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BRL20stubblestats$mean[3] + BRL20stubblestats$ci[3] + 1), 
           label = signif(BRL20stubblestats$mean[3], 2)) +
  annotate(geom = "text", 
           x = 4, 
           y = (BRL20stubblestats$mean[4] + BRL20stubblestats$ci[4] + 1), 
           label = signif(BRL20stubblestats$mean[4], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[1]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[2]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[3]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 4, 
           y = -1, 
           label = paste0("n = ", BRL20stubblestats$n[4]), 
           size = 2, 
           alpha = 0.75)
BRL20plot
```

#### Fifty One

```{r View Factor Levels Fifty One 2020}
heber_stubble %>%
  dplyr::filter(Site == "A51" & Year == 2020) %>% 
  pull(Species) %>% 
  levels()
```

```{r Fifty One 2020 Stubble Stats}
FTO20stubblestats <- 
  heber_stubble %>%
  dplyr::filter(Site == "A51" & Year == 2020) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
FTO20stubblestats
```

```{r Add Upper and Lower Confidence Interval Fifty One 2020}
FTO20stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> FTO20stubblestats
print(FTO20stubblestats)
```

```{r Fifty One 2020 Stubble Height Figure}
FTO20plot <-
  ggplot(FTO20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Fifty One", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (FTO20stubblestats$mean[1] + FTO20stubblestats$ci[1] + 1), 
           label = signif(FTO20stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (FTO20stubblestats$mean[2] + FTO20stubblestats$ci[2] + 1), 
           label = signif(FTO20stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (FTO20stubblestats$mean[3] + FTO20stubblestats$ci[3] + 1), 
           label = signif(FTO20stubblestats$mean[3], 2)) +
  annotate(geom = "text", 
           x = 4, 
           y = (FTO20stubblestats$mean[4] + FTO20stubblestats$ci[4] + 1), 
           label = signif(FTO20stubblestats$mean[4], 2)) +
  annotate(geom = "text", 
           x = 5, 
           y = (FTO20stubblestats$mean[5] + FTO20stubblestats$ci[5] + 1), 
           label = signif(FTO20stubblestats$mean[5], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 4, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[4]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 5, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[5]), 
           size = 3, 
           alpha = 0.75) 
ggsave("Fifty-One-2020-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
FTO20plot
```

```{r Fifty One 2020 Stubble Height Figure Drop Y Axis Label}
FTO20plot <-
  ggplot(FTO20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Fifty One", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (FTO20stubblestats$mean[1] + FTO20stubblestats$ci[1] + 1), 
           label = signif(FTO20stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (FTO20stubblestats$mean[2] + FTO20stubblestats$ci[2] + 1), 
           label = signif(FTO20stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (FTO20stubblestats$mean[3] + FTO20stubblestats$ci[3] + 1), 
           label = signif(FTO20stubblestats$mean[3], 2)) +
  annotate(geom = "text", 
           x = 4, 
           y = (FTO20stubblestats$mean[4] + FTO20stubblestats$ci[4] + 1), 
           label = signif(FTO20stubblestats$mean[4], 2)) +
  annotate(geom = "text", 
           x = 5, 
           y = (FTO20stubblestats$mean[5] + FTO20stubblestats$ci[5] + 1), 
           label = signif(FTO20stubblestats$mean[5], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[1]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[2]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[3]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 4, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[4]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 5, 
           y = -1, 
           label = paste0("n = ", FTO20stubblestats$n[5]), 
           size = 2, 
           alpha = 0.75)
FTO20plot
```

#### Black Canyon North

```{r Black Canyon North 2020 Stubble Stats}
BKN20stubblestats <- 
  heber_stubble %>%
  dplyr::filter(Site == "BKN" & Year == 2020) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BKN20stubblestats
```

```{r Add Upper and Lower Confidence Interval Black Canyon North 2020}
BKN20stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> BKN20stubblestats
print(BKN20stubblestats)
```

```{r Black Canyon North 2020 Stubble Height Figure}
BKN20plot <-
  ggplot(BKN20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Black Canyon North", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BKN20stubblestats$mean[1] + BKN20stubblestats$ci[1] + 1), 
           label = signif(BKN20stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BKN20stubblestats$mean[2] + BKN20stubblestats$ci[2] + 1), 
           label = signif(BKN20stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BKN20stubblestats$mean[3] + BKN20stubblestats$ci[3] + 1), 
           label = signif(BKN20stubblestats$mean[3], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BKN20stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BKN20stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", BKN20stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75)
ggsave("Black-Canyon-North-2020-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
BKN20plot
```

```{r Black Canyon North 2020 Stubble Height Figure Drop Y Axis Label}
BKN20plot <-
  ggplot(BKN20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Black Canyon North", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BKN20stubblestats$mean[1] + BKN20stubblestats$ci[1] + 1), 
           label = signif(BKN20stubblestats$mean[1], 2)) +
  annotate(geom = "text", 
           x = 2, 
           y = (BKN20stubblestats$mean[2] + BKN20stubblestats$ci[2] + 1), 
           label = signif(BKN20stubblestats$mean[2], 2)) +
  annotate(geom = "text", 
           x = 3, 
           y = (BKN20stubblestats$mean[3] + BKN20stubblestats$ci[3] + 1), 
           label = signif(BKN20stubblestats$mean[3], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BKN20stubblestats$n[1]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BKN20stubblestats$n[2]), 
           size = 2, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", BKN20stubblestats$n[3]), 
           size = 2, 
           alpha = 0.75)
BKN20plot
```

#### Black Canyon South

```{r Black Canyon South 2020 Stubble Stats}
BKS20stubblestats <- heber_stubble %>%
  dplyr::filter(Site == "BKS" & Year == 2020) %>% 
  dplyr::group_by(Species) %>% 
  rstatix::get_summary_stats("Height-in", 
                             type = "common",
                             show = c("n", "mean", "sd", "ci")) %>% 
  dplyr::filter(n >= 3)
BKS20stubblestats
```

```{r Add Upper and Lower Confidence Interval Black Canyon South 2020}
BKS20stubblestats %>% 
  dplyr::mutate(L95 = mean - ci) %>% 
  dplyr::mutate(U95 = mean + ci) -> BKS20stubblestats
print(BKS20stubblestats)
```

```{r Black Canyon South 2020 Stubble Height Figure}
BKS20plot <-
  ggplot(BKS20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Black Canyon South", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("Average Stubble Height (Inches) ± 95% CI") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BKS20stubblestats$mean[1] + BKS20stubblestats$ci[1] + 1), 
           label = signif(BKS20stubblestats$mean[1], 2)) +
    annotate(geom = "text", 
           x = 2, 
           y = (BKS20stubblestats$mean[2] + BKS20stubblestats$ci[2] + 1), 
           label = signif(BKS20stubblestats$mean[2], 2)) +
    annotate(geom = "text", 
           x = 3, 
           y = (BKS20stubblestats$mean[3] + BKS20stubblestats$ci[3] + 1), 
           label = signif(BKS20stubblestats$mean[3], 2)) +
    annotate(geom = "text", 
           x = 4, 
           y = (BKS20stubblestats$mean[4] + BKS20stubblestats$ci[4] + 1), 
           label = signif(BKS20stubblestats$mean[4], 2)) +
    annotate(geom = "text", 
           x = 5, 
           y = (BKS20stubblestats$mean[5] + BKS20stubblestats$ci[5] + 1), 
           label = signif(BKS20stubblestats$mean[5], 2)) +
    annotate(geom = "text", 
           x = 6, 
           y = (BKS20stubblestats$mean[6] + BKS20stubblestats$ci[6] + 1), 
           label = signif(BKS20stubblestats$mean[6], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 4, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[4]), 
           size = 3, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 5, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[5]), 
           size = 3, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 6, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[6]), 
           size = 3, 
           alpha = 0.75)
ggsave("Black-Canyon-South-2020-Stubble-Height-n-samples-95CI.jpg",
      path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
BKS20plot
```

```{r Black Canyon South 2020 Stubble Height Figure Drop Y Axis Label}
BKS20plot <-
  ggplot(BKS20stubblestats, 
         aes(fill = Species, 
             y = mean, 
             x = Species)) +
  geom_col(width = 0.25) +
  labs(title = expression(atop("Black Canyon South", 
                               paste("Stubble Height"))), 
       subtitle = "2020") +
  ylab("") +
  scale_fill_manual(values = heber_color_scheme$fill, 
                    breaks = heber_color_scheme$Species) +
  scale_y_continuous(limits = c(-1, 15), breaks = seq(0, 15, by = 1)) +
  geom_errorbar(aes(ymin = (mean - ci), 
                    ymax = (mean + ci)), 
                position = position_dodge(0.5), 
                width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5, size = 11),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 5, l = 0), 
                                   angle = 90),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10)),
        axis.ticks = element_blank(),
        legend.position = "none") +
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", 
           x = 1, 
           y = (BKS20stubblestats$mean[1] + BKS20stubblestats$ci[1] + 1), 
           label = signif(BKS20stubblestats$mean[1], 2)) +
    annotate(geom = "text", 
           x = 2, 
           y = (BKS20stubblestats$mean[2] + BKS20stubblestats$ci[2] + 1), 
           label = signif(BKS20stubblestats$mean[2], 2)) +
    annotate(geom = "text", 
           x = 3, 
           y = (BKS20stubblestats$mean[3] + BKS20stubblestats$ci[3] + 1), 
           label = signif(BKS20stubblestats$mean[3], 2)) +
    annotate(geom = "text", 
           x = 4, 
           y = (BKS20stubblestats$mean[4] + BKS20stubblestats$ci[4] + 1), 
           label = signif(BKS20stubblestats$mean[4], 2)) +
    annotate(geom = "text", 
           x = 5, 
           y = (BKS20stubblestats$mean[5] + BKS20stubblestats$ci[5] + 1), 
           label = signif(BKS20stubblestats$mean[5], 2)) +
    annotate(geom = "text", 
           x = 6, 
           y = (BKS20stubblestats$mean[6] + BKS20stubblestats$ci[6] + 1), 
           label = signif(BKS20stubblestats$mean[6], 2)) +
  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[1]), 
           size = 2, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 2, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[2]), 
           size = 2, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 3, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[3]), 
           size = 2, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 4, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[4]), 
           size = 2, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 5, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[5]), 
           size = 2, 
           alpha = 0.75) +
    annotate(geom = "text", 
           x = 6, 
           y = -1, 
           label = paste0("n = ", BKS20stubblestats$n[6]), 
           size = 2,
           alpha = 0.75)
BKS20plot
```

```{r Combine Heber 2020 Figures}
heber2020_figure <- ggpubr::ggarrange(BRL20plot,
                                      FTO20plot,
                                      BKN20plot,
                                      BKS20plot,
                                      widths = c(1, 1, 1, 1),
                                      ncol = 4,
                                      align = "h")
ggsave("Heber-Stubble-Height-2020-n-samples-95CI.jpg",
       height = 6,
       width = 9,
       units = "in",
       path = paste0(getwd(),"/figures", "/stubbleheight", "/heber"))
heber2020_figure
```
