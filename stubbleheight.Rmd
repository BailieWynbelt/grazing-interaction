---
title: "Stubble Height"
author: "Andrew Antaya"
date: "June 20, 2019"
output: html_notebook
---

```{r}
# clear the environment
rm(list=ls(all=TRUE))
```

```{r}
source("packages.R")
```

```{r}
source("functions.R")
```

```{r}
## read in data
BGW17stubble <- readr::read_csv('data/vegetation/white-mountains/2017-boggy-stubble-height.csv',
                                col_names = TRUE, 
                                na = c(""," ","NA"))
WCS17stubble <- readr::read_csv('data/vegetation/white-mountains/2017-wildcat-stubble-height.csv',
                                col_names = TRUE,
                                na = c(""," ","NA"))
BGW18stubble <- readr::read_csv('data/vegetation/white-mountains/2018-boggy-stubble-height.csv', 
                                col_names = TRUE, 
                                na = c(""," ","NA"))
WCS18stubble <- readr::read_csv('data/vegetation/white-mountains/2018-wildcat-stubble-height.csv',
                                col_names = TRUE, 
                                na = c(""," ","NA"))

stubble_data <- bind_rows(BGW17stubble, WCS17stubble, BGW18stubble, WCS18stubble)

print(stubble_data)
```
We have 1 missing height value in the data that we need to remove.
```{r}
## clean up the data by removing any missing values
stubble_data <- stubble_data %>% tidyr::drop_na("Height-in")

print(stubble_data)
```
```{r}
stubble_data$Species <- stubble_data %>% pull(Species) %>% forcats::as_factor()

stubble_data$Species <- stubble_data %>% pull(Species) %>% fct_explicit_na(na_level = "Missing")

stubble_data
```
```{r}
# Boggy 2017
stubble_data %>% 
        dplyr::filter(Site == "Boggy" & Year == "2017") %>% 
        dplyr::filter(Species == "POPR") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa Pratensis (Kentucky Bluegrass)",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis= 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis= 0.75, las = 2)
mtext("Boggy 2017", 3, adj = 0.5, line = -1)

# Wildcat 2017
stubble_data %>% 
        dplyr::filter(Site == "Wildcat" & Year == "2017") %>% 
        dplyr::filter(Species == "POPR") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa Pratensis (Kentucky Bluegrass)",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis= 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis= 0.75, las = 2)
mtext("Wildcat 2017", 3, adj = 0.5, line = -1)
```
Get the mean, standard deviation, standard error for the stubble height data.
```{r}
BGW17stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Boggy" & Year == 2017) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BGW18stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Boggy" & Year == 2018) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

WCS17stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Wildcat" & Year == 2017) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

WCS18stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Wildcat" & Year == 2018) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BGW17stubblestats
BGW18stubblestats
WCS17stubblestats
WCS18stubblestats
```
Rearrange the order of the species count, descending from highest count to lowest count.
```{r}
BGW17stubblestats <- BGW17stubblestats %>% dplyr::arrange(desc(n))

WCS17stubblestats <-WCS17stubblestats %>% dplyr::arrange(desc(n))

BGW17stubblestats
WCS17stubblestats
```
Take the top 3 species for each site. 
```{r}
BGW17stubblestats_top3 <- BGW17stubblestats %>% dplyr::slice(1:3)

BGW17stubblestats_top3
```


```{r}
show_col(viridis_pal(option="inferno")(8))
viridis_pal(option="inferno")(8)
```
```{r}
jpeg(filename = "figures/vegetation/Boggy_Stubble_Height.jpg",
     width=3.2,
     height=3.2,
     units="in",
     res=300)
plot.new() ## call a new plot
## bottom, left, top, right
par(mar=c(2, 4, 2, 2))
barplot(boggystubble$avg.in,
        col = c("#65156EFF", "#F57D15FF"),
        main = "Boggy Creek Stubble Height",
        cex.lab = 1,
        cex.names = 1,
        cex.main = 1,
        axes = FALSE,
        names.arg=(c("2017", "2018")),
        ylab = expression(paste("Stubble Height (in)", " ± SE")),
        ylim = c(0, 11))
axis(2, at=c(seq(0, 10, 1)), labels=c(seq(0, 10, 1)), cex.axis = 1)
segments(0.7, boggy17avg - boggy17se, 0.7, boggy17avg + boggy17se, lwd = 1)
arrows(0.7, boggy17avg - boggy17se, 0.7, boggy17avg + boggy17se, lwd = 1, angle = 90,code = 3, length = 0.05)
segments(1.9, boggy18avg - boggy18se, 1.9, boggy18avg + boggy18se, lwd = 1)
arrows(1.9, boggy18avg - boggy18se, 1.9, boggy18avg +  boggy18se, lwd = 1, angle = 90,code = 3, length = 0.05)
text(0.7, 4, "3.3", pos = 3, cex = 1)
text(1.9, 3, "2.6", pos = 3, cex = 1)
dev.off()
```

```{r}
jpeg(filename = "figures/vegetation/Wildcat_Stubble_Height.jpg",
     width=3.2,
     height=3.2,
     units="in",
     res=300)
plot.new() ## call a new plot
## bottom, left, top, right
par(mar=c(2, 4, 2, 2))
barplot(wildcatstubble$avg.in,
        col = c("#65156EFF", "#F57D15FF"),
        main = "Wildcat Creek Stubble Height",
        cex.lab = 1,
        cex.names = 1,
        cex.main = 1,
        axes = FALSE,
        names.arg=(c("2017", "2018")),
        ylab = expression(paste("Stubble Height (in)", " ± SE")),
        ylim = c(0, 11))
axis(2, at=c(seq(0, 10, 1)), labels=c(seq(0, 10, 1)), cex.axis = 1)
segments(0.7, wildcat17avg - wildcat17se, 0.7, wildcat17avg + wildcat17se, lwd = 1)
arrows(0.7, wildcat17avg - wildcat17se, 0.7, wildcat17avg + wildcat17se, lwd = 1, angle = 90,code = 3, length = 0.05)
segments(1.9, wildcat18avg - wildcat18se, 1.9, wildcat18avg + wildcat18se, lwd = 1)
arrows(1.9, wildcat18avg - wildcat18se, 1.9, wildcat18avg +  wildcat18se, lwd = 1, angle = 90,code = 3, length = 0.05)
text(0.7, 1.5, "1.2", pos = 3, cex = 1)
text(1.9, 4, "3.3", pos = 3, cex = 1)
dev.off()
```

```{r}
t.test(Boggy17stub$Height.in, Boggy18stub$Height.in)
t.test(Wildcat17stub$Height.in, Wildcat18stub$Height.in)
```
