---
title: "Stubble Height"
author: "Andrew Antaya"
date: "June 20, 2019"
output: html_notebook
---

```{r}
# clear the environment
rm(list=ls(all=TRUE))
```
```{r}
currentwd <- getwd()
currentwd
```


```{r echo=FALSE}
source("packages.R")
```

```{r}
source("functions.R")
```

```{r Read in Excel data and convert to csv, eval=FALSE, include=FALSE}
xlsx_file_list <- list.files("data/vegetation/heber/stubble-height/xlsx", pattern = "xlsx")

xlsx_file_list

file_names <- str_replace_all(xlsx_file_list, "xlsx", "csv")

file_names

file_source <- paste0(currentwd, "/data/vegetation/heber/stubble-height/xlsx/", xlsx_file_list)

file_source

file_destination <- paste0(currentwd, "/data/vegetation/heber/stubble-height/csv/", file_names)

file_destination

for (i in 1:length(file_source)) {
  # read the data from the first sheet
  xlsx_data <- read.xlsx(file_source[i], sheet = "Stubble Height")
  # write out the xlsm data as an xlsx
  write_csv(xlsx_data, paste0(file_destination[i]), na = "NA")}
```

```{r load data}
## read in data
BGW17stubble <- readr::read_csv('data/vegetation/white-mountains/2017-boggy-stubble-height.csv',
                                col_names = TRUE, 
                                na = c(""," ","NA"))
WCS17stubble <- readr::read_csv('data/vegetation/white-mountains/2017-wildcat-stubble-height.csv',
                                col_names = TRUE,
                                na = c(""," ","NA"))
BGW18stubble <- readr::read_csv('data/vegetation/white-mountains/2018-boggy-stubble-height.csv', 
                                col_names = TRUE, 
                                na = c(""," ","NA"))
WCS18stubble <- readr::read_csv('data/vegetation/white-mountains/2018-wildcat-stubble-height.csv',
                                col_names = TRUE, 
                                na = c(""," ","NA"))
BGW19stubble <- readr::read_csv('data/vegetation/white-mountains/2019-boggy-grazed-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
WCS19stubble <- readr::read_csv('data/vegetation/white-mountains/2019-wildcat-grazed-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
BKS18stubble <- readr::read_csv('data/vegetation/heber/2018-BKS-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
BRL18stubble <- readr::read_csv('data/vegetation/heber/2018-BRL-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
A5119stubble <- readr::read_csv('data/vegetation/heber/stubble-height/csv/2019-A51-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
BKN19stubble <- readr::read_csv('data/vegetation/heber/stubble-height/csv/2019-BKN-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
BRL19stubble <- readr::read_csv('data/vegetation/heber/stubble-height/csv/2019-BRL-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
A5120stubble <- readr::read_csv('data/vegetation/heber/stubble-height/csv/2020-A51-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
BKN20stubble <- readr::read_csv('data/vegetation/heber/stubble-height/csv/2020-BKN-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
BKS20stubble <- readr::read_csv('data/vegetation/heber/stubble-height/csv/2020-BKS-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))
BRL20stubble <- readr::read_csv('data/vegetation/heber/stubble-height/csv/2020-BRL-stubble-height.csv',
                                col_names = TRUE,
                                na = c("", " ", "NA"))

BGW17stubble
WCS17stubble
WCS18stubble
BGW19stubble
WCS19stubble
BKS18stubble
BRL18stubble
A5119stubble
BKN19stubble
BRL19stubble
A5120stubble
BKN20stubble
BKS20stubble
BRL20stubble
```
The 2018 Heber stubble height data was collected differently and only has three columns. We need to convert the "grazed" and "ungrazed" columns into a single column to make it the same as the 2019 and 2020 data.
```{r}
# add two columns with the Site and Year to help us keep track of the data
BKS18stubble <- BKS18stubble %>% dplyr::mutate(Site = "BKS", Year = 2018)

BRL18stubble <- BRL18stubble %>% dplyr::mutate(Site = "BRL", Year = 2018)

# bind the 2018 heber data together for easier manipulation
heber_stubble_2018 <- dplyr::bind_rows(BKS18stubble, BRL18stubble)

# rename the "sample" column to "Record" to bring it inline with the 2019 and 2020 data
heber_stubble_2018 <- heber_stubble_2018 %>% dplyr::rename(Sample = sample)

# convert the NA values in the "ungrazed" column to zero to make it easier to add values together 
# (i.e., you can't add a number to a NA) 
heber_stubble_2018$ungrazed <- heber_stubble_2018 %>% pull(ungrazed) %>% tidyr::replace_na(0)

# convert the NA values in the "grazed" column to zero to make it easier to add values together 
heber_stubble_2018$grazed <- heber_stubble_2018 %>% pull(grazed) %>% tidyr::replace_na(0)

# add the "grazed" and "ungrazed" values together into a new column 
# this will bring it inline with the 2019 and 2020 data
# also drop the "grazed" and "ungrazed" columns and keep the unused columns
heber_stubble_2018 <- heber_stubble_2018 %>% dplyr::mutate("Height" = grazed + ungrazed, .keep = "unused")

# print the data frame to view the changes
heber_stubble_2018
```


```{r}
A5119stubble <- A5119stubble %>% dplyr::mutate(Site = "A51", Year = 2019)

BKN19stubble <- BKN19stubble %>% dplyr::mutate(Site = "BKN", Year = 2019)

BRL19stubble <- BRL19stubble %>% dplyr::mutate(Site = "BRL", Year = 2019)

A5120stubble <- A5120stubble %>% dplyr::mutate(Site = "A51", Year = 2020)

BKN20stubble <- BKN20stubble %>% dplyr::mutate(Site = "BKN", Year = 2020)

BKS20stubble <- BKS20stubble %>% dplyr::mutate(Site = "BKS", Year = 2020)

BRL20stubble <- BRL20stubble %>% dplyr::mutate(Site = "BRL", Year = 2020)

heber_stubble_data <- bind_rows(A5119stubble, BKN19stubble, BRL19stubble, A5120stubble, BKN20stubble, BKS20stubble, BRL20stubble, heber_stubble_2018)

heber_stubble_data <- heber_stubble_data %>% 
  dplyr::rename("Species/Category Code" = "Species/Category.Code")

heber_stubble_data <- heber_stubble_data %>% 
  dplyr::rename("Species/Category Name" = "Species/Category.Name")

heber_stubble_data
```


```{r rename columns}
# add a "Site" column and a "Year" column to the 2019 data
# this will make it easier to keep track of the data as we clean it up
BGW19stubble <- BGW19stubble %>% dplyr::mutate(Site = "Boggy", Year = 2019)

WCS19stubble <- WCS19stubble %>% dplyr::mutate(Site = "Wildcat", Year = 2019)

# bind data together for easier manipulation
mutated_stubble_data <- bind_rows(BGW19stubble, WCS19stubble, heber_stubble_data)

# rename the "Species/Category Code" column to "Species" to be consistent with the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% dplyr::rename(Species = "Species/Category Code")

# rename the "Sample" column to "Record" to be consistent with the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% dplyr::rename(Record = "Sample")

# remove the columns that are not in the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% dplyr::select(-c("Qualifier", "Transect", "Species/Category Name"))

# rename the "Height" column to "Height-in" to be consistent with the 2017 & 2018 data
mutated_stubble_data <- mutated_stubble_data %>% dplyr::rename("Height-in" = "Height")

mutated_stubble_data <- mutated_stubble_data %>% dplyr::mutate(Condition = NA)

mutated_stubble_data
```

```{r bind data together}
stubble_data <- bind_rows(BGW17stubble, WCS17stubble, BGW18stubble, WCS18stubble, mutated_stubble_data)

print(stubble_data)
```

We have 1 missing height value in the data that we need to remove.
```{r remove missing data}
## clean up the data by removing any missing values
stubble_data <- stubble_data %>% tidyr::drop_na("Height-in")

print(stubble_data)
```

```{r code Species as factors}
stubble_data$Species <- stubble_data %>% pull(Species) %>% forcats::as_factor()

stubble_data$Species <- stubble_data %>% pull(Species) %>% fct_explicit_na(na_level = "Missing")

stubble_data$Species <- stubble_data %>% pull(Species) %>% fct_infreq()

stubble_data
```

Plot a histogram of Kentucky bluegrass to visualize the distribution of stubble heights. 
```{r Boggy 2017 Histogram}
stubble_data %>% 
        dplyr::filter(Site == "Boggy" & Year == "2017") %>% 
        dplyr::filter(Species == "POPR") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa pratensis (Kentucky Bluegrass)",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis= 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis= 0.75, las = 2)
mtext("Boggy 2017", 3, adj = 0.5, line = -1)
```

```{r Wildcat 2017 Histogram}
stubble_data %>% 
        dplyr::filter(Site == "Wildcat" & Year == "2017") %>% 
        dplyr::filter(Species == "POPR") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa pratensis (Kentucky Bluegrass)",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis= 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis= 0.75, las = 2)
mtext("Wildcat 2017", 3, adj = 0.5, line = -1)
```

```{r Boggy 2019 Histogram}
stubble_data %>% 
        dplyr::filter(Site == "Boggy" & Year == "2019") %>% 
        dplyr::filter(Species == "POA") %>% 
        pull("Height-in") %>% 
        hist(breaks = seq(0, 10, by = 1), 
             axes = FALSE,
             main = "Frequency Count of Poa pratensis (Kentucky Bluegrass)",
             xlab = "Stubble Height (in)",
             xlim = c(0, 10),
             ylim = c(0, 100))
axis(1, at = seq(0, 10, by = 1), 
     labels = seq(0, 10, by = 1), 
     cex.axis= 0.75, las = 2)
axis(2, at = seq(0, 100, by = 10), 
     labels = seq(0, 100, by = 10), 
     cex.axis= 0.75, las = 2)
mtext("Boggy 2019", 3, adj = 0.5, line = -1)
```

Get the mean, standard deviation, standard error for the stubble height data.
```{r White Mountains stubble stats}
BGW17stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Boggy" & Year == 2017) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BGW18stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Boggy" & Year == 2018) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

WCS17stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Wildcat" & Year == 2017) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

WCS18stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Wildcat" & Year == 2018) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BGW19stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Boggy" & Year == 2019) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

WCS19stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Wildcat" & Year == 2019) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

WCS19stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "Wildcat" & Year == 2019) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BGW17stubblestats
BGW18stubblestats
WCS17stubblestats
WCS18stubblestats
BGW19stubblestats
WCS19stubblestats
```

```{r Heber stubble stats}
# TODO this would be good candidate for a custom function

BKS18stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "BKS" & Year == 2018) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BRL18stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "BRL" & Year == 2018) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

A5119stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "A51" & Year == 2019) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BKN19stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "BKN" & Year == 2019) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BRL19stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "BRL" & Year == 2019) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

A5120stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "A51" & Year == 2020) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BKN20stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "BKN" & Year == 2020) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BKS20stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "BKS" & Year == 2020) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BRL20stubblestats <- stubble_data %>% 
  dplyr::filter(Site == "BRL" & Year == 2020) %>% 
        group_by(Species) %>% 
        rstatix::get_summary_stats("Height-in", type = "common")

BKS18stubblestats
BRL18stubblestats
A5119stubblestats
BKN19stubblestats
BRL19stubblestats
A5120stubblestats
BKN20stubblestats
BKS20stubblestats
BRL20stubblestats
```

Rearrange the order of the species count, descending from the species with the highest number of observations (n) to the species with  the lowest number of observations.
```{r}
BGW17stubblestats <- BGW17stubblestats %>% dplyr::arrange(desc(n))

WCS17stubblestats <- WCS17stubblestats %>% dplyr::arrange(desc(n))

BGW19stubblestats <- BGW19stubblestats %>% dplyr::arrange(desc(n))

WCS19stubblestats <- WCS19stubblestats %>% dplyr::arrange(desc(n))

WCS17stubblestats
BGW19stubblestats
WCS19stubblestats
```

```{r}
BKS18stubblestats
BRL18stubblestats
A5119stubblestats
BKN19stubblestats
BRL19stubblestats
A5120stubblestats
BKN20stubblestats
BKS20stubblestats
BRL20stubblestats
```


Take the top 3 species for each site. 
```{r}
BGW17stubblestats_top3 <- BGW17stubblestats %>% dplyr::slice(1:3)

BGW19stubblestats_top3 <- BGW19stubblestats %>% dplyr::slice(1:3)

WCS19stubblestats_top3 <- WCS19stubblestats %>% dplyr::slice(1:3)

BGW17stubblestats_top3
BGW19stubblestats_top3
WCS19stubblestats_top3
```

```{r Boggy 2017 Stubble Height Figure}
ggplot(BGW17stubblestats_top3, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  scale_fill_discrete(name = "Species", labels = c("Poa pratensis", "Carex sp.", "Poa fendleriana")) +
  labs(title = "Boggy Creek Stubble Height 2017") +
  ylab(expression(paste("Stubble Height", " ", "(Inch)", " ± SE"))) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  geom_errorbar(aes(ymin = (mean-se), ymax = (mean+se)), position = position_dodge(0.5), width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +

  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", x = 1, y = 3.5, label = signif(BGW17stubblestats_top3$mean[1], 2)) +
  annotate(geom = "text", x = 2, y = 4.75, label = signif(BGW17stubblestats_top3$mean[2], 2)) +
  annotate(geom = "text", x = 3, y = 4, label = signif(BGW17stubblestats_top3$mean[3], 2)) +

# add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (BGW17stubblestats_top3$mean[1]/2), 
           label = paste0("n=", BGW17stubblestats_top3$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW17stubblestats_top3$mean[2]/2), 
           label = paste0("n=", BGW17stubblestats_top3$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW17stubblestats_top3$mean[3]/2), 
           label = paste0("n=", BGW17stubblestats_top3$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text",
           x = 4,
           y = 0,
           label = "*n=number of samples",
           size = 3) +
  coord_cartesian(clip = "off")

ggsave("Boggy-2017-Stubble-Height-n-samples.jpg", 
    path = paste0(getwd(),"/figures", "/stubbleheight"))
```

```{r Wildcat 2017 Stubble Height Figure}
ggplot(WCS17stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  scale_fill_discrete(name = "Species", labels = c("Poa pratensis", "Carex sp.", "Poa fendleriana")) +
  labs(title = "Wildcat Creek Stubble Height 2017") +
  ylab(expression(paste("Stubble Height", " ", "(Inch)", " ± SE"))) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  geom_errorbar(aes(ymin = (mean-se), ymax = (mean+se)), position = position_dodge(0.5), width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 5))) +

# add stubble height values above the  error bars
# round the mean stubble height value using significant figures
  annotate(geom = "text", x = 1, y = 2, label = signif(WCS17stubblestats$mean[1], 2)) +
  annotate(geom = "text", x = 2, y = 4.5, label = signif(WCS17stubblestats$mean[2], 2)) +
  annotate(geom = "text", x = 3, y = 2, label = signif(WCS17stubblestats$mean[3], 2)) +

# add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (WCS17stubblestats$mean[1]/2), 
           label = paste0("n=", WCS17stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS17stubblestats$mean[2]/2), 
           label = paste0("n=", WCS17stubblestats$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = (WCS17stubblestats$mean[3]/2), 
           label = paste0("n=", WCS17stubblestats$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text",
           x = 4,
           y = 0,
           label = "*n=number of samples",
           size = 3) +
  coord_cartesian(clip = "off")


ggsave("Wildcat-2017-Stubble-Height-n-samples.jpg", 
path = paste0(getwd(),"/figures", "/stubbleheight"))
```

```{r Boggy 2018 Stubble Height Figure}
ggplot(BGW18stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.25) +
  labs(title = "Boggy Creek Stubble Height 2018") +
  ylab(expression(paste("Stubble Height", " ", "(Inch)", " ± SE"))) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  geom_errorbar(aes(ymin = (mean-se), ymax = (mean+se)), position = position_dodge(0.5), width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +

# add stubble height values above the  error bars
# round the mean stubble height value using significant figures
  annotate(geom = "text", x = 1, y = 3.5, label = signif(BGW18stubblestats$mean[1], 2)) +
  
# add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (BGW18stubblestats$mean[1]/2), 
           label = paste0("n=", BGW18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text",
           x = 1.5,
           y = 0,
           label = "*n=number of samples",
           size = 3) +
  coord_cartesian(clip = "off")
  
ggsave("Boggy-2018-Stubble-Height-n-samples.jpg", 
    path = paste0(getwd(),"/figures", "/stubbleheight"))
```

```{r Wildcat 2018 Stubble Height Figure}
ggplot(WCS18stubblestats, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.25) +
  labs(title = "Wildcat Creek Stubble Height 2018") +
  ylab(expression(paste("Stubble Height", " ", "(Inch)", " ± SE"))) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  geom_errorbar(aes(ymin = (mean-se), ymax = (mean+se)), position = position_dodge(0.5), width = 0.1) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +
  
  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", x = 1, y = 4.25, label = signif(WCS18stubblestats$mean[1], 2)) +

  # add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (WCS18stubblestats$mean[1]/2), 
           label = paste0("n=", WCS18stubblestats$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text",
           x = 1.5,
           y = 0,
           label = "*n=number of samples",
           size = 3) +
  coord_cartesian(clip = "off")
  
ggsave("Wildcat-2018-Stubble-Height-n-samples.jpg", 
       path = paste0(getwd(),"/figures", "/stubbleheight"))
```

```{r Boggy 2019 Stubble Height Figure}
ggplot(BGW19stubblestats_top3, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  scale_fill_discrete(name = "Species", labels = c("Poa sp.", "Carex sp.", "Bromus inermis")) +
  labs(title = "Boggy Creek Stubble Height 2019") +
  ylab(expression(paste("Stubble Height", " ", "(Inch)", " ± SE"))) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, by = 1)) +
  geom_errorbar(aes(ymin = (mean-se), ymax = (mean+se)), position = position_dodge(0.5), width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +

  # add stubble height values above the  error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", x = 1, y = 3.5, label = signif(BGW19stubblestats_top3$mean[1], 2)) +
  annotate(geom = "text", x = 2, y = 9, label = signif(BGW19stubblestats_top3$mean[2], 2)) +
  annotate(geom = "text", x = 3, y = 4.5, label = signif(BGW19stubblestats_top3$mean[3], 2)) +

  # add the number of samples inside the bars
  annotate(geom = "text", x = 1, y = (BGW19stubblestats_top3$mean[1]/2), 
           label = paste0("n=", BGW19stubblestats_top3$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (BGW19stubblestats_top3$mean[2]/2), 
           label = paste0("n=", BGW19stubblestats_top3$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = (BGW19stubblestats_top3$mean[3]/2), 
           label = paste0("n=", BGW19stubblestats_top3$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text",
           x = 4,
           y = 0,
           label = "*n=number of samples",
           size = 3) +
  coord_cartesian(clip = "off")

ggsave("Boggy-2019-Stubble-Height-n-samples.jpg", 
       path = paste0(getwd(),"/figures", "/stubbleheight"))
```
```{r Wildcat 2019 Stubble Height Figure}
ggplot(WCS19stubblestats_top3, aes(fill = Species, y = mean, x = Species)) +
  geom_col(width = 0.75) +
  scale_fill_discrete(name = "Species", labels = c("Poa sp.", "Carex sp.", "Pascopyrum smithii")) +
  labs(title = "Wildcat Creek Stubble Height 2019") +
  ylab(expression(paste("Stubble Height", " ", "(Inch)", " ± SE"))) +
  scale_y_continuous(limits = c(0, 11), breaks = seq(0, 10, by = 1)) +
  geom_errorbar(aes(ymin = (mean-se), ymax = (mean+se)), position = position_dodge(0.5), width = 0.25) +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0)),
        axis.text.y = element_text(margin = margin(t = 0, r = 0, b = 0, l = 10))) +

  # add stubble height values above the error bars
  # round the mean stubble height value using significant figures
  annotate(geom = "text", x = 1, y = 2.5, label = signif(WCS19stubblestats_top3$mean[1], 2)) +
  annotate(geom = "text", x = 2, y = 3, label = signif(WCS19stubblestats_top3$mean[2], 2)) +
  annotate(geom = "text", x = 3, y = 11, label = signif(WCS19stubblestats_top3$mean[3], 2)) +

  # add the number of samples inside the bars
  annotate(geom = "text", 
           x = 1, 
           y = (WCS19stubblestats_top3$mean[1]/2), 
           label = paste0("n=", WCS19stubblestats_top3$n[1]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 2, 
           y = (WCS19stubblestats_top3$mean[2]/2), 
           label = paste0("n=", WCS19stubblestats_top3$n[2]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text", 
           x = 3, 
           y = (WCS19stubblestats_top3$mean[3]/2), 
           label = paste0("n=", WCS19stubblestats_top3$n[3]), 
           size = 3, 
           alpha = 0.75) +
  annotate(geom = "text",
           x = 4,
           y = 0,
           label = "*n=number of samples",
           size = 3) +
  coord_cartesian(clip = "off")

ggsave("Wildcat-2019-Stubble-Height-n-samples.jpg", 
       path = paste0(getwd(),"/figures", "/stubbleheight"))
```
